[{"path":"https://ai4ci.github.io/tidyabc/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 tidyabc authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://ai4ci.github.io/tidyabc/articles/s3-distributions.html","id":"s3-distribution-wrappers","dir":"Articles","previous_headings":"","what":"S3 distribution wrappers","title":"Statistical distribution functions","text":"example .dist_fns plotting naming","code":""},{"path":"https://ai4ci.github.io/tidyabc/articles/s3-distributions.html","id":"empirical-distributions","dir":"Articles","previous_headings":"","what":"Empirical distributions","title":"Statistical distribution functions","text":"data CDF","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/articles/s3-distributions.html","id":"alternative-distribution-parameterisation","dir":"Articles","previous_headings":"","what":"Alternative distribution parameterisation","title":"Statistical distribution functions","text":"rgamma2 etc.","code":""},{"path":"https://ai4ci.github.io/tidyabc/articles/scorer-functions.html","id":"comparing-observation-versus-simulated-data","dir":"Articles","previous_headings":"","what":"Comparing observation versus simulated data","title":"Scoring and summarising functions","text":"specify wasserstein etc.","code":""},{"path":"https://ai4ci.github.io/tidyabc/articles/scorer-functions.html","id":"summary-metrics","dir":"Articles","previous_headings":"","what":"Summary metrics","title":"Scoring and summarising functions","text":"go absolute difference mean","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/articles/sim-example.html","id":"setup-simulation","dir":"Articles","previous_headings":"Simulation","what":"Setup simulation","title":"Early outbreak and Generation time","text":"","code":"sim_params = list(   # A short generation time   mean_gt = 4,   sd_gt = 2,   R0 = 2,   I0 = 10,   # Add a longish and very variable delay to symptoms   p_symptomatic = 0.3,   mean_onset = 7,   sd_onset = 5,   # and a slightly shorter delay to observation:   # Only symptomatic cases are observed   p_detected_given_symptoms = 0.7,   mean_obs = 5,   sd_obs = 3,   # Observation cutoff:   T_obs = 40 )  # Run simulation ----  sim_ip = ggoutbreak::make_gamma_ip(   median_of_mean = sim_params$mean_gt,   median_of_sd = sim_params$sd_gt )  sim_params$r0 = ggoutbreak::inv_wallinga_lipsitch(sim_params$R0, sim_ip)  truth = ggoutbreak::sim_branching_process(   fn_Rt = ~ sim_params$R0,   fn_ip = ~sim_ip,   fn_imports = \\(t) ifelse(t == 1, sim_params$I0, 0),   max_time = 40 ) ## ....................complete ## interfacer: development mode active (local function). delayed = truth %>%   ggoutbreak::sim_delay(     p_fn = ~ sim_params$p_symptomatic,     delay_fn = ~ ggoutbreak::rgamma2(       .x,       sim_params$mean_onset,       sim_params$sd_onset     ),     input = \"time\",     output = \"symptom\"   ) %>%   ggoutbreak::sim_delay(     p_fn = \\(t, symptom) {       ifelse(symptom, sim_params$p_detected_given_symptoms, 0)     },     delay_fn = ~ ggoutbreak::rgamma2(       .x,       sim_params$mean_obs,       sim_params$sd_obs     ),     input = \"symptom_time\",     output = \"observation\"   )   observed = delayed %>% dplyr::filter(observation_time < sim_params$T)  traced_contacts = observed %>%   dplyr::semi_join(observed, by = c(\"infector\" = \"id\"))"},{"path":"https://ai4ci.github.io/tidyabc/articles/sim-example.html","id":"index-case-onset","dir":"Articles","previous_headings":"Simulation","what":"Index case onset","title":"Early outbreak and Generation time","text":"","code":"index_case_onset = observed %>% dplyr::transmute(onset_time = floor(symptom_time))  ggplot(index_case_onset, aes(x=onset_time))+geom_histogram(binwidth = 1)"},{"path":"https://ai4ci.github.io/tidyabc/articles/sim-example.html","id":"delay-to-observation","dir":"Articles","previous_headings":"Simulation","what":"Delay to observation","title":"Early outbreak and Generation time","text":"","code":"# Data  delay_distribution = observed %>% dplyr::transmute(   obs_delay = floor(observation_time) - floor(symptom_time) )  ggplot(delay_distribution, aes(x = obs_delay))+geom_histogram(binwidth = 1)+   xlab(\"symptom to observation\")"},{"path":"https://ai4ci.github.io/tidyabc/articles/sim-example.html","id":"observed-serial-interval","dir":"Articles","previous_headings":"Simulation","what":"Observed serial interval","title":"Early outbreak and Generation time","text":"","code":"serial_pairs = observed %>%   inner_join(     traced_contacts,     by = c(\"id\" = \"infector\"),     suffix = c(\".1\", \".2\")   ) %>%   transmute(     serial_interval = floor(symptom_time.2) - floor(symptom_time.1) #order known     # serial_interval = abs(floor(symptom_time.2) - floor(symptom_time.1)) #order uncertain   )     ggplot(serial_pairs) +   geom_histogram(aes(x = serial_interval), binwidth = 1)+   xlab(\"symptom serial interval (given observed)\") obsdata = list(   onset = as.numeric(index_case_onset$onset_time),   diff = as.numeric(delay_distribution$obs_delay),   si = as.numeric(serial_pairs$serial_interval) )"},{"path":"https://ai4ci.github.io/tidyabc/articles/sim-example.html","id":"model","dir":"Articles","previous_headings":"","what":"Model","title":"Early outbreak and Generation time","text":"Aim fit model 3 aspects data simultaneously. model makes following hard assumptions: constant exponential growth infection times (hidden t_inf) delayed onset symptoms - gamma distributed (t_onset = t_inf + onset_delay) delayed observation symptoms - gamma distributed (t_obs = onset + obs_delay) secondary case delayed generation time (hidden t_inf2 = t_inf + gt_delay) secondary case symptom onset observation (t_onset_2 / t_obs_2) cases observed t_obs / t_obs_2 within time window (0-T) \\[ \\begin{align} t_{max} - T_{inf} &\\sim Exp(r_0) \\\\ \\Delta T_{inf \\rightarrow onset} &\\sim Gamma(\\mu_{onset},\\sigma_{onset}) \\\\ \\Delta T_{onset \\rightarrow obs} &\\sim Gamma(\\mu_{obs},\\sigma_{obs}) \\\\ \\Delta T_{gt} &\\sim Gamma(\\mu_{gt},\\sigma_{gt}) \\\\ \\end{align} \\] \\[ \\begin{align} T_{onset} &= T_{inf} + \\Delta T_{inf \\rightarrow onset} \\\\ T_{obs} &= T_{onset} + \\Delta T_{onset \\rightarrow obs}\\\\ T_{inf_2} &= T_{inf_1} + \\Delta T_{gt} \\\\ \\Delta T_{onset_1 \\rightarrow onset_2} &=  \\Delta T_{gt} + \\Delta T_{inf_2 \\rightarrow onset_2} -  \\Delta T_{inf_1 \\rightarrow onset_1} \\\\ \\end{align} \\] \\[ \\begin{align} O_1 &= (t_0 \\le T_{onset_1}, T_{obs_1} \\le t_{max}) \\\\ O_{1,2} &= (O_1, t_0 \\le T_{onset_2}, T_{obs_2} \\le t_{max})\\\\ T_{onset_1}|O_1 &\\Rightarrow \\text{primary case times}\\\\ \\Delta T_{onset_1 \\rightarrow obs_1}|O_1 &\\Rightarrow \\text{onset interview delay}\\\\ \\Delta T_{onset_1 \\rightarrow onset_2}|O_{1,2} &\\Rightarrow \\text{onset onset serial interval}\\\\ \\end{align} \\]","code":"n = nrow(observed)  sim1_fn = carrier::crate(   function(r0, mean_onset, sd_onset, mean_obs, sd_obs, mean_gt, sd_gt, R0, ...) {          # Primary case infection time     # exponentially distributed in time. Need to make sure we have enough samples      # before t0 observation cutoff to account for early observed cases.          t_early = - stats::qgamma(0.99,mean_onset,sd_onset) # t starts at 0     t_inf_1 = tidyabc::rexpgrowth(n, r0, T_obs, t_early)          onset_delay = tidyabc::rgamma2(n, mean_onset, sd_onset)     obs_delay = tidyabc::rgamma2(n, mean_obs, sd_obs)          t_onset_1 = t_inf_1 + onset_delay     t_obs_1 = t_onset_1 + obs_delay          # Primary case observations:     # Onset after t0 and observed before T     obs_1 = t_obs_1 < T_obs & t_onset_1 > 0          t_inf_1 = t_inf_1[obs_1]     t_onset_1 = t_onset_1[obs_1]     t_obs_1 = t_obs_1[obs_1]          n1 = length(t_inf_1)          # Secondary case. Numbers of secondary cases are poission(R0). Could add      # dispersion here and fit it also     # Only observed primary will be observed secondary so we can restrict to      # observed subset     # browser()     case_2ary = stats::rpois(n1,R0)     index_1ary = rep(seq_along(case_2ary), case_2ary)     n2 = length(index_1ary)          gt_delay = tidyabc::rgamma2(n2, mean_gt, sd_gt)     onset_delay_2 = tidyabc::rgamma2(n2, mean_onset, sd_onset)     obs_delay_2 = tidyabc::rgamma2(n2, mean_obs, sd_obs)          t_inf_2 = t_inf_1[index_1ary] + gt_delay     t_onset_2 = t_inf_2 + onset_delay_2     t_obs_2 = t_onset_2 + obs_delay_2          # order dependent     serial_interval = floor(t_onset_2) - floor(t_onset_1[index_1ary])     # order independent     # serial_interval = abs(floor(t_onset_2) - floor(t_onset_1[index_1ary]))          # Secondary case observations     obs_2 = t_obs_2 < T_obs & t_onset_2 > 0          serial_interval = serial_interval[obs_2]     t_onset_2 = t_onset_2[obs_2]          return(list(       onset = floor(t_onset_1),       diff = floor(t_obs_1) - floor(t_onset_1),       si = serial_interval     ))   },   T_obs = sim_params$T_obs,   n=n ) scorer1_fn = function(simdata, obsdata) {      onset = calculate_wasserstein(simdata$onset, obsdata$onset)   diff = calculate_wasserstein(simdata$diff, obsdata$diff)   si = calculate_wasserstein(simdata$si, obsdata$si)   mad_si = abs(mean(simdata$si) - mean(obsdata$si))      return(list(     sim_onset = onset,     sim_diff = diff,     sim_si=si,     sim_mad_si = mad_si   )) } test = tidyabc::test_simulation(   sim_fn = sim1_fn,    scorer_fn = scorer1_fn,   params = sim_params,   obsdata = obsdata   # debug=TRUE )  # .gg_hist(test$obsdata$onset)"},{"path":"https://ai4ci.github.io/tidyabc/articles/sim-example.html","id":"scoring","dir":"Articles","previous_headings":"Model","what":"Scoring","title":"Early outbreak and Generation time","text":"going fit model custom ABC rejection framework ’m assessing model fits data using earth movers distance level individual’s observed times versus simulations observed times. Given simulations cutoff different numbers people match size simulation observed data","code":""},{"path":"https://ai4ci.github.io/tidyabc/articles/sim-example.html","id":"priors","dir":"Articles","previous_headings":"Model","what":"Priors","title":"Early outbreak and Generation time","text":"Use set uninformative priors. RO derived Wallinga-Lipsitch, Gamma distributions hyperparameters constrained convex:","code":"priors = priors(   r0 ~ unif(-0.1, 0.7),   mean_onset ~ unif(0, 12),   sd_onset ~ unif(0, 8),   mean_obs ~ unif(0, 12),   sd_obs ~ unif(0, 8),   mean_gt ~ unif(0, 12),   sd_gt ~ unif(0, 8),   R0 ~ (1+r0*sd_gt^2/mean_gt) ^ (mean_gt^2 / sd_gt^2),   ~ is.finite(R0) & R0 > 0,   ~ mean_onset > sd_onset,   ~ mean_obs > sd_obs,   ~ mean_gt > sd_gt )  priors ## Parameters:  ## * r0: unif(min = -0.1, max = 0.7) ## * mean_onset: unif(min = 0, max = 12) ## * sd_onset: unif(min = 0, max = 8) ## * mean_obs: unif(min = 0, max = 12) ## * sd_obs: unif(min = 0, max = 8) ## * mean_gt: unif(min = 0, max = 12) ## * sd_gt: unif(min = 0, max = 8) ## Constraints: ## * is.finite(R0) & R0 > 0 ## * mean_onset > sd_onset ## * mean_obs > sd_obs ## * mean_gt > sd_gt ## Derived values: ## * R0 = (1 + r0 * sd_gt^2/mean_gt)^(mean_gt^2/sd_gt^2) abc_fit = abc_rejection(   obsdata = obsdata,   priors_list = priors,   sim_fn = sim1_fn,   scorer_fn = scorer1_fn,   n_sims = 1000,   acceptance_rate = 0.5,   parallel = TRUE ) ## ABC rejection, 1 wave. ## Warning in stats::qnorm(q, -0.218539809534936, 0.0688397280660186): NaNs ## produced ## Warning in stats::qnorm(q, -0.244607370400033, 0.151144461187998): NaNs ## produced # summary(abc_fit) metrics = posterior_distance_metrics(abc_fit)  # make the serial interval fitting much more important: scoreweights1 = metrics$scoreweights  # * #   c( #     sim_onset = 2, #     sim_diff = 1, #     sim_si = 3, #     sim_mad_si = 3 #   )  # scoreweights1 =  #   c( #     sim_onset = 2, #     sim_diff = 1, #     sim_si = 3, #     sim_mad_si = 4 #   ) smc_fit = abc_smc(   obsdata = obsdata,   priors_list = priors,   sim_fn = sim1_fn,   scorer_fn = scorer1_fn,   n_sims = 8000,   acceptance_rate = 0.5,   #debug_errors = TRUE,   parallel = TRUE,   scoreweights = scoreweights1 ) ## ABC-SMC ## Warning in stats::qnorm(q, -0.206492510850451, 0.0698523318900587): NaNs ## produced ## Warning in stats::qnorm(q, -0.220619577453376, 0.140110644777754): NaNs ## produced ## SMC waves:  ■                                  1% | wave 1 ETA:  5m ## SMC waves:  ■■                                 2% | wave 2 ETA:  5m ## SMC waves:  ■■                                 4% | wave 3 ETA:  5m ## SMC waves:  ■■■                                6% | wave 4 ETA:  5m ## SMC waves:  ■■■                                8% | wave 5 ETA:  5m ## SMC waves:  ■■■■                              10% | wave 6 ETA:  5m ## SMC waves:  ■■■■■                             13% | wave 7 ETA:  4m ## SMC waves:  ■■■■■                             15% | wave 8 ETA:  4m ## SMC waves:  ■■■■■■                            17% | wave 9 ETA:  4m ## SMC waves:  ■■■■■■■                           20% | wave 10 ETA:  4m ## SMC waves:  ■■■■■■■■                          22% | wave 11 ETA:  4m ## SMC waves:  ■■■■■■■■                          25% | wave 12 ETA:  4m ## SMC waves:  ■■■■■■■■■                         27% | wave 13 ETA:  4m ## SMC waves:  ■■■■■■■■■■                        29% | wave 14 ETA:  4m ## SMC waves:  ■■■■■■■■■■■                       32% | wave 15 ETA:  3m ## SMC waves:  ■■■■■■■■■■■                       34% | wave 16 ETA:  3m ## SMC waves:  ■■■■■■■■■■■■                      37% | wave 17 ETA:  3m ## SMC waves:  ■■■■■■■■■■■■■                     39% | wave 18 ETA:  3m ## SMC waves:  ■■■■■■■■■■■■■■                    42% | wave 19 ETA:  3m ## SMC waves:  ■■■■■■■■■■■■■■                    44% | wave 20 ETA:  3m ## SMC waves:  ■■■■■■■■■■■■■■■                   47% | wave 21 ETA:  3m ## SMC waves:  ■■■■■■■■■■■■■■■■                  49% | wave 22 ETA:  3m ## SMC waves:  ■■■■■■■■■■■■■■■■■                 52% | wave 23 ETA:  2m ## SMC waves:  ■■■■■■■■■■■■■■■■■                 54% | wave 24 ETA:  2m ## SMC waves:  ■■■■■■■■■■■■■■■■■■                57% | wave 25 ETA:  2m ## SMC waves:  ■■■■■■■■■■■■■■■■■■■               60% | wave 26 ETA:  2m ## SMC waves:  ■■■■■■■■■■■■■■■■■■■■              62% | wave 27 ETA:  2m ## SMC waves:  ■■■■■■■■■■■■■■■■■■■■              65% | wave 28 ETA:  2m ## Converged on wave: 29 summary(smc_fit) ## ABC SMC fit: 29 waves - (converged) ## Parameter estimates: ## # A tibble: 8 × 4 ## # Groups:   param [8] ##   param      mean_sd       median_95_CrI            ESS ##   <chr>      <chr>         <chr>                  <dbl> ## 1 R0         2.029 ± 0.243 1.990 [1.616 — 2.556]  6340. ## 2 mean_gt    4.403 ± 1.001 4.268 [2.547 — 7.584]  6340. ## 3 mean_obs   5.238 ± 0.645 5.152 [4.029 — 7.595]  6340. ## 4 mean_onset 5.738 ± 1.617 5.625 [2.334 — 10.199] 6340. ## 5 r0         0.201 ± 0.018 0.201 [0.161 — 0.255]  6340. ## 6 sd_gt      3.386 ± 1.476 3.374 [0.490 — 6.908]  6340. ## 7 sd_obs     3.351 ± 0.664 3.264 [2.117 — 5.695]  6340. ## 8 sd_onset   3.640 ± 1.173 3.502 [1.408 — 6.855]  6340. plot(smc_fit,truth = sim_params) plot_evolution(smc_fit,truth = sim_params) adaptive_fit = abc_adaptive(   obsdata = obsdata,   priors_list = priors,   sim_fn = sim1_fn,   scorer_fn = scorer1_fn,   n_sims = 4000,   acceptance_rate = 0.2,   # debug_errors = TRUE,   parallel = TRUE,   scoreweights = scoreweights1 ) ## ABC-Adaptive ## Warning in stats::qnorm(q, -0.203372935374894, 0.0701163450564314): NaNs ## produced ## Adaptive waves:  ■                                  0% | wave 1 ETA:  6m ## Adaptive waves:  ■                                  1% | wave 3 ETA:  5m ## Adaptive waves:  ■■                                 3% | wave 6 ETA:  5m ## Adaptive waves:  ■■                                 4% | wave 8 ETA:  5m ## Adaptive waves:  ■■                                 5% | wave 10 ETA:  5m ## Adaptive waves:  ■■■                                6% | wave 12 ETA:  5m ## Converged on wave: 13 summary(adaptive_fit) ## ABC adaptive fit: 13 waves - (converged) ## Parameter estimates: ## # A tibble: 8 × 4 ## # Groups:   param [8] ##   param      mean_sd       median_95_CrI            ESS ##   <chr>      <chr>         <chr>                  <dbl> ## 1 R0         2.669 ± 0.713 2.541 [1.735 — 4.057]  4731. ## 2 mean_gt    5.169 ± 1.215 4.922 [2.091 — 9.709]  4731. ## 3 mean_obs   5.781 ± 1.015 5.507 [3.725 — 9.855]  4731. ## 4 mean_onset 7.531 ± 1.769 7.395 [2.159 — 11.314] 4731. ## 5 r0         0.246 ± 0.032 0.247 [0.138 — 0.349]  4731. ## 6 sd_gt      3.835 ± 1.460 3.961 [0.559 — 7.052]  4731. ## 7 sd_obs     3.619 ± 1.027 3.396 [1.595 — 6.703]  4731. ## 8 sd_onset   4.031 ± 1.810 4.010 [0.517 — 7.536]  4731. plot(adaptive_fit,truth = sim_params) plot_evolution(adaptive_fit,truth = sim_params) plot_correlations(adaptive_fit,truth = sim_params) & ggplot2::theme(    axis.title.y = ggplot2::element_text(angle=70,vjust=0.1) ) plot_convergence(adaptive_fit) plot_simulations(obsdata, adaptive_fit, sim_fn = sim1_fn) priors2 = priors(   r0 ~ unif(-0.1, 0.7),   mean_onset ~ lnorm2(7, 2),   sd_onset ~ lnorm2(5, 1),   mean_obs ~ lnorm2(5, 1),   sd_obs ~ lnorm2(3, 1),   mean_gt ~ unif(0, 12),   sd_gt ~ unif(0, 8),   R0 ~ (1+r0*sd_gt^2/mean_gt) ^ (mean_gt^2 / sd_gt^2),   ~ is.finite(R0) & R0 > 0,   ~ mean_onset > sd_onset,   ~ mean_obs > sd_obs,   ~ mean_gt > sd_gt )  priors2 ## Parameters:  ## * r0: unif(min = -0.1, max = 0.7) ## * mean_onset: lnorm2(mean = 7, sd = 2) ## * sd_onset: lnorm2(mean = 5, sd = 1) ## * mean_obs: lnorm2(mean = 5, sd = 1) ## * sd_obs: lnorm2(mean = 3, sd = 1) ## * mean_gt: unif(min = 0, max = 12) ## * sd_gt: unif(min = 0, max = 8) ## Constraints: ## * is.finite(R0) & R0 > 0 ## * mean_onset > sd_onset ## * mean_obs > sd_obs ## * mean_gt > sd_gt ## Derived values: ## * R0 = (1 + r0 * sd_gt^2/mean_gt)^(mean_gt^2/sd_gt^2) adaptive_fit2 = abc_adaptive(   obsdata = obsdata,   priors_list = priors2,   sim_fn = sim1_fn,   scorer_fn = scorer1_fn,   n_sims = 4000,   acceptance_rate = 0.2,   # debug_errors = TRUE,   parallel = TRUE,   scoreweights = scoreweights1 ) ## ABC-Adaptive ## Warning in stats::qnorm(q, -0.219098965642995, 0.0641085802091193): NaNs ## produced ## Adaptive waves:  ■                                  0% | wave 1 ETA:  6m ## Adaptive waves:  ■                                  1% | wave 3 ETA:  5m ## Adaptive waves:  ■■                                 2% | wave 5 ETA:  5m ## Adaptive waves:  ■■                                 3% | wave 7 ETA:  5m ## Adaptive waves:  ■■                                 4% | wave 9 ETA:  5m ## Adaptive waves:  ■■■                                6% | wave 11 ETA:  5m ## Adaptive waves:  ■■■                                6% | wave 12 ETA:  5m ## Converged on wave: 14 ## Adaptive waves:  ■■■                                7% | wave 13 ETA:  5m summary(adaptive_fit2) ## ABC adaptive fit: 14 waves - (converged) ## Parameter estimates: ## # A tibble: 8 × 4 ## # Groups:   param [8] ##   param      mean_sd       median_95_CrI           ESS ##   <chr>      <chr>         <chr>                 <dbl> ## 1 R0         2.191 ± 0.292 2.159 [1.747 — 2.791] 6183. ## 2 mean_gt    4.448 ± 0.735 4.298 [2.464 — 7.941] 6183. ## 3 mean_obs   4.950 ± 0.344 4.928 [4.053 — 6.062] 6183. ## 4 mean_onset 6.899 ± 1.180 6.649 [4.654 — 9.984] 6183. ## 5 r0         0.213 ± 0.020 0.213 [0.145 — 0.286] 6183. ## 6 sd_gt      3.058 ± 1.115 3.113 [0.583 — 6.404] 6183. ## 7 sd_obs     2.908 ± 0.384 2.880 [2.009 — 4.113] 6183. ## 8 sd_onset   4.702 ± 0.778 4.720 [3.258 — 6.500] 6183. plot(adaptive_fit2,truth = sim_params) plot_evolution(adaptive_fit2,truth = sim_params) plot_correlations(adaptive_fit2,truth = sim_params) & ggplot2::theme(    axis.title.y = ggplot2::element_text(angle=45,vjust=0, hjust=1),    axis.title.x = ggplot2::element_text(angle=45, hjust=1) #,vjust=1, hjust=0.5) ) plot_convergence(adaptive_fit2) plot_simulations(obsdata, adaptive_fit2, sim_fn = sim1_fn)"},{"path":"https://ai4ci.github.io/tidyabc/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Robert Challen. Author, maintainer.","code":""},{"path":"https://ai4ci.github.io/tidyabc/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Challen R (2025). tidyabc: Approximate Bayesian Computing Tidy Data. R package version 0.0.0.9003, https://ai4ci.github.io/tidyabc.","code":"@Manual{,   title = {tidyabc: Approximate Bayesian Computing with Tidy Data},   author = {Robert Challen},   year = {2025},   note = {R package version 0.0.0.9003},   url = {https://ai4ci.github.io/tidyabc}, }"},{"path":"https://ai4ci.github.io/tidyabc/index.html","id":"tidyabc-","dir":"","previous_headings":"","what":"Approximate Bayesian Computing with Tidy Data","title":"Approximate Bayesian Computing with Tidy Data","text":"R framework approximate Bayesian computing tidy data","code":""},{"path":"https://ai4ci.github.io/tidyabc/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Approximate Bayesian Computing with Tidy Data","text":"tidyabc hosted AI4CI r-universe. Installation follows: can install development version tidyabc GitHub :","code":"options(repos = c(   \"ai4ci\" = 'https://ai4ci.r-universe.dev/',   CRAN = 'https://cloud.r-project.org'))  # Download and install tidyabc in R install.packages(\"tidyabc\") # install.packages(\"devtools\") devtools::install_github(\"ai4ci/tidyabc\")"},{"path":"https://ai4ci.github.io/tidyabc/index.html","id":"funding","dir":"","previous_headings":"","what":"Funding","title":"Approximate Bayesian Computing with Tidy Data","text":"authors gratefully acknowledge support UK Research Innovation AI programme Engineering Physical Sciences Research Council EPSRC grant EP/Y028392/1.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_adaptive.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform ABC sequential adaptive fitting — abc_adaptive","title":"Perform ABC sequential adaptive fitting — abc_adaptive","text":"function execute simulation random selection parameters. Based acceptance_rate reject proportion results. remaining results weighted (using kernel tolerance equivalent half acceptance rate). Empirical distributions fitted weighted parameter particles proposals generated waves fresh sampling. Waves executed maximum reached results converge sufficiently changes waves small. relatively small number simulations may attempted high acceptance rate, multiple waves.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_adaptive.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform ABC sequential adaptive fitting — abc_adaptive","text":"","code":"abc_adaptive(   obsdata,   priors_list,   sim_fn,   scorer_fn,   n_sims,   acceptance_rate,   ...,   max_time = 5 * 60,   converged_fn = default_termination_fn(),   obsscores = NULL,   distance_method = \"euclidean\",   seed = NULL,   knots = NULL,   parallel = FALSE,   max_recover = 3,   allow_continue = interactive(),   debug_errors = FALSE,   kernel = \"epanechnikov\",   bw = 0.1,   scoreweights = NULL )"},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_adaptive.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform ABC sequential adaptive fitting — abc_adaptive","text":"obsdata observational data. data typically named list, anything, e.g. dataframe. reference data simulation model aiming replicate. priors_list named list priors specified abc_prior S3 object (see priors()), can include derived values unnamed 2-sided formulae, LHS formula assigned value RHS, plus optionally set constraints one sided formulae RHS formulae resolve boolean value. sim_fn user defined function takes set parameters named priors_list. must return simulated data set format obsdata, can compared simdata scorer_fn. function must refer global parameters, automatically crated carrier. scorer_fn user supplied function matches following signature scorer_fn(simdata, obsdata, ....), .e. takes data format simdata paired original obsdata returns named list component scores per simulation. function can make use calculate_*() set functions compare components simulation original data. function must refer global parameters, automatically crated carrier. purrr style function .x refer simulation output .y original observation data. n_sims number simulations run per wave (SMC Adaptive) overall (Rejection). rejection sampling large number recommended, others sma acceptance_rate proportion simulations keep ABC rejection hard ABC parts algorithms. ... must empty max_time maximum time seconds spend ABC waves admitting defeat. time may used algorithm converges. converged_fn function takes summary per_param input generates logical indicator function converged obsscores Summary scores observational data. named list, equivalent output scorer_fn, observed data. given typically assumed zeros. distance_method metric used combine simscores obsscores. One \"euclidean\", \"normalised\", \"manhattan\", \"mahalanobis\". seed optional random seed knots number knots model CDF . Optional, typically inferred data size. Small numbers tend work better expect distribution unimodal. parallel parallelise simulation? set true simulation step parallelised using furrr. make difference must set following: future::plan(future::multisession, workers = parallel::detectCores()-2) max_recover effective sample size SMC adaptive algorithms drops 200, algorithm retry wave double sample size try recover shape distribution, maximum max_recover times. allow_continue SMC adaptive algorithms converged max_time allow algorithm interactively prompt user continue. debug_errors Errors crop sim_fn simulation due anomolous value combinations hard debug. flag set, whenever sim_fn scorer_fn throws error interactive debugging session started failing parameter combinations. compatible running parallel. kernel one \"epanechnikov\" (default), \"uniform\", \"triangular\", \"biweight\", \"gaussian\". kernel defines distance metric translates importance weight decides whether given simulation associated parameters rejected held next round. kernels except gaussian hard cut-outside probability acceptance particle zero. Use gaussian kernels can result poor convergence. bw Adaptive ABC data distributions smoothed modelling CDF. smoothing can reduce convergence, -smoothing may result noisy posterior estimates. units ESS defaults 0.1. scoreweights named vector names matching output scorer_fn defines importance component scoring overall distance weighting given simulation. can used assign weight certain parts model output. euclidean manhattan distance methods weights multiply output scorer_fn directly. 2 distance methods degree normalisation done first first wave scores make different components approximately relevance overall score.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_adaptive.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform ABC sequential adaptive fitting — abc_adaptive","text":"S3 object class abc_fit contains following: type: type ABC algorithm iterations: number completed iterations converged: boolean - result meet convergence criteria waves: list dataframes wave convergence metrics summary: dataframe summary parameter fits wave. priors: priors fit abc_prior S3 object posteriors: final wave posteriors","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_adaptive.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Perform ABC sequential adaptive fitting — abc_adaptive","text":"Performs ABC Adaptive algorithm. iterative method refines parameter estimates across waves fitting empirical proposal distributions weighted posterior samples previous wave. Unlike ABC-SMC, uses fixed perturbation kernel, abc_adaptive constructs new proposal distribution \\(Q_t(\\theta)\\) wave \\(t\\). Initialization (Wave 1): Parameters \\(\\theta^{()}\\) sampled prior \\(P(\\theta)\\). Simulations run, summary statistics \\(S_s^{()}\\) computed, distances \\(d^{()} = d(S_s^{()}, S_o)\\) calculated. tolerance threshold \\(\\epsilon_1\\) set \\(\\alpha = \\texttt{acceptance\\_rate}\\) quantile distances. Unnormalized weights \\(\\tilde{w}^{()}_1\\) calculated using kernel \\(K_{\\epsilon_1}(d^{()})\\). Subsequent Waves (\\(t > 1\\)): Proposal Generation: empirical joint proposal distribution \\(Q_t(\\theta)\\) constructed weighted posterior sample \\(\\{(\\theta^{()}_{t-1}, w^{()}_{t-1})\\}\\) previous wave. done fitting marginal empirical distributions \\(Q_{t,j}(\\theta_j)\\) parameter \\(\\theta_j\\), using empirical() function prior \\(P_j(\\theta_j)\\) link enforce support constraints. marginals assumed independent, weighted correlation matrix \\(R_t\\) retained attribute used induce dependence MVN sampling space. New proposals \\(\\theta^{()}_t\\) generated : Sampling vector \\(Z \\sim \\mathcal{N}(0, R_t)\\) correlated standard normal space. Mapping component \\(Z_j\\) uniform space: \\(U_j = \\Phi(Z_j)\\). Mapping parameter space using empirical quantile functions: \\(\\theta^{()}_{t,j} = Q_{t,j}^{-1}(U_j)\\). Simulation Weighting: Simulations run new proposals. Distances \\(d^{()}_t\\) computed tolerance \\(\\epsilon_t\\) set \\(\\alpha\\)-quantile current wave's distances. unnormalized weight particle \\(\\) wave \\(t\\) calculated : $$        \\tilde{w}^{()}_t = \\frac{P(\\theta^{()}_t) K_{\\epsilon_t}(d^{()}_t)}{Q_t(\\theta^{()}_t)}      $$ \\(P(\\theta^{()}_t) = \\prod_j P_j(\\theta^{()}_{t,j})\\) prior density (assuming independence), \\(K_{\\epsilon_t}\\) ABC kernel, \\(Q_t(\\theta^{()}_t) = \\prod_j Q_{t,j}(\\theta^{()}_{t,j})\\) empirical proposal density (also assuming independence density calculation, consistent marginal fitting). correlation structure handled sampling process, density evaluation, common practical approximation. Normalization: Weights \\(w^{()}_t\\) normalized sum one. algorithm includes recovery mechanism: Effective Sample Size (ESS) falls threshold (e.g., 200), acceptance rate increased (.e., \\(\\epsilon_t\\) made larger) accept particles improve ESS. Termination: process repeats maximum time reached convergence criteria based parameter stability credible interval contraction met.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_adaptive.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform ABC sequential adaptive fitting — abc_adaptive","text":"","code":"fit = abc_adaptive(   obsdata = example_obsdata(),   priors_list = example_priors_list(),   sim_fn = example_sim_fn,   scorer_fn = example_scorer_fn,   n_sims = 1000,   acceptance_rate = 0.25,   max_time = 5, # 5 seconds to fit within examples limit   parallel = FALSE,   allow_continue = FALSE ) #> ABC-Adaptive #> Adaptive waves:  ■■■■■■■■                          24% | wave 2 ETA:  5s #> Adaptive waves:  ■■■■■■■■■■■■■■■■■■■■■■            70% | wave 6 ETA:  2s #> Converged on wave: 7  summary(fit) #> ABC adaptive fit: 7 waves - (converged) #> Parameter estimates: #> # A tibble: 3 × 4 #> # Groups:   param [3] #>   param mean_sd       median_95_CrI           ESS #>   <chr> <chr>         <chr>                 <dbl> #> 1 mean  4.976 ± 0.032 4.973 [4.893 — 5.079]  304. #> 2 sd1   2.011 ± 0.059 2.012 [1.780 — 2.174]  304. #> 3 sd2   0.995 ± 0.031 0.995 [0.896 — 1.093]  304."},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"abc_fit S3 class — abc_fit","title":"abc_fit S3 class — abc_fit","text":"class holding output single ABC model fitting, either single ABC rejection round set SMC waves.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"abc_fit S3 class — abc_fit","text":"","code":"new_abc_fit(type, iterations, converged, priors_list, wave_df, summ_df, sim_df)  # S3 method for class 'abc_fit' format(x, ...)  # S3 method for class 'abc_fit' summary(object, ..., truth = NULL)  tidy.abc_fit(x, ...)  # S3 method for class 'abc_fit' print(x, ...)  # S3 method for class 'abc_fit' plot(x, ..., truth = NULL)"},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"abc_fit S3 class — abc_fit","text":"type type ABC algorithm iterations number completed iterations converged boolean - result meet convergence criteria priors_list named list priors specified abc_prior S3 object (see priors()), can include derived values unnamed 2-sided formulae, LHS formula assigned value RHS, plus optionally set constraints one sided formulae RHS formulae resolve boolean value. wave_df list dataframes wave convergence metrics summ_df summary parameter fits wave. sim_df final wave posteriors x abc_fit object output abc_XXX functions ... passed methods object abc_fit object output abc_XXX functions truth named numeric vector known parameter values","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"abc_fit S3 class — abc_fit","text":"S3 object class abc_fit contains following: type: type ABC algorithm iterations: number completed iterations converged: boolean - result meet convergence criteria waves: list dataframes wave convergence metrics summary: dataframe summary parameter fits wave. priors: priors fit abc_prior S3 object posteriors: final wave posteriors","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_fit.html","id":"methods-by-generic-","dir":"Reference","previous_headings":"","what":"Methods (by generic)","title":"abc_fit S3 class — abc_fit","text":"format(abc_fit): S3 format method summary(abc_fit): S3 summary method print(abc_fit): S3 print method plot(abc_fit): S3 plot method","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_fit.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"abc_fit S3 class — abc_fit","text":"new_abc_fit(): Create abc_fit object tidy.abc_fit(): S3 summary method","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"abc_prior S3 class — abc_prior","title":"abc_prior S3 class — abc_prior","text":"abc_prior S3 class","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"abc_prior S3 class — abc_prior","text":"","code":"new_abc_prior(.dists, .constraints = list(), .derived = list(), .cor = NULL)  as.abc_prior(x, ...)  is.abc_prior(x, ...)  # S3 method for class 'abc_prior' format(x, ...)  # S3 method for class 'abc_prior' print(x, ...)  # S3 method for class 'abc_prior' plot(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"abc_prior S3 class — abc_prior","text":".dists distribution functions named list S3 dist_fns objects .constraints list one sided formulae result evaluate boolean compared names priors derived values. .derived list two sided formulae. RHS refer priors, LHS name derive. .cor (optional) correlation matrix priors x abc_prior S3 object ... passed methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"abc_prior S3 class — abc_prior","text":"S3 object class abc_prior contains list dist_fns cor attribute describing correlation derived attribute describing derive values constraints attribute listing constraints params attribute listing names parameters","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_prior.html","id":"methods-by-generic-","dir":"Reference","previous_headings":"","what":"Methods (by generic)","title":"abc_prior S3 class — abc_prior","text":"format(abc_prior): Format abc_prior print(abc_prior): Print abc_prior plot(abc_prior): Plot abc_prior","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_prior.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"abc_prior S3 class — abc_prior","text":"new_abc_prior(): Create new prior .abc_prior(): Create prior named list dist_fns .abc_prior(): Test abc_prior","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_prior.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"abc_prior S3 class — abc_prior","text":"","code":"p = new_abc_prior(   .dists = list(     mean = as.dist_fns(\"norm\",4,2),     sd = as.dist_fns(\"gamma\",2)   ),   .derived = list(     shape ~ mean^2 / sd^2,     rate ~ mean / sd^2   ),   .constraints = list(     ~ mean > sd   ) )  testthat::expect_equal(   format(p),   \"Parameters: \\n* mean: norm(mean = 4, sd = 2)\\n* sd: gamma(shape = 2, rate = 1)\\nConstraints:\\n* mean > sd\\nDerived values:\\n* shape = mean^2/sd^2\\n* rate = mean/sd^2\" )"},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_rejection.html","id":null,"dir":"Reference","previous_headings":"","what":"Perfom simple ABC rejection algorithm — abc_rejection","title":"Perfom simple ABC rejection algorithm — abc_rejection","text":"function execute simulation random selection parameters identify best matching acceptance_rate percent, defined summary distance metric. large number simulations low acceptance rate best .","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_rejection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perfom simple ABC rejection algorithm — abc_rejection","text":"","code":"abc_rejection(   obsdata,   priors_list,   sim_fn,   scorer_fn,   n_sims,   acceptance_rate,   ...,   converged_fn = default_termination_fn(),   obsscores = NULL,   distance_method = \"euclidean\",   keep_simulations = FALSE,   seed = NULL,   parallel = FALSE,   debug_errors = FALSE,   kernel = \"epanechnikov\",   scoreweights = NULL )"},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_rejection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perfom simple ABC rejection algorithm — abc_rejection","text":"obsdata observational data. data typically named list, anything, e.g. dataframe. reference data simulation model aiming replicate. priors_list named list priors specified abc_prior S3 object (see priors()), can include derived values unnamed 2-sided formulae, LHS formula assigned value RHS, plus optionally set constraints one sided formulae RHS formulae resolve boolean value. sim_fn user defined function takes set parameters named priors_list. must return simulated data set format obsdata, can compared simdata scorer_fn. function must refer global parameters, automatically crated carrier. scorer_fn user supplied function matches following signature scorer_fn(simdata, obsdata, ....), .e. takes data format simdata paired original obsdata returns named list component scores per simulation. function can make use calculate_*() set functions compare components simulation original data. function must refer global parameters, automatically crated carrier. purrr style function .x refer simulation output .y original observation data. n_sims number simulations run per wave (SMC Adaptive) overall (Rejection). rejection sampling large number recommended, others sma acceptance_rate proportion simulations keep ABC rejection hard ABC parts algorithms. ... must empty converged_fn function takes summary per_param input generates logical indicator function converged obsscores Summary scores observational data. named list, equivalent output scorer_fn, observed data. given typically assumed zeros. distance_method metric used combine simscores obsscores. One \"euclidean\", \"normalised\", \"manhattan\", \"mahalanobis\". keep_simulations keep individual simulation results output ABC workflow. can large implications size result. may also want probably worth considering resampling posteriors rather keeping simulations. seed optional random seed parallel parallelise simulation? set true simulation step parallelised using furrr. make difference must set following: future::plan(future::multisession, workers = parallel::detectCores()-2) debug_errors Errors crop sim_fn simulation due anomolous value combinations hard debug. flag set, whenever sim_fn scorer_fn throws error interactive debugging session started failing parameter combinations. compatible running parallel. kernel one \"epanechnikov\" (default), \"uniform\", \"triangular\", \"biweight\", \"gaussian\". kernel defines distance metric translates importance weight decides whether given simulation associated parameters rejected held next round. kernels except gaussian hard cut-outside probability acceptance particle zero. Use gaussian kernels can result poor convergence. scoreweights named vector names matching output scorer_fn defines importance component scoring overall distance weighting given simulation. can used assign weight certain parts model output. euclidean manhattan distance methods weights multiply output scorer_fn directly. 2 distance methods degree normalisation done first first wave scores make different components approximately relevance overall score.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_rejection.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perfom simple ABC rejection algorithm — abc_rejection","text":"S3 object class abc_fit contains following: type: type ABC algorithm iterations: number completed iterations converged: boolean - result meet convergence criteria waves: list dataframes wave convergence metrics summary: dataframe summary parameter fits wave. priors: priors fit abc_prior S3 object posteriors: final wave posteriors","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_rejection.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Perfom simple ABC rejection algorithm — abc_rejection","text":"Parameters \\(\\theta^{()}\\) sampled independently prior distribution \\(P(\\theta)\\) \\(= 1, \\dots, n_{\\text{sims}}\\). \\(\\theta^{()}\\), simulated data \\(D_s^{()} = M(\\theta^{()})\\) generated via simulator function sim_fn, vector summary statistics \\(S_s^{()} = \\texttt{scorer\\_fn}(D_s^{()})\\) computed compared observed summary statistics \\(S_o = \\texttt{scorer\\_fn}(D_o)\\). distance metric \\(d^{()} = d(S_s^{()}, S_o)\\) computed. default, Euclidean distance: $$   d^{()} = \\left\\| W \\circ (S_s^{()} - S_o) \\right\\|_2, $$ \\(W\\) vector optional summary statistic weights (scoreweights), \\(\\circ\\) denotes element-wise multiplication. supported metrics include Manhattan (\\(\\ell_1\\)) Mahalanobis distance (using empirical covariance first wave). tolerance threshold \\(\\epsilon\\) set \\(\\alpha = \\texttt{acceptance\\_rate}\\) quantile distances \\(\\{d^{()}\\}_{=1}^{n_{\\text{sims}}}\\): $$   \\epsilon = \\text{quantile}\\big(\\{d^{()}\\}, \\alpha\\big). $$ Unnormalized ABC weights assigned using kernel function \\(K_\\epsilon(\\cdot)\\): $$   \\tilde{w}^{()} = K_\\epsilon\\big(d^{()}\\big), $$ \\(K_\\epsilon(d)\\) one kernels defined kernels.R (e.g., Epanechnikov: \\(K_\\epsilon(d) = \\frac{3}{4\\epsilon} (1 - d^2\\!/\\!\\epsilon^2)\\, \\mathbb{}(d \\leq \\epsilon)\\)). weights transformed via logistic (\"expit\") function normalized sum one: $$   w^{()} = \\frac{\\text{expit}(\\log \\tilde{w}^{()})}{     \\sum_j \\text{expit}(\\log \\tilde{w}^{(j)})}   = \\frac{ \\tilde{w}^{()} / (1 + \\tilde{w}^{()}) }{     \\sum_j \\tilde{w}^{(j)} / (1 + \\tilde{w}^{(j)}) }. $$ resulting weighted sample \\(\\{(\\theta^{()}, w^{()})\\}\\) approximates ABC posterior distribution \\(P_\\epsilon(\\theta \\mid D_o)\\).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_rejection.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perfom simple ABC rejection algorithm — abc_rejection","text":"","code":"fit = abc_rejection(   example_obsdata(),   example_priors_list(),   example_sim_fn,   example_scorer_fn,   n_sims = 10000,   acceptance_rate = 0.01 ) #> ABC rejection, 1 wave.  summary(fit) #> ABC rejection fit: single wave #> Parameter estimates: #> # A tibble: 3 × 4 #> # Groups:   param [3] #>   param mean_sd       median_95_CrI           ESS #>   <chr> <chr>         <chr>                 <dbl> #> 1 mean  4.974 ± 0.197 5.001 [4.559 — 5.401]  69.2 #> 2 sd1   2.382 ± 0.559 2.267 [1.548 — 4.033]  69.2 #> 3 sd2   1.209 ± 0.294 1.148 [0.717 — 2.067]  69.2"},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_smc.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform ABC sequential Monte Carlo fitting — abc_smc","title":"Perform ABC sequential Monte Carlo fitting — abc_smc","text":"function execute simulation random selection parameters. Based acceptance_rate reject proportion results. remaining results weighted (using kernel tolerance equivalent half acceptance rate). Weighted parameter particles generate proposals waves particle perturbation. Waves executed maximum reached results converge sufficiently changes waves small. relatively small number simulations may attempted high acceptance rate, multiple waves.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_smc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform ABC sequential Monte Carlo fitting — abc_smc","text":"","code":"abc_smc(   obsdata,   priors_list,   sim_fn,   scorer_fn,   n_sims,   acceptance_rate,   ...,   max_time = 5 * 60,   converged_fn = default_termination_fn(),   obsscores = NULL,   distance_method = \"euclidean\",   seed = NULL,   parallel = FALSE,   allow_continue = interactive(),   debug_errors = FALSE,   kernel = \"epanechnikov\",   scoreweights = NULL )"},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_smc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform ABC sequential Monte Carlo fitting — abc_smc","text":"obsdata observational data. data typically named list, anything, e.g. dataframe. reference data simulation model aiming replicate. priors_list named list priors specified abc_prior S3 object (see priors()), can include derived values unnamed 2-sided formulae, LHS formula assigned value RHS, plus optionally set constraints one sided formulae RHS formulae resolve boolean value. sim_fn user defined function takes set parameters named priors_list. must return simulated data set format obsdata, can compared simdata scorer_fn. function must refer global parameters, automatically crated carrier. scorer_fn user supplied function matches following signature scorer_fn(simdata, obsdata, ....), .e. takes data format simdata paired original obsdata returns named list component scores per simulation. function can make use calculate_*() set functions compare components simulation original data. function must refer global parameters, automatically crated carrier. purrr style function .x refer simulation output .y original observation data. n_sims number simulations run per wave (SMC Adaptive) overall (Rejection). rejection sampling large number recommended, others sma acceptance_rate proportion simulations keep ABC rejection hard ABC parts algorithms. ... must empty max_time maximum time seconds spend ABC waves admitting defeat. time may used algorithm converges. converged_fn function takes summary per_param input generates logical indicator function converged obsscores Summary scores observational data. named list, equivalent output scorer_fn, observed data. given typically assumed zeros. distance_method metric used combine simscores obsscores. One \"euclidean\", \"normalised\", \"manhattan\", \"mahalanobis\". seed optional random seed parallel parallelise simulation? set true simulation step parallelised using furrr. make difference must set following: future::plan(future::multisession, workers = parallel::detectCores()-2) allow_continue SMC adaptive algorithms converged max_time allow algorithm interactively prompt user continue. debug_errors Errors crop sim_fn simulation due anomolous value combinations hard debug. flag set, whenever sim_fn scorer_fn throws error interactive debugging session started failing parameter combinations. compatible running parallel. kernel one \"epanechnikov\" (default), \"uniform\", \"triangular\", \"biweight\", \"gaussian\". kernel defines distance metric translates importance weight decides whether given simulation associated parameters rejected held next round. kernels except gaussian hard cut-outside probability acceptance particle zero. Use gaussian kernels can result poor convergence. scoreweights named vector names matching output scorer_fn defines importance component scoring overall distance weighting given simulation. can used assign weight certain parts model output. euclidean manhattan distance methods weights multiply output scorer_fn directly. 2 distance methods degree normalisation done first first wave scores make different components approximately relevance overall score.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_smc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform ABC sequential Monte Carlo fitting — abc_smc","text":"S3 object class abc_fit contains following: type: type ABC algorithm iterations: number completed iterations converged: boolean - result meet convergence criteria waves: list dataframes wave convergence metrics summary: dataframe summary parameter fits wave. priors: priors fit abc_prior S3 object posteriors: final wave posteriors","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_smc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Perform ABC sequential Monte Carlo fitting — abc_smc","text":"Performs ABC Sequential Monte Carlo (SMC) algorithm. iterative method refines parameter estimates across multiple waves. Initialization (Wave 1): Parameters \\(\\theta^{()}\\) sampled prior \\(P(\\theta)\\). Simulations \\(D_s^{()} = M(\\theta^{()})\\) run, summaries \\(S_s^{()}\\) computed, distances \\(d^{()} = d(S_s^{()}, S_o)\\) calculated. tolerance threshold \\(\\epsilon_1\\) set \\(\\alpha = \\texttt{acceptance\\_rate}\\) quantile initial distances. Unnormalized weights \\(\\tilde{w}^{()}_1\\) calculated using kernel \\(K_{\\epsilon_1}(d^{()})\\). Subsequent Waves (\\(t > 1\\)): Proposal Generation: particle \\(\\theta^{(j)}_{t-1}\\) selected previous wave's accepted particles probability proportional weight \\(w^{(j)}_{t-1}\\). particle perturbed transformed MVN space using multivariate normal kernel covariance \\(\\Sigma_t = \\frac{\\kappa_t^2}{d} \\text{Cov}_{w_{t-1}}(\\theta_{t-1})\\), \\(\\text{Cov}_{w_{t-1}}\\) weighted covariance wave \\(t-1\\), \\(d\\) parameter dimension, \\(\\kappa_t\\) kernel_t parameter. new proposal \\(\\theta^{()}_t\\) generated : $$        \\theta^{()}_t = \\theta^{(j)}_{t-1} + \\zeta, \\quad \\zeta \\sim \\mathcal{N}(0, \\Sigma_t)      $$ proposal mapped back original parameter space using prior's copula transformation (MVN space defined prior CDFs). Simulation Weighting: Simulations \\(D_s^{()} = M(\\theta^{()}_t)\\) run new proposals. Distances \\(d^{()}_t\\) computed. tolerance \\(\\epsilon_t\\) set \\(\\alpha\\)-quantile distances current wave's simulations. unnormalized weight particle \\(\\) wave \\(t\\) calculated : $$        \\tilde{w}^{()}_t = \\frac{P(\\theta^{()}_t) K_{\\epsilon_t}(d^{()}_t)}{q_t(\\theta^{()}_t)}      $$ \\(P(\\theta^{()}_t)\\) prior density, \\(K_{\\epsilon_t}\\) ABC kernel, \\(q_t(\\theta^{()}_t)\\) proposal density previous wave's weighted particles (calculated using perturbation kernel). proposal density computed weighted sum: $$        q_t(\\theta^{()}_t) = \\sum_j w^{(j)}_{t-1} \\phi(\\theta^{()}_t; \\theta^{(j)}_{t-1}, \\Sigma_t)      $$ \\(\\phi(\\cdot; \\mu, \\Sigma)\\) PDF multivariate normal mean \\(\\mu\\) covariance \\(\\Sigma\\). Normalization: Weights \\(w^{()}_t\\) normalized sum one. Particles negligible weights typically filtered . Termination: process repeats maximum number waves time reached, convergence criteria met based changes parameter estimates effective sample size (ESS).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/abc_smc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform ABC sequential Monte Carlo fitting — abc_smc","text":"","code":"fit = abc_smc(   obsdata = example_obsdata(),   priors_list = example_priors_list(),   sim_fn = example_sim_fn,   scorer_fn = example_scorer_fn,   n_sims = 1000,   acceptance_rate = 0.25,   max_time = 5, # 5 seconds to fit within examples limit   parallel = FALSE,   allow_continue = FALSE ) #> ABC-SMC #> SMC waves:  ■■■■■■■                           20% | wave 1 ETA:  4s #> SMC waves:  ■■■■■■■■■■■■■■■■■■                56% | wave 4 ETA:  2s #> Converged on wave: 8 #> SMC waves:  ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■     94% | wave 7 ETA:  0s  summary(fit) #> ABC SMC fit: 8 waves - (converged) #> Parameter estimates: #> # A tibble: 3 × 4 #> # Groups:   param [3] #>   param mean_sd       median_95_CrI           ESS #>   <chr> <chr>         <chr>                 <dbl> #> 1 mean  4.978 ± 0.034 4.979 [4.876 — 5.072]  248. #> 2 sd1   1.983 ± 0.067 1.982 [1.805 — 2.164]  248. #> 3 sd2   0.989 ± 0.044 0.989 [0.878 — 1.106]  248."},{"path":"https://ai4ci.github.io/tidyabc/reference/as.character.dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Cast a dist_fns S3 object to a character vector — as.character.dist_fns","title":"Cast a dist_fns S3 object to a character vector — as.character.dist_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.character.dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cast a dist_fns S3 object to a character vector — as.character.dist_fns","text":"","code":"# S3 method for class 'dist_fns' as.character(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/as.character.dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cast a dist_fns S3 object to a character vector — as.character.dist_fns","text":"x dist_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.character.dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cast a dist_fns S3 object to a character vector — as.character.dist_fns","text":"character vector","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.character.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a dist_fns_list to character — as.character.dist_fns_list","title":"Convert a dist_fns_list to character — as.character.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.character.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a dist_fns_list to character — as.character.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' as.character(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/as.character.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a dist_fns_list to character — as.character.dist_fns_list","text":"x dist_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.character.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a dist_fns_list to character — as.character.dist_fns_list","text":"character vector","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.character.link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Cast a link_fns S3 object to a character vector — as.character.link_fns","title":"Cast a link_fns S3 object to a character vector — as.character.link_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.character.link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cast a link_fns S3 object to a character vector — as.character.link_fns","text":"","code":"# S3 method for class 'link_fns' as.character(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/as.character.link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cast a link_fns S3 object to a character vector — as.character.link_fns","text":"x link_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.character.link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cast a link_fns S3 object to a character vector — as.character.link_fns","text":"character vector","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.character.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a link_fns_list to character — as.character.link_fns_list","title":"Convert a link_fns_list to character — as.character.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.character.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a link_fns_list to character — as.character.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' as.character(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/as.character.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a link_fns_list to character — as.character.link_fns_list","text":"x link_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.character.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a link_fns_list to character — as.character.link_fns_list","text":"character vector","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.dist_fns.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Default method throws error — as.dist_fns.default","title":"Default method throws error — as.dist_fns.default","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.dist_fns.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default method throws error — as.dist_fns.default","text":"","code":"# Default S3 method as.dist_fns(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/as.dist_fns.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Default method throws error — as.dist_fns.default","text":"x dist_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.dist_fns.default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default method throws error — as.dist_fns.default","text":"nothing","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a dist_fns S3 object — as.dist_fns.character","title":"Create a dist_fns S3 object — as.dist_fns.character","text":"class wrapping single (set) parametrised distributions provides access quantile, cumulative probability random functions specific distribution. Parametrisation handled construction.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a dist_fns S3 object — as.dist_fns.character","text":"","code":"# S3 method for class 'character' as.dist_fns(x, ...)  # S3 method for class '`function`' as.dist_fns(x, ...)  # S3 method for class 'fitdist' as.dist_fns(x, ...)  as.dist_fns(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/as.dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a dist_fns S3 object — as.dist_fns.character","text":"x dist_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a dist_fns S3 object — as.dist_fns.character","text":"dist_fns S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.dist_fns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a dist_fns S3 object — as.dist_fns.character","text":"dist_fns dist_fns_list objects support $ access fields @ access attributes. dist_fns_lists can made c() rep() functions, purrr style map functions, support subsetting. Individual dist_fns members dist_fns_lists can accessed [[.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.dist_fns.html","id":"methods-by-class-","dir":"Reference","previous_headings":"","what":"Methods (by class)","title":"Create a dist_fns S3 object — as.dist_fns.character","text":".dist_fns(character): Construct distribution name .dist_fns(`function`): statistical function .dist_fns(fitdist): fitdistrplus::fitdist output","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.dist_fns.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Create a dist_fns S3 object — as.dist_fns.character","text":"","code":"pois = as.dist_fns(\"pois\",lambda = 8) n = as.dist_fns(\"norm\",mean=4)"},{"path":"https://ai4ci.github.io/tidyabc/reference/as.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Cast to a list of dist_fns S3 objects — as.dist_fns_list","title":"Cast to a list of dist_fns S3 objects — as.dist_fns_list","text":"function wraps dist_fns unwraps plain lists result flat dist_fns_list containing dist_fns objects ","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cast to a list of dist_fns S3 objects — as.dist_fns_list","text":"","code":"as.dist_fns_list(x)"},{"path":"https://ai4ci.github.io/tidyabc/reference/as.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cast to a list of dist_fns S3 objects — as.dist_fns_list","text":"x dist_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cast to a list of dist_fns S3 objects — as.dist_fns_list","text":"dist_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.link_fns.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Default method throws error — as.link_fns.default","title":"Default method throws error — as.link_fns.default","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.link_fns.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default method throws error — as.link_fns.default","text":"","code":"# Default S3 method as.link_fns(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/as.link_fns.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Default method throws error — as.link_fns.default","text":"x link_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.link_fns.default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default method throws error — as.link_fns.default","text":"nothing","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a link_fns S3 object — as.link_fns.character","title":"Create a link_fns S3 object — as.link_fns.character","text":"link function class allows forwards backwards transformation. Link functions can defined name using statistical distribution case forward link logit cumulative probability reverse quantile expit.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a link_fns S3 object — as.link_fns.character","text":"","code":"# S3 method for class 'character' as.link_fns(x, ...)  # S3 method for class 'dist_fns' as.link_fns(x, ...)  # S3 method for class 'family' as.link_fns(x, ...)  # S3 method for class 'numeric' as.link_fns(x, ..., na.rm = TRUE)  as.link_fns(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/as.link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a link_fns S3 object — as.link_fns.character","text":"x range values support ... ignored na.rm remove NAs estimating mean sd data driven link functions","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a link_fns S3 object — as.link_fns.character","text":"link_fns S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.link_fns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a link_fns S3 object — as.link_fns.character","text":"link_fns S3 object encapsulates monotonic transformation function \\(h\\), inverse \\(h^{-1}\\), derivatives \\(h'\\) \\((h^{-1})'\\). also defines support (domain) \\([, b]\\) original space range \\([h(), h(b)]\\) transformed space. function dispatches based input x: character: Selects standard links (e.g., \"log\", \"logit\", \"probit\", \"identity\"). example, \"log\" defines \\(h(x) = \\log(x)\\) support \\((0, \\infty)\\). dist_fns: Defines link logit CDF quantile expit: \\(h(x) = \\text{logit}(F(x))\\), \\(h^{-1}(z) = F^{-1}(\\text{expit}(z))\\), \\(F\\) \\(F^{-1}\\) CDF quantile functions dist_fns object. support determined quantile function's range (e.g., \\([Q(0), Q(1)]\\)). family (stats): Uses link function inverse GLM family object. numeric: length 2, interprets support range \\([, b]\\) creates logit-like transformation mapping range \\((-\\infty, \\infty)\\): \\(h(x) = \\text{logit}(\\frac{x-}{b-})\\). values finite length > 2, creates standardization link: \\(h(x) = \\frac{x-\\mu}{\\sigma}\\), \\(\\mu\\) \\(\\sigma\\) mean standard deviation input vector.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.link_fns.html","id":"methods-by-class-","dir":"Reference","previous_headings":"","what":"Methods (by class)","title":"Create a link_fns S3 object — as.link_fns.character","text":".link_fns(character): Link function name .link_fns(dist_fns): Link function name .link_fns(family): Link function name .link_fns(numeric): Link function support vector","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.link_fns.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Create a link_fns S3 object — as.link_fns.character","text":"","code":"links = c(\"ident\", \"log\", \"logit\", \"probit\", \"cloglog\", \"neginv\", \"inv2\") test = seq(0.1,0.9,0.1) # within support of all links for (l in links) {   lfn = as.link_fns(l)   t = lfn$trans(test)   i = lfn$inv(t)   testthat::expect_equal(i,test) }"},{"path":"https://ai4ci.github.io/tidyabc/reference/as.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Cast to a list of link_fns S3 objects — as.link_fns_list","title":"Cast to a list of link_fns S3 objects — as.link_fns_list","text":"function wraps link_fns unwraps plain lists result flat link_fns_list containing link_fns objects ","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cast to a list of link_fns S3 objects — as.link_fns_list","text":"","code":"as.link_fns_list(x)"},{"path":"https://ai4ci.github.io/tidyabc/reference/as.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cast to a list of link_fns S3 objects — as.link_fns_list","text":"x link_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cast to a list of link_fns S3 objects — as.link_fns_list","text":"link_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.list.dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a dist_fns S3 object into a plain list — as.list.dist_fns","title":"Convert a dist_fns S3 object into a plain list — as.list.dist_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.list.dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a dist_fns S3 object into a plain list — as.list.dist_fns","text":"","code":"# S3 method for class 'dist_fns' as.list(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/as.list.dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a dist_fns S3 object into a plain list — as.list.dist_fns","text":"x dist_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.list.dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a dist_fns S3 object into a plain list — as.list.dist_fns","text":"internal structure object plain list","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.list.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Un format the dist_fns_list — as.list.dist_fns_list","title":"Un format the dist_fns_list — as.list.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.list.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Un format the dist_fns_list — as.list.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' as.list(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/as.list.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Un format the dist_fns_list — as.list.dist_fns_list","text":"x dist_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.list.link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a link_fns S3 object into a plain list — as.list.link_fns","title":"Convert a link_fns S3 object into a plain list — as.list.link_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.list.link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a link_fns S3 object into a plain list — as.list.link_fns","text":"","code":"# S3 method for class 'link_fns' as.list(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/as.list.link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a link_fns S3 object into a plain list — as.list.link_fns","text":"x link_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.list.link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a link_fns S3 object into a plain list — as.list.link_fns","text":"internal structure object plain list","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.list.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Un format the link_fns_list — as.list.link_fns_list","title":"Un format the link_fns_list — as.list.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/as.list.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Un format the link_fns_list — as.list.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' as.list(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/as.list.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Un format the link_fns_list — as.list.link_fns_list","text":"x link_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/at.crate.html","id":null,"dir":"Reference","previous_headings":"","what":"Explore crated data for a crate — at.crate","title":"Explore crated data for a crate — at.crate","text":"Explore crated data crate","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/at.crate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Explore crated data for a crate — at.crate","text":"","code":"# S3 method for class 'crate' x$y"},{"path":"https://ai4ci.github.io/tidyabc/reference/at.crate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Explore crated data for a crate — at.crate","text":"x crated function y item retrieve","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/at.crate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Explore crated data for a crate — at.crate","text":"crated data x","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/at.dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract named attribute from a abc_prior — at.dist_fns","title":"Extract named attribute from a abc_prior — at.dist_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/at.dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract named attribute from a abc_prior — at.dist_fns","text":"","code":"# S3 method for class 'abc_prior' x@y  # S3 method for class 'dist_fns' x@y"},{"path":"https://ai4ci.github.io/tidyabc/reference/at.dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract named attribute from a abc_prior — at.dist_fns","text":"x abc_prior S3 object y item retrieve","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/at.dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract named attribute from a abc_prior — at.dist_fns","text":"attribute value x attribute value x","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/at.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract named item(s) from a dist_fns_list — at.dist_fns_list","title":"Extract named item(s) from a dist_fns_list — at.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/at.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract named item(s) from a dist_fns_list — at.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' x@y"},{"path":"https://ai4ci.github.io/tidyabc/reference/at.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract named item(s) from a dist_fns_list — at.dist_fns_list","text":"x dist_fns_list S3 object y attribute retrieve","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/at.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract named item(s) from a dist_fns_list — at.dist_fns_list","text":"vector list underlying dist_fns attribute values","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/at.link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract named attribute from a link_fns — at.link_fns","title":"Extract named attribute from a link_fns — at.link_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/at.link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract named attribute from a link_fns — at.link_fns","text":"","code":"# S3 method for class 'link_fns' x@y"},{"path":"https://ai4ci.github.io/tidyabc/reference/at.link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract named attribute from a link_fns — at.link_fns","text":"x link_fns S3 object y item retrieve","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/at.link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract named attribute from a link_fns — at.link_fns","text":"attribute value x","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/at.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract named item(s) from a link_fns_list — at.link_fns_list","title":"Extract named item(s) from a link_fns_list — at.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/at.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract named item(s) from a link_fns_list — at.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' x@y"},{"path":"https://ai4ci.github.io/tidyabc/reference/at.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract named item(s) from a link_fns_list — at.link_fns_list","text":"x link_fns_list S3 object y attribute retrieve","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/at.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract named item(s) from a link_fns_list — at.link_fns_list","text":"vector list underlying link_fns attribute values","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/c.dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Concatenate a dist_fns S3 object or dist_fns_lists — c.dist_fns","title":"Concatenate a dist_fns S3 object or dist_fns_lists — c.dist_fns","text":"Concatenate dist_fns S3 object dist_fns_lists","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/c.dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Concatenate a dist_fns S3 object or dist_fns_lists — c.dist_fns","text":"","code":"# S3 method for class 'dist_fns' c(...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/c.dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Concatenate a dist_fns S3 object or dist_fns_lists — c.dist_fns","text":"... dist_fns, dist_fns_lists lists dist_fns","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/c.dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Concatenate a dist_fns S3 object or dist_fns_lists — c.dist_fns","text":"dist_fns_list","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/c.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Concatenate or construct a dist_fns_list — c.dist_fns_list","title":"Concatenate or construct a dist_fns_list — c.dist_fns_list","text":"Concatenate construct dist_fns_list","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/c.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Concatenate or construct a dist_fns_list — c.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' c(...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/c.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Concatenate or construct a dist_fns_list — c.dist_fns_list","text":"... dist_fns_list dist_fns list dist_fnss","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/c.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Concatenate or construct a dist_fns_list — c.dist_fns_list","text":"flattened dist_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/c.link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Concatenate a link_fns S3 object or link_fns_lists — c.link_fns","title":"Concatenate a link_fns S3 object or link_fns_lists — c.link_fns","text":"Concatenate link_fns S3 object link_fns_lists","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/c.link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Concatenate a link_fns S3 object or link_fns_lists — c.link_fns","text":"","code":"# S3 method for class 'link_fns' c(...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/c.link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Concatenate a link_fns S3 object or link_fns_lists — c.link_fns","text":"... link_fns, link_fns_lists lists link_fns","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/c.link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Concatenate a link_fns S3 object or link_fns_lists — c.link_fns","text":"link_fns_list","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/c.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Concatenate or construct a link_fns_list — c.link_fns_list","title":"Concatenate or construct a link_fns_list — c.link_fns_list","text":"Concatenate construct link_fns_list","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/c.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Concatenate or construct a link_fns_list — c.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' c(...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/c.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Concatenate or construct a link_fns_list — c.link_fns_list","text":"... link_fns_list link_fns list link_fnss","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/c.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Concatenate or construct a link_fns_list — c.link_fns_list","text":"flattened link_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/calculate_rmse.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a function to calculate a Root Mean Squared Error (RMSE) — calculate_rmse","title":"Generate a function to calculate a Root Mean Squared Error (RMSE) — calculate_rmse","text":"function takes reference data form, example count data, returns crated function calculate mean squared error simulated data observed data. $$ \\text{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{=1}^{N} (x_i - y_i)^2} $$ \\(x_i\\) simulated data points, \\(y_i\\) observed data points, \\(N\\) number data points. input vectors must length. Missing values (NA) removed pairwise calculation. Returns NA input vectors equal length.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/calculate_rmse.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a function to calculate a Root Mean Squared Error (RMSE) — calculate_rmse","text":"","code":"calculate_rmse(sim, obs)"},{"path":"https://ai4ci.github.io/tidyabc/reference/calculate_rmse.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a function to calculate a Root Mean Squared Error (RMSE) — calculate_rmse","text":"sim vector simulated counts obs vector observed counts","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/calculate_rmse.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a function to calculate a Root Mean Squared Error (RMSE) — calculate_rmse","text":"square root average squared distance simulation observation. Simulation observation must length.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/calculate_rmse.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Generate a function to calculate a Root Mean Squared Error (RMSE) — calculate_rmse","text":"","code":"# zero if no distance testthat::expect_equal(calculate_rmse(0:10, 0:10), 0)  testthat::expect_equal(   calculate_rmse(rep(5, 11), 0:10),   3.16227766016838 )  withr::with_seed(100, {    ref = rnorm(1000)    cmp1 = rnorm(1000)    cmp2 = rnorm(1000, sd=2) })  breaks = seq(-2,2,length.out=8) nref = table(cut(ref,breaks)) ncmp1 = table(cut(cmp1,breaks)) ncmp2 = table(cut(cmp2,breaks))  tmp1 = calculate_rmse(ncmp1, nref) tmp2 = calculate_rmse(ncmp2, nref)  testthat::expect_equal(tmp1, 10.3578817470424) testthat::expect_equal(tmp2, 68.8403951179829)"},{"path":"https://ai4ci.github.io/tidyabc/reference/calculate_wasserstein.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate a Wasserstein distance — calculate_wasserstein","title":"Calculate a Wasserstein distance — calculate_wasserstein","text":"function takes simulation observed data calculates normalised Wasserstein distance.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/calculate_wasserstein.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate a Wasserstein distance — calculate_wasserstein","text":"","code":"calculate_wasserstein(sim, obs, debias = FALSE, bootstraps = 1)"},{"path":"https://ai4ci.github.io/tidyabc/reference/calculate_wasserstein.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate a Wasserstein distance — calculate_wasserstein","text":"sim vector simulated data points obs vector observed data points debias simulations shifted match mean observed data bootstraps Randomly resample simulated data points match observed size many times combine output averaging. alternative, 1 (default) matches sizes selecting /repeating simulated data points order (deterministically)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/calculate_wasserstein.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate a Wasserstein distance — calculate_wasserstein","text":"length normalised wasserstein distance. average distance individual simulated data point must shifted match observed data normalised average distance observed data mean.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/calculate_wasserstein.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate a Wasserstein distance — calculate_wasserstein","text":"comparison unequal lengths data can accommodated. simulated data sorted linearly interpolated length observed data comparison. $$ W = \\frac{1}{N_{obs} \\cdot \\sigma_{obs}} \\sum_{=1}^{N_{obs}} | \\hat{x}_i - y_i | $$ \\(y_i\\) ordered observed data points, \\(\\hat{x}_i\\) simulated data points matching size (potentially via interpolation), debiasing (optional), sorting, \\(N_{obs}\\) number observed points, \\(\\sigma_{obs}\\) standard deviation observed data (used normalisation). Size matching via linear interpolation: Let \\(x\\) sorted simulated data length \\(N_{sim}\\), \\(N_{obs}\\) target length. Indices \\(idx\\) generated \\(idx = \\frac{(-1) \\cdot (N_{sim} - 1)}{N_{obs} - 1} + 1\\) \\(= 1, ..., N_{obs}\\). \\(\\hat{x}_i\\) calculated : $$ \\hat{x}_i = (1 - p_i) \\cdot x_{\\lfloor idx_i \\rfloor} + p_i \\cdot x_{\\lceil idx_i \\rceil} $$ \\(p_i = idx_i - \\lfloor idx_i \\rfloor\\). \\(\\lfloor idx_i \\rfloor = \\lceil idx_i \\rceil\\), \\(\\hat{x}_i = x_{\\lfloor idx_i \\rfloor}\\). bootstrapping (bootstraps > 1), process repeated bootstraps times random sampling, final distance average results.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/calculate_wasserstein.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Calculate a Wasserstein distance — calculate_wasserstein","text":"","code":"testthat::expect_equal(calculate_wasserstein(0:10, 10:0), 0)  # zero if no distance testthat::expect_equal(calculate_wasserstein(0:10, 0:10), 0) testthat::expect_equal(calculate_wasserstein(10:0, 0:10), 0)  # normalised so that all mass at mean = 1 testthat::expect_equal(calculate_wasserstein(rep(5, 11), 0:10), 1)  # smaller sample recycled and normalises to same value testthat::expect_equal(calculate_wasserstein(rep(5, 5), 0:10), 1)  # should be ((0+1+0+1+0+0+0+1+0+1+0) / 11) / ((5+4+3+2+1+0+1+2+3+4+5) / 11) = 0.1333... testthat::expect_equal(   calculate_wasserstein(     c(0, 0, 2, 2, 4, 5, 6, 8, 8, 10, 10),     0:10  ),   0.133333333333333 )  withr::with_seed(100, {    ref = rnorm(1000)    cmp1 = rnorm(1000)    cmp2 = rnorm(1000, sd=2)    cmp3 = rnorm(100) })  testthat::expect_equal(calculate_wasserstein(cmp1,ref), 0.0576417503974498) testthat::expect_equal(calculate_wasserstein(cmp2,ref), 1.04950621760385) testthat::expect_equal(calculate_wasserstein(cmp3,ref), 0.212977231452674)  calculate_wasserstein(cmp1,ref,bootstraps=10)  gen = function(n, mean=0, sd=1) {   sample(pnorm(seq(-1,1,length.out = n - n }  # there should be approximately zero calculate_wasserstein(gen(1000), gen(1000)) calculate_wasserstein(gen(1000), gen(100)) calculate_wasserstein(gen(100), gen(1000)) calculate_wasserstein(gen(200), gen(1000))  # these should be approximately equal: calculate_wasserstein(gen(100,0.1), gen(1000)) calculate_wasserstein(gen(200,0.1), gen(1000)) calculate_wasserstein(gen(1000,0.1), gen(1000)) calculate_wasserstein(gen(1000, 0.1), gen(200)) calculate_wasserstein(gen(1000, 0.1), gen(100))"},{"path":"https://ai4ci.github.io/tidyabc/reference/cash-.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract named item(s) from a dist_fns_list — $.dist_fns_list","title":"Extract named item(s) from a dist_fns_list — $.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/cash-.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract named item(s) from a dist_fns_list — $.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' x$y"},{"path":"https://ai4ci.github.io/tidyabc/reference/cash-.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract named item(s) from a dist_fns_list — $.dist_fns_list","text":"x dist_fns_list S3 object y item retrieve","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/cash-.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract named item(s) from a dist_fns_list — $.dist_fns_list","text":"list vector named items","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/cash-.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract named item(s) from a link_fns_list — $.link_fns_list","title":"Extract named item(s) from a link_fns_list — $.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/cash-.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract named item(s) from a link_fns_list — $.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' x$y"},{"path":"https://ai4ci.github.io/tidyabc/reference/cash-.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract named item(s) from a link_fns_list — $.link_fns_list","text":"x link_fns_list S3 object y item retrieve","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/cash-.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract named item(s) from a link_fns_list — $.link_fns_list","text":"list vector named items","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/common_internal.html","id":null,"dir":"Reference","previous_headings":"","what":"Common internal parameters — common_internal","title":"Common internal parameters — common_internal","text":"Common internal parameters","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/common_internal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Common internal parameters — common_internal","text":"sim_df output wave simulation including abc_summary_distance column priors_list list priors named list dist_fns, plus one sided formulae constraints 2 sided formulae derived values. correlation matrix may also present attribute cor. epsilon epsilon tolerance threshold controls closely simulated summaries must match observed ones considered plausible. unit abc_summary_distance. Initially 0.5 quantile distances, subsequent waves might decreased. scale parameter kernel function. $K_h(|u|)$ prev_sim_df output previous ABC wave including abc_weight column proposal_list list empirical probability distributions map MVN space proposal space, \"prior\" adaptive wave. already used generate proposals mapping sim_df","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dbeta2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Beta Distribution — dbeta2","title":"The Beta Distribution — dbeta2","text":"Density, distribution function, quantile function random   generation Beta distribution parameters shape1   shape2 (optional non-centrality parameter ncp).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dbeta2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Beta Distribution — dbeta2","text":"","code":"dbeta2(x, prob, kappa, log = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dbeta2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Beta Distribution — dbeta2","text":"x vector quantiles prob mean probability (vectorised) kappa coefficient variation. 0 variability 1 maximally variability (vectorised) log logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dbeta2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Beta Distribution — dbeta2","text":"dbeta gives density, pbeta distribution   function, qbeta quantile function, rbeta   generates random deviates. Invalid arguments result return value NaN, warning. length result determined n   rbeta, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/dbeta2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Beta Distribution — dbeta2","text":"","code":"dbeta2(c(0.25,0.5,0.75), 0.5, 0.25) #> [1] 0.008405383 5.441004532 0.008405383"},{"path":"https://ai4ci.github.io/tidyabc/reference/dcgamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Density: gamma distribution constrained to have mean > sd — dcgamma","title":"Density: gamma distribution constrained to have mean > sd — dcgamma","text":"Density, distribution function, quantile function random   generation Gamma distribution parameters shape   scale.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dcgamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density: gamma distribution constrained to have mean > sd — dcgamma","text":"","code":"dcgamma(x, mean, kappa = 1/mean, log = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dcgamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density: gamma distribution constrained to have mean > sd — dcgamma","text":"x vector quantiles mean mean value true scale (vectorised) kappa coefficient variation. 0 variability 1 maximally variability (vectorised) log logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dcgamma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Density: gamma distribution constrained to have mean > sd — dcgamma","text":"dgamma gives density,   pgamma gives distribution function,   qgamma gives quantile function,   rgamma generates random deviates. Invalid arguments result return value NaN, warning. length result determined n   rgamma, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/dcgamma.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Density: gamma distribution constrained to have mean > sd — dcgamma","text":"","code":"dcgamma(seq(0,4,0.25), 2, 0.5) #>  [1] 0.00000000 0.19470020 0.30326533 0.35427491 0.36787944 0.35813100 #>  [7] 0.33469524 0.30410440 0.27067057 0.23714826 0.20521250 0.17580162 #> [13] 0.14936121 0.12601618 0.10569084 0.08819155 0.07326256"},{"path":"https://ai4ci.github.io/tidyabc/reference/default_termination_fn.html","id":null,"dir":"Reference","previous_headings":"","what":"Set up default convergence criteria for SMC and adaptive ABC — default_termination_fn","title":"Set up default convergence criteria for SMC and adaptive ABC — default_termination_fn","text":"Convergence assessed firstly whether central estimate parameters assessed stable, changing one wave next, secondly 95 percent credible interval stable waves. parameter central estimate stationary credible intervals still dropping continuing simulation may get better estimates confidence.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/default_termination_fn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set up default convergence criteria for SMC and adaptive ABC — default_termination_fn","text":"","code":"default_termination_fn(stability = 0.01, confidence = 0.1)"},{"path":"https://ai4ci.github.io/tidyabc/reference/default_termination_fn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set up default convergence criteria for SMC and adaptive ABC — default_termination_fn","text":"stability close sequential estimates need declaring good set parameter estimates. units parameter. given single number applies parameters equally, alternatively named vector can used set parameter specific cutoffs. confidence stable 95% confidence intervals need happy parameter estimates. scale parameters, represents change IQR wave wave. given single number applies parameters equally, alternatively named vector can used set parameter specific cutoffs.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/default_termination_fn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set up default convergence criteria for SMC and adaptive ABC — default_termination_fn","text":"function specifies convergence.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/default_termination_fn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set up default convergence criteria for SMC and adaptive ABC — default_termination_fn","text":"","code":"# A more permissive definition of convergence has # less strict stability criteria (sequential estimates varying by less than 5%) # and confidence intervals not changing by more than 1 unit between waves.) check = default_termination_fn(0.05, 1.0)   fit = example_smc_fit() #> ABC-SMC #> SMC waves:  ■■■■■■■■■                         25% | wave 2 ETA:  4s #> SMC waves:  ■■■■■■■■■■■■■■■■■                 52% | wave 4 ETA:  2s #> Converged on wave: 8 #> SMC waves:  ■■■■■■■■■■■■■■■■■■■■■■■■■■■■      89% | wave 7 ETA:  1s  # This is performed as an integral part of the SMC and adaptive # fitting and is here only for example last_wave_metrics = utils::tail(fit$waves,1) converged = check(   last_wave_metrics$summary[[1]],   last_wave_metrics$per_param[[1]] )  if (isTRUE(converged)) print(\"Converged (permissive definition)\") #> [1] \"Converged (permissive definition)\""},{"path":"https://ai4ci.github.io/tidyabc/reference/dgamma2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Gamma Distribution — dgamma2","title":"The Gamma Distribution — dgamma2","text":"Density, distribution function, quantile function random   generation Gamma distribution parameters shape   scale.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dgamma2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Gamma Distribution — dgamma2","text":"","code":"dgamma2(x, mean, sd = sqrt(mean), log = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dgamma2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Gamma Distribution — dgamma2","text":"x vector quantiles mean mean value true scale (vectorised) sd standard deviation true scale (vectorised) log logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dgamma2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Gamma Distribution — dgamma2","text":"dgamma gives density,   pgamma gives distribution function,   qgamma gives quantile function,   rgamma generates random deviates. Invalid arguments result return value NaN, warning. length result determined n   rgamma, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/dgamma2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Gamma Distribution — dgamma2","text":"","code":"dgamma2(seq(0,4,0.25), 2, 1) #>  [1] 0.00000000 0.02527211 0.12262648 0.25102143 0.36089409 0.42752603 #>  [7] 0.44808362 0.43157094 0.39073363 0.33743577 0.28074779 0.22664553 #> [13] 0.17847016 0.13762733 0.10425850 0.07777749 0.05725229"},{"path":"https://ai4ci.github.io/tidyabc/reference/dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Create an empty dist_fns_list — dist_fns","title":"Create an empty dist_fns_list — dist_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create an empty dist_fns_list — dist_fns","text":"","code":"dist_fns()"},{"path":"https://ai4ci.github.io/tidyabc/reference/dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create an empty dist_fns_list — dist_fns","text":"empty dist_fns_list","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dlnorm2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Log Normal Distribution — dlnorm2","title":"The Log Normal Distribution — dlnorm2","text":"Density, distribution function, quantile function random   generation log normal distribution whose logarithm mean   equal meanlog standard deviation equal sdlog.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dlnorm2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Log Normal Distribution — dlnorm2","text":"","code":"dlnorm2(x, mean = 1, sd = sqrt(exp(1) - 1), log = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dlnorm2.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"The Log Normal Distribution — dlnorm2","text":"dlnorm calculated definition (‘Details’).   [pqr]lnorm based relationship normal. Consequently, model single point mass exp(meanlog)   boundary case sdlog = 0.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dlnorm2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Log Normal Distribution — dlnorm2","text":"x vector quantiles mean mean value true scale (vectorised) sd standard deviation true scale (vectorised) log logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dlnorm2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Log Normal Distribution — dlnorm2","text":"dlnorm gives density,   plnorm gives distribution function,   qlnorm gives quantile function,   rlnorm generates random deviates. length result determined n   rlnorm, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dlnorm2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Log Normal Distribution — dlnorm2","text":"log normal distribution density   $$     f(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma x} e^{-(\\log(x) - \\mu)^2/2 \\sigma^2}%   $$   \\(\\mu\\) \\(\\sigma\\) mean standard   deviation logarithm.   mean \\(E(X) = exp(\\mu + 1/2 \\sigma^2)\\),   median \\(med(X) = exp(\\mu)\\), variance   \\(Var(X) = exp(2\\mu + \\sigma^2)(exp(\\sigma^2) - 1)\\)   hence coefficient variation   \\(\\sqrt{exp(\\sigma^2) - 1}\\)   approximately \\(\\sigma\\) small (e.g., \\(\\sigma < 1/2\\)).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dlnorm2.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"The Log Normal Distribution — dlnorm2","text":"cumulative hazard \\(H(t) = - \\log(1 - F(t))\\)   -plnorm(t, r, lower = FALSE, log = TRUE).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dlnorm2.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The Log Normal Distribution — dlnorm2","text":"Becker, R. ., Chambers, J. M. Wilks, . R. (1988)   New S Language.   Wadsworth & Brooks/Cole. Johnson, N. L., Kotz, S. Balakrishnan, N. (1995)   Continuous Univariate Distributions, volume 1, chapter 14.   Wiley, New York.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/dlnorm2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Log Normal Distribution — dlnorm2","text":"","code":"dlnorm2(seq(0,4,0.25), 2, 1) #>  [1] 0.0000000000 0.0005757428 0.0442991085 0.2071346586 0.3958009702 #>  [6] 0.5066252419 0.5252248069 0.4820705272 0.4106521947 0.3336148024 #> [11] 0.2628174046 0.2029235657 0.1546511354 0.1168989116 0.0879351969 #> [16] 0.0659844844 0.0494751213"},{"path":"https://ai4ci.github.io/tidyabc/reference/dlogitnorm.html","id":null,"dir":"Reference","previous_headings":"","what":"Logit-normal distribution — dlogitnorm","title":"Logit-normal distribution — dlogitnorm","text":"logit-normal distribution support 0 1.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dlogitnorm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logit-normal distribution — dlogitnorm","text":"","code":"dlogitnorm(x, meanlogit = 0, sdlogit = 1, log = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dlogitnorm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logit-normal distribution — dlogitnorm","text":"x vector quantiles (0<x<1) meanlogit mean logit scale sdlogit sd logit scale log logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dlogitnorm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logit-normal distribution — dlogitnorm","text":"vector probabilities, quantiles, densities samples.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dlogitnorm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Logit-normal distribution — dlogitnorm","text":"","code":"dlogitnorm(seq(0.1,0.9,0.1), 0, 1) #> [1] 0.3965747 0.9538364 1.3267766 1.5310853 1.5957691 1.5310853 1.3267766 #> [8] 0.9538364 0.3965747"},{"path":"https://ai4ci.github.io/tidyabc/reference/dlogitnorm2.html","id":null,"dir":"Reference","previous_headings":"","what":"Logit-normal distribution — dlogitnorm2","title":"Logit-normal distribution — dlogitnorm2","text":"logit-normal distribution support 0 1.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dlogitnorm2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logit-normal distribution — dlogitnorm2","text":"","code":"dlogitnorm2(x, prob.0.5 = 0.5, kappa = 1 - exp(-1), log = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dlogitnorm2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logit-normal distribution — dlogitnorm2","text":"x vector quantiles (0<x<1) prob.0.5 median true scale kappa dispersion parameter 0 (none) 1 maximum dispersion log logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dlogitnorm2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logit-normal distribution — dlogitnorm2","text":"vector probabilities, quantiles, densities samples.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dlogitnorm2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Logit-normal distribution — dlogitnorm2","text":"","code":"q = seq(0.1,0.9,0.1) eps = sqrt(.Machine$double.eps) dlogitnorm2(q, 0.75, 0.2) #> [1] 8.444866e-47 1.318563e-26 2.611608e-16 1.014980e-09 3.898403e-05 #> [6] 5.982202e-02 4.515133e+00 4.867271e+00 1.082890e-04  (plogitnorm2(q+eps, 0.75, 0.2) -   plogitnorm2(q-eps, 0.75, 0.2)) / (2*eps) #> [1] 8.444866e-47 1.318563e-26 2.611608e-16 1.014980e-09 3.898403e-05 #> [6] 5.982202e-02 4.515133e+00 4.867271e+00 1.082905e-04"},{"path":"https://ai4ci.github.io/tidyabc/reference/dnbinom2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Negative Binomial Distribution — dnbinom2","title":"The Negative Binomial Distribution — dnbinom2","text":"Density, distribution function, quantile function random   generation negative binomial distribution parameters   size prob.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dnbinom2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Negative Binomial Distribution — dnbinom2","text":"","code":"dnbinom2(x, mean, sd = sqrt(mean), log = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dnbinom2.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"The Negative Binomial Distribution — dnbinom2","text":"dnbinom computes via binomial probabilities, using code   contributed Catherine Loader (see dbinom). pnbinom uses pbeta. qnbinom uses Cornish–Fisher Expansion include skewness   correction normal approximation, followed search. rnbinom uses derivation gamma mixture Poisson   distributions, see Devroye, L. (1986) Non-Uniform Random Variate Generation.   Springer-Verlag, New York. Page 480.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dnbinom2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Negative Binomial Distribution — dnbinom2","text":"x vector (non-negative integer) quantiles. mean mean value true scale (vectorised) sd standard deviation true scale (vectorised) log logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dnbinom2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Negative Binomial Distribution — dnbinom2","text":"dnbinom gives density,   pnbinom gives distribution function,   qnbinom gives quantile function,   rnbinom generates random deviates. Invalid size prob result return value   NaN, warning. length result determined n   rnbinom, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used. rnbinom returns vector type integer unless generated   values exceed maximum representable integer double   values returned.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dnbinom2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Negative Binomial Distribution — dnbinom2","text":"negative binomial distribution size \\(= n\\)   prob \\(= p\\) density   $$     p(x) = \\frac{\\Gamma(x+n)}{\\Gamma(n) x!} p^n (1-p)^x$$   \\(x = 0, 1, 2, \\ldots\\), \\(n > 0\\) \\(0 < p \\le 1\\). represents number failures occur sequence   Bernoulli trials target number successes reached.   mean \\(\\mu = n(1-p)/p\\) variance \\(n(1-p)/p^2\\). negative binomial distribution can also arise mixture   Poisson distributions mean distributed gamma distribution   (see pgamma) scale parameter (1 - prob)/prob   shape parameter size.  (definition allows non-integer   values size.) alternative parametrization (often used ecology)   mean mu (see ), size, dispersion   parameter, prob = size/(size+mu).  variance   mu + mu^2/size parametrization. element x integer, result dnbinom   zero, warning. case size == 0 distribution concentrated zero.   limiting distribution size approaching zero,   even mu rather prob held constant.  Notice   though, mean limit distribution 0, whatever   value mu. quantile defined smallest value \\(x\\)   \\(F(x) \\ge p\\), \\(F\\) distribution function.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/dnbinom2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Negative Binomial Distribution — dnbinom2","text":"","code":"dnbinom2(0:5, 2, sqrt(2)) #> [1] 0.13533528 0.27067057 0.27067057 0.18044704 0.09022352 0.03608941"},{"path":"https://ai4ci.github.io/tidyabc/reference/dnull.html","id":null,"dir":"Reference","previous_headings":"","what":"Null distributions always returns NA — dnull","title":"Null distributions always returns NA — dnull","text":"Null distributions always returns NA","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dnull.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Null distributions always returns NA — dnull","text":"","code":"dnull(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dnull.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Null distributions always returns NA — dnull","text":"x vector quantiles ... used","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dnull.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Null distributions always returns NA — dnull","text":"","code":"dnull(c(0.25,0.5,0.75), 0.5, 0.25) #> [1] NA NA NA"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.abc_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Support for auto suggests on an abc_priors — .AtNames.abc_prior","title":"Support for auto suggests on an abc_priors — .AtNames.abc_prior","text":"Support auto suggests abc_priors","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.abc_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Support for auto suggests on an abc_priors — .AtNames.abc_prior","text":"","code":"# S3 method for class 'abc_prior' .AtNames(x, pattern)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.abc_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Support for auto suggests on an abc_priors — .AtNames.abc_prior","text":"x abc_prior S3 object pattern regular expression","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.abc_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Support for auto suggests on an abc_priors — .AtNames.abc_prior","text":"names attributes","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Support for auto suggests on dist_fns_lists — .AtNames.dist_fns","title":"Support for auto suggests on dist_fns_lists — .AtNames.dist_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Support for auto suggests on dist_fns_lists — .AtNames.dist_fns","text":"","code":"# S3 method for class 'dist_fns' .AtNames(x, pattern)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Support for auto suggests on dist_fns_lists — .AtNames.dist_fns","text":"x dist_fns S3 object pattern regular expression","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Support for auto suggests on dist_fns_lists — .AtNames.dist_fns","text":"names attributes","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Support for auto suggests on dist_fns_lists — .AtNames.dist_fns_list","title":"Support for auto suggests on dist_fns_lists — .AtNames.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Support for auto suggests on dist_fns_lists — .AtNames.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' .AtNames(x, pattern)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Support for auto suggests on dist_fns_lists — .AtNames.dist_fns_list","text":"x dist_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Support for auto suggests on dist_fns_lists — .AtNames.dist_fns_list","text":"names attributes","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Support for auto suggests on link_fns_lists — .AtNames.link_fns","title":"Support for auto suggests on link_fns_lists — .AtNames.link_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Support for auto suggests on link_fns_lists — .AtNames.link_fns","text":"","code":"# S3 method for class 'link_fns' .AtNames(x, pattern)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Support for auto suggests on link_fns_lists — .AtNames.link_fns","text":"x link_fns S3 object pattern regular expression","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Support for auto suggests on link_fns_lists — .AtNames.link_fns","text":"names attributes","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Support for auto suggests on link_fns_lists — .AtNames.link_fns_list","title":"Support for auto suggests on link_fns_lists — .AtNames.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Support for auto suggests on link_fns_lists — .AtNames.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' .AtNames(x, pattern)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Support for auto suggests on link_fns_lists — .AtNames.link_fns_list","text":"x link_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-AtNames.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Support for auto suggests on link_fns_lists — .AtNames.link_fns_list","text":"names attributes","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-DollarNames.crate.html","id":null,"dir":"Reference","previous_headings":"","what":"Support for auto suggests on crates — .DollarNames.crate","title":"Support for auto suggests on crates — .DollarNames.crate","text":"Support auto suggests crates","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-DollarNames.crate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Support for auto suggests on crates — .DollarNames.crate","text":"","code":"# S3 method for class 'crate' .DollarNames(x, pattern)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-DollarNames.crate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Support for auto suggests on crates — .DollarNames.crate","text":"x crated function pattern regular expression","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-DollarNames.crate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Support for auto suggests on crates — .DollarNames.crate","text":"names crated data items","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-DollarNames.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Support for auto suggests on dist_fns_lists — .DollarNames.dist_fns_list","title":"Support for auto suggests on dist_fns_lists — .DollarNames.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-DollarNames.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Support for auto suggests on dist_fns_lists — .DollarNames.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' .DollarNames(x, pattern)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-DollarNames.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Support for auto suggests on dist_fns_lists — .DollarNames.dist_fns_list","text":"x dist_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-DollarNames.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Support for auto suggests on dist_fns_lists — .DollarNames.dist_fns_list","text":"names children","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-DollarNames.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Support for auto suggests on link_fns_lists — .DollarNames.link_fns_list","title":"Support for auto suggests on link_fns_lists — .DollarNames.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-DollarNames.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Support for auto suggests on link_fns_lists — .DollarNames.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' .DollarNames(x, pattern)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-DollarNames.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Support for auto suggests on link_fns_lists — .DollarNames.link_fns_list","text":"x link_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-DollarNames.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Support for auto suggests on link_fns_lists — .DollarNames.link_fns_list","text":"names children","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-autocrate.html","id":null,"dir":"Reference","previous_headings":"","what":"Crate a function definition that may not have all the namespaces qualified. — .autocrate","title":"Crate a function definition that may not have all the namespaces qualified. — .autocrate","text":"Regular crating requires everything namespaced easy forget, particularly stats:: dplyr::.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-autocrate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Crate a function definition that may not have all the namespaces qualified. — .autocrate","text":"","code":".autocrate(   .fn,   ...,   .parent_env = baseenv(),   .error_arg = \".fn\",   .error_call = environment() )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-autocrate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Crate a function definition that may not have all the namespaces qualified. — .autocrate","text":".fn fresh formula function. \"Fresh\" means declared call crate(). See examples need crate function already defined. Formulas converted purrr-like lambda functions using rlang::as_function(). ... Named arguments declare environment .fn. .parent_env default baseenv() ensures evaluation environment crate isolated search path. Specifying another environment global environment allows condition relaxed (expense longer able rely local run giving results one different process). .error_arg argument name string. argument mentioned error messages input origin problem. .error_call execution environment currently running function, e.g. caller_env(). function mentioned error messages source error. See call argument abort() information.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-autocrate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Crate a function definition that may not have all the namespaces qualified. — .autocrate","text":"crated function","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-autocrate.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Crate a function definition that may not have all the namespaces qualified. — .autocrate","text":"","code":"z = 13 tmp = .autocrate(function(x) {   y <- runif(x)   stats::rnorm(x,y)   x[1] <- 12   x[2] <- !!z # inlining happens during expression parsing...? })  # unqualified reference is qualified testthat::expect_equal(format(body(tmp)), c(   \"{\",   \"    y <- stats::runif(x)\",   \"    stats::rnorm(x, y)\",   \"    x[1] <- 12\",   \"    x[2] <- 13\",   \"}\" ))  tmpfn = function(x) {   \"temp\" } tmpvar = 10  testthat::expect_error(   {     .autocrate(function(y) {       if (tmpvar == 10) tmpfn(y)     })   },   \"References to undefined globals in function `.fn`: tmpvar,tmpfn\",   fixed = TRUE )  with_ref = .autocrate(   function(y) {     if (tmpvar == 10) tmpfn(y)   },   tmpvar = tmpvar,   tmpfn=tmpfn )  testthat::expect_equal(   ls(rlang::fn_env(with_ref)),   c(\"tmpfn\", \"tmpvar\") )  library(dplyr) # Global definitions in dplyr must be explicitly assigned like in . a = .autocrate(function(x) {   Species = NULL   x  })  testthat::expect_equal(a(iris), structure(   c(1L, 1L, 1L, 1L, 1L),   levels = c(\"setosa\", \"versicolor\", \"virginica\"),   class = \"factor\" ))  # Autocrating is recursive on functions supplied as globals: not_crated_fn = function(x) {rnorm(x); return(\"success\")}  crated_fn = .autocrate(function(x) {    generator(x) }, generator = not_crated_fn)  tmp = format(body(rlang::fn_env(crated_fn)$generator))  testthat::expect_equal(   tmp,   c(\"{\", \"    stats::rnorm(x)\", \"    return(\\\"success\\\")\", \"}\") )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-autocrate_fn.html","id":null,"dir":"Reference","previous_headings":"","what":"Crate an existing function that may not have all the namespaces qualified. — .autocrate_fn","title":"Crate an existing function that may not have all the namespaces qualified. — .autocrate_fn","text":"Regular crating requires everything namespaced easy forget, particularly stats:: dplyr::.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-autocrate_fn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Crate an existing function that may not have all the namespaces qualified. — .autocrate_fn","text":"","code":".autocrate_fn(   .fn,   ...,   .parent_env = baseenv(),   .error_arg = \".fn\",   .error_call = environment() )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-autocrate_fn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Crate an existing function that may not have all the namespaces qualified. — .autocrate_fn","text":".fn fresh formula function. \"Fresh\" means declared call crate(). See examples need crate function already defined. Formulas converted purrr-like lambda functions using rlang::as_function(). ... Named arguments declare environment .fn. .parent_env default baseenv() ensures evaluation environment crate isolated search path. Specifying another environment global environment allows condition relaxed (expense longer able rely local run giving results one different process). .error_arg argument name string. argument mentioned error messages input origin problem. .error_call execution environment currently running function, e.g. caller_env(). function mentioned error messages source error. See call argument abort() information.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-autocrate_fn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Crate an existing function that may not have all the namespaces qualified. — .autocrate_fn","text":"crated function","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-calculate_weights_adaptive.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate weights for particles in a new wave — .calculate_weights_adaptive","title":"Calculate weights for particles in a new wave — .calculate_weights_adaptive","text":"ABC weights need calculated sampling proposal distribution. depend priors, acceptance tolerance proposal probability distribution.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-calculate_weights_adaptive.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate weights for particles in a new wave — .calculate_weights_adaptive","text":"","code":".calculate_weights_adaptive(   sim_df,   priors_list,   epsilon,   proposal_list,   kernel )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-calculate_weights_adaptive.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate weights for particles in a new wave — .calculate_weights_adaptive","text":"sim_df output wave simulation including abc_summary_distance column priors_list list priors named list dist_fns, plus one sided formulae constraints 2 sided formulae derived values. correlation matrix may also present attribute cor. epsilon epsilon tolerance threshold controls closely simulated summaries must match observed ones considered plausible. unit abc_summary_distance. Initially 0.5 quantile distances, subsequent waves might decreased. scale parameter kernel function. $K_h(|u|)$ proposal_list list empirical probability distributions map MVN space proposal space, \"prior\" adaptive wave. already used generate proposals mapping sim_df kernel one \"epanechnikov\" (default), \"uniform\", \"triangular\", \"biweight\", \"gaussian\". kernel defines distance metric translates importance weight decides whether given simulation associated parameters rejected held next round. kernels except gaussian hard cut-outside probability acceptance particle zero. Use gaussian kernels can result poor convergence.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-calculate_weights_adaptive.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate weights for particles in a new wave — .calculate_weights_adaptive","text":"sim_df abc_weight column","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-calculate_weights_smc.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate weights for particles in a new wave — .calculate_weights_smc","title":"Calculate weights for particles in a new wave — .calculate_weights_smc","text":"ABC weights need calculated sampling proposal distribution. depend priors, acceptance tolerance weighted particles previous wave, define proposal probability distribution.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-calculate_weights_smc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate weights for particles in a new wave — .calculate_weights_smc","text":"","code":".calculate_weights_smc(sim_df, epsilon, prev_sim_df = NULL, kernel)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-calculate_weights_smc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate weights for particles in a new wave — .calculate_weights_smc","text":"sim_df output wave simulation including abc_summary_distance column epsilon epsilon tolerance threshold controls closely simulated summaries must match observed ones considered plausible. unit abc_summary_distance. Initially 0.5 quantile distances, subsequent waves might decreased. scale parameter kernel function. $K_h(|u|)$ prev_sim_df output previous ABC wave including abc_weight column kernel one \"epanechnikov\" (default), \"uniform\", \"triangular\", \"biweight\", \"gaussian\". kernel defines distance metric translates importance weight decides whether given simulation associated parameters rejected held next round. kernels except gaussian hard cut-outside probability acceptance particle zero. Use gaussian kernels can result poor convergence.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-calculate_weights_smc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate weights for particles in a new wave — .calculate_weights_smc","text":"sim_df abc_weight column","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-calculate_weights_wave_one.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate weights for particles in a new wave — .calculate_weights_wave_one","title":"Calculate weights for particles in a new wave — .calculate_weights_wave_one","text":"ABC weights need calculated sampling proposal distribution. situation sampling prior. just distance kernel function.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-calculate_weights_wave_one.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate weights for particles in a new wave — .calculate_weights_wave_one","text":"","code":".calculate_weights_wave_one(sim_df, epsilon, kernel)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-calculate_weights_wave_one.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate weights for particles in a new wave — .calculate_weights_wave_one","text":"sim_df output wave simulation including abc_summary_distance column epsilon epsilon tolerance threshold controls closely simulated summaries must match observed ones considered plausible. unit abc_summary_distance. Initially 0.5 quantile distances, subsequent waves might decreased. scale parameter kernel function. $K_h(|u|)$ kernel one \"epanechnikov\" (default), \"uniform\", \"triangular\", \"biweight\", \"gaussian\". kernel defines distance metric translates importance weight decides whether given simulation associated parameters rejected held next round. kernels except gaussian hard cut-outside probability acceptance particle zero. Use gaussian kernels can result poor convergence.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-calculate_weights_wave_one.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate weights for particles in a new wave — .calculate_weights_wave_one","text":"sim_df abc_weight column","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-compare_waves.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate comparison metrics for two sequential waves — .compare_waves","title":"Generate comparison metrics for two sequential waves — .compare_waves","text":"Generate comparison metrics two sequential waves","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-compare_waves.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate comparison metrics for two sequential waves — .compare_waves","text":"","code":".compare_waves(sim_df, prev_sim_df = NULL, priors_list)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-compare_waves.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate comparison metrics for two sequential waves — .compare_waves","text":"sim_df output wave simulation including abc_summary_distance column prev_sim_df output previous ABC wave including abc_weight column priors_list list priors named list dist_fns, plus one sided formulae constraints 2 sided formulae derived values. correlation matrix may also present attribute cor.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-compare_waves.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate comparison metrics for two sequential waves — .compare_waves","text":"nested tibble 2 columns summary per_parameter stats . summary stats ","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-crate_fn.html","id":null,"dir":"Reference","previous_headings":"","what":"Crate a pre-existing function with or without checks — .crate_fn","title":"Crate a pre-existing function with or without checks — .crate_fn","text":"Crate pre-existing function without checks","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-crate_fn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Crate a pre-existing function with or without checks — .crate_fn","text":"","code":".crate_fn(   .fn,   ...,   .parent_env = baseenv(),   .error_arg = \".fn\",   .error_call = environment(),   .nsqualify = FALSE )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-crate_fn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Crate a pre-existing function with or without checks — .crate_fn","text":".fn reference function ... Named arguments declare environment .fn. .parent_env default baseenv() ensures evaluation environment crate isolated search path. Specifying another environment global environment allows condition relaxed (expense longer able rely local run giving results one different process). .error_arg argument name string. argument mentioned error messages input origin problem. .error_call execution environment currently running function, e.g. caller_env(). function mentioned error messages source error. See call argument abort() information. .nsqualify check undefined global references qualify namespaces?","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-crate_fn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Crate a pre-existing function with or without checks — .crate_fn","text":"crated function","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-crate_fn.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Crate a pre-existing function with or without checks — .crate_fn","text":"","code":".crate_fn"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-distance_covariance.html","id":null,"dir":"Reference","previous_headings":"","what":"Covariance from component scores — .distance_covariance","title":"Covariance from component scores — .distance_covariance","text":"Supports calculation Mahalanobis distance.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-distance_covariance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Covariance from component scores — .distance_covariance","text":"","code":".distance_covariance(component_scores)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-distance_covariance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Covariance from component scores — .distance_covariance","text":"component_scores list lists scores, one per simulation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-distance_covariance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Covariance from component scores — .distance_covariance","text":"covariance matrix","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-fit_lm_1d.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a weighted 1D linear model and predict output — .fit_lm_1d","title":"Fit a weighted 1D linear model and predict output — .fit_lm_1d","text":"weights NA ignored.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-fit_lm_1d.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a weighted 1D linear model and predict output — .fit_lm_1d","text":"","code":".fit_lm_1d(y, x, ..., w = NULL, new_x = NULL)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-fit_lm_1d.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a weighted 1D linear model and predict output — .fit_lm_1d","text":"y y values. least 2. x x values. least 2. ... must empty w weights (optional) new_x (optional) values predict (vectorised).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-fit_lm_1d.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a weighted 1D linear model and predict output — .fit_lm_1d","text":"either vector intercept (c) gradient (m) vector predictions points new_x","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-fit_lm_1d.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Fit a weighted 1D linear model and predict output — .fit_lm_1d","text":"","code":"testthat::expect_equal(   .fit_lm_1d(c(1, 2, 3, 4), c(5, 6, 7, 8)),   c(c = -4, m = 1) )  testthat::expect_equal(    .fit_lm_1d(c(0, 1), c(0, 1)),    c(c = 0, m = 1) )  withr::with_seed(123,{   x = 1:100   y = 2*x+3+stats::runif(100,-0.1,0.1)   testthat::expect_equal(     .fit_lm_1d(y, x),     c(c = 3, m = 2),     tolerance = 0.01   ) })  # with prediction: testthat::expect_error(   {     .fit_lm_1d(c(6, 5, 7, 10), c(1, 2, 3, 4), c(0, 1))   },   structure(\"`...` must be empty.\", names = \"\"),   fixed = TRUE )  testthat::expect_equal(   .fit_lm_1d(c(0, 1), c(0, 1), new_x = -2:2),   c(-2, -1, 0, 1, 2) )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_breaks_log1p.html","id":null,"dir":"Reference","previous_headings":"","what":"A scales breaks generator for log1p scales — .gg_breaks_log1p","title":"A scales breaks generator for log1p scales — .gg_breaks_log1p","text":"scales breaks generator log1p scales","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_breaks_log1p.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A scales breaks generator for log1p scales — .gg_breaks_log1p","text":"","code":".gg_breaks_log1p(n = 5, base = 10)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_breaks_log1p.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A scales breaks generator for log1p scales — .gg_breaks_log1p","text":"n number breaks base base breaks","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_breaks_log1p.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A scales breaks generator for log1p scales — .gg_breaks_log1p","text":"function ggplot scale breaks","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_breaks_log1p.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"A scales breaks generator for log1p scales — .gg_breaks_log1p","text":"","code":"ggplot2::ggplot(ggplot2::diamonds, ggplot2::aes(x=price))+   ggplot2::geom_density()+   ggplot2::scale_x_continuous(trans=\"log1p\", breaks=.gg_breaks_log1p())"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_fonts_missing.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if any fonts listed are missing — .gg_fonts_missing","title":"Check if any fonts listed are missing — .gg_fonts_missing","text":"Check fonts listed missing","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_fonts_missing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if any fonts listed are missing — .gg_fonts_missing","text":"","code":".gg_fonts_missing(family)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_fonts_missing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if any fonts listed are missing — .gg_fonts_missing","text":"family font family","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_fonts_missing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if any fonts listed are missing — .gg_fonts_missing","text":"TRUE missing fonts detected","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_fonts_missing.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Check if any fonts listed are missing — .gg_fonts_missing","text":"","code":".gg_fonts_missing(\"Arial\") .gg_fonts_missing(c(\"Roboto\",\"Kings\",\"ASDASDAS\"))"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_hide_X_axis.html","id":null,"dir":"Reference","previous_headings":"","what":"Hide the x axis of a plot — .gg_hide_X_axis","title":"Hide the x axis of a plot — .gg_hide_X_axis","text":"Hide x axis plot","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_hide_X_axis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hide the x axis of a plot — .gg_hide_X_axis","text":"","code":".gg_hide_X_axis()"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_hide_X_axis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hide the x axis of a plot — .gg_hide_X_axis","text":"theme","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_hide_Y_axis.html","id":null,"dir":"Reference","previous_headings":"","what":"Hide the y axis of a plot — .gg_hide_Y_axis","title":"Hide the y axis of a plot — .gg_hide_Y_axis","text":"Hide y axis plot","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_hide_Y_axis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hide the y axis of a plot — .gg_hide_Y_axis","text":"","code":".gg_hide_Y_axis()"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_hide_Y_axis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hide the y axis of a plot — .gg_hide_Y_axis","text":"theme","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_hide_legend.html","id":null,"dir":"Reference","previous_headings":"","what":"Hide the legend of a plot — .gg_hide_legend","title":"Hide the legend of a plot — .gg_hide_legend","text":"Hide legend plot","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_hide_legend.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hide the legend of a plot — .gg_hide_legend","text":"","code":".gg_hide_legend()"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_hide_legend.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hide the legend of a plot — .gg_hide_legend","text":"theme","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_hist.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple one liner plots from vectors with defaults — .gg_hist","title":"Simple one liner plots from vectors with defaults — .gg_hist","text":"Simple one liner plots vectors defaults","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_hist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple one liner plots from vectors with defaults — .gg_hist","text":"","code":".gg_hist(x, binwidth = 1, ...)  .gg_dens(x, bw = NULL, ...)  .gg_bar(x, ...)  .gg_scatter(x, y, ...)  .gg_denshist(x, y, binwidth = 1)  .gg_linebar(x, y, binwidth = 1)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_hist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple one liner plots from vectors with defaults — .gg_hist","text":"x vector data counts binwidth histogram binwidth ... passed onto geoms bw bandwidth parameter,given interpreted fraction sd data y vector matrix data counts","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_hist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simple one liner plots from vectors with defaults — .gg_hist","text":"ggplot","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_hist.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Simple one liner plots from vectors with defaults — .gg_hist","text":".gg_hist(): Simple histogram .gg_dens(): density plot .gg_bar(): bar chart counts .gg_scatter(): X-Y scatter plot .gg_denshist(): Histogram densities overlaid. .gg_linebar(): Bar chart lines overlaid","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_label_size.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a label size from points to ggplot units — .gg_label_size","title":"Convert a label size from points to ggplot units — .gg_label_size","text":"Labels like geom_text random unit size mysteriously connected size text axes","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_label_size.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a label size from points to ggplot units — .gg_label_size","text":"","code":".gg_label_size(pts)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_label_size.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a label size from points to ggplot units — .gg_label_size","text":"pts label size points","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_label_size.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a label size from points to ggplot units — .gg_label_size","text":"ggplot size aesthetic labels","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_layer.html","id":null,"dir":"Reference","previous_headings":"","what":"Support for ggplot compositional functions — .gg_layer","title":"Support for ggplot compositional functions — .gg_layer","text":"often want make function data manipulation summarisation plotting summary, combines data multiple sources. often want reuse apply similar options several layers , without causing whole lot grief. function allows pass data, augment aesthetic mapping, pass styling set layers filtering relevant geom. almost never want inherit.aes true.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_layer.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Support for ggplot compositional functions — .gg_layer","text":"","code":".gg_layer(   geom,   data = NULL,   mapping,   ...,   .default = list(),   .switch_fill = inherits(geom, \"GeomRibbon\") )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_layer.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Support for ggplot compositional functions — .gg_layer","text":"geom ggplot2 layer e.g. ggplot2::GeomPoint data data going plot - optional inherited mapping mapping typically inherit higher level function call augmented (see example) ... inherit higher level function enable user customisation checked relevance geom passed .default list containing default aesthetics e.g. list(colour='blue') can overridden user supply ... mapping aesthetic overrides. .switch_fill want use colour aesthetic fill layer. commonly want ribbons.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_layer.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Support for ggplot compositional functions — .gg_layer","text":"ggplot layer.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_layer.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Support for ggplot compositional functions — .gg_layer","text":"","code":"# top level function contains `...` and `mapping` extensions points: myPlot = function(data, formula, ..., mapping = .gg_check_for_aes(...)) { xCol = rlang::as_quosure(rlang::f_lhs(formula), env = rlang::caller_env()) yCol = rlang::as_quosure(rlang::f_rhs(formula), env = rlang::caller_env()) ggplot2::ggplot(data) +   .gg_layer(     ggplot2::GeomPoint,     data = data,     mapping = ggplot2::aes(x = !!xCol, y = !!yCol, !!!mapping),     ...,     .default = list(size = 10)   ) } myPlot(iris, Sepal.Length~Sepal.Width, mapping=ggplot2::aes(colour=Species)) myPlot(iris, Sepal.Length~Petal.Length, mapping=ggplot2::aes(colour=Species), shape=\"+\", size=5) myPlot(mtcars, mpg~wt, mapping=ggplot2::aes(colour=as.factor(cyl), size=hp)) # check we made it this far without calling expect_no_errors testthat::expect_equal(1,1)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_merge_aes.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge aesthetic mappings and deduplicate the result — .gg_merge_aes","title":"Merge aesthetic mappings and deduplicate the result — .gg_merge_aes","text":"Merge aesthetic mappings deduplicate result","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_merge_aes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge aesthetic mappings and deduplicate the result — .gg_merge_aes","text":"","code":".gg_merge_aes(..., allow_override = TRUE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_merge_aes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge aesthetic mappings and deduplicate the result — .gg_merge_aes","text":"... set name=value, aes(...) specifications allow_override original mappings kept name=value pairs act default may overridden user supplied aesthetics","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_merge_aes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge aesthetic mappings and deduplicate the result — .gg_merge_aes","text":"single deduplicated set.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_merge_aes.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Merge aesthetic mappings and deduplicate the result — .gg_merge_aes","text":"","code":"m1 = ggplot2::aes(x=a,y=b,colour=class) .gg_merge_aes(x=A,y=BB,m1)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_narrow.html","id":null,"dir":"Reference","previous_headings":"","what":"Make a plot narrower — .gg_narrow","title":"Make a plot narrower — .gg_narrow","text":"Make plot narrower","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_narrow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make a plot narrower — .gg_narrow","text":"","code":".gg_narrow(ang = 90)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_narrow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make a plot narrower — .gg_narrow","text":"ang angle x labels","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_narrow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make a plot narrower — .gg_narrow","text":"theme","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_pedantic.html","id":null,"dir":"Reference","previous_headings":"","what":"An opinionated set of defaults for plots — .gg_pedantic","title":"An opinionated set of defaults for plots — .gg_pedantic","text":"set styles focus making plots compact, minimally fussy, ensuring fonts consistent axes labels. sets default sizes line widths point sizes. also switched default png renderer knitr ragg::ragg_png allow modern font support.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_pedantic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"An opinionated set of defaults for plots — .gg_pedantic","text":"","code":".gg_pedantic(   lineSize = 0.25,   fontSize = 8,   font = \"Roboto\",   size = lineSize * 2,   ... )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_pedantic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"An opinionated set of defaults for plots — .gg_pedantic","text":"lineSize default line shape size ggplot units fontSize base font size font default font name. size size points (default size aesthetic) ... Named arguments passed ggplot2::theme ... additional element specifications part base ggplot2. general, also defined element tree argument. Splicing list also supported. line line elements (element_line()) rect rectangular elements (element_rect()) text text elements (element_text()) title title elements: plot, axes, legends (element_text(); inherits text) point point elements (element_point()) polygon polygon elements (element_polygon()) geom defaults geoms (element_geom()) spacing spacings (unit()) margins margins (margin()) aspect.ratio aspect ratio panel axis.title,axis.title.x,axis.title.y,axis.title.x.top,axis.title.x.bottom,axis.title.y.left,axis.title.y.right labels axes (element_text()). Specify axes' labels (axis.title), labels plane (using axis.title.x axis.title.y), individually axis (using axis.title.x.bottom, axis.title.x.top, axis.title.y.left, axis.title.y.right). axis.title.*.* inherits axis.title.* inherits axis.title, turn inherits text axis.text,axis.text.x,axis.text.y,axis.text.x.top,axis.text.x.bottom,axis.text.y.left,axis.text.y.right,axis.text.theta,axis.text.r tick labels along axes (element_text()). Specify axis tick labels (axis.text), tick labels plane (using axis.text.x axis.text.y), individually axis (using axis.text.x.bottom, axis.text.x.top, axis.text.y.left, axis.text.y.right). axis.text.*.* inherits axis.text.* inherits axis.text, turn inherits text axis.ticks,axis.ticks.x,axis.ticks.x.top,axis.ticks.x.bottom,axis.ticks.y,axis.ticks.y.left,axis.ticks.y.right,axis.ticks.theta,axis.ticks.r tick marks along axes (element_line()). Specify tick marks (axis.ticks), ticks plane (using axis.ticks.x axis.ticks.y), individually axis (using axis.ticks.x.bottom, axis.ticks.x.top, axis.ticks.y.left, axis.ticks.y.right). axis.ticks.*.* inherits axis.ticks.* inherits axis.ticks, turn inherits line axis.minor.ticks.x.top,axis.minor.ticks.x.bottom,axis.minor.ticks.y.left,axis.minor.ticks.y.right,axis.minor.ticks.theta,axis.minor.ticks.r minor tick marks along axes (element_line()). axis.minor.ticks.*.* inherit corresponding major ticks axis.ticks.*.*. axis.ticks.length,axis.ticks.length.x,axis.ticks.length.x.top,axis.ticks.length.x.bottom,axis.ticks.length.y,axis.ticks.length.y.left,axis.ticks.length.y.right,axis.ticks.length.theta,axis.ticks.length.r length tick marks (unit). axis.ticks.length inherits spacing. axis.minor.ticks.length,axis.minor.ticks.length.x,axis.minor.ticks.length.x.top,axis.minor.ticks.length.x.bottom,axis.minor.ticks.length.y,axis.minor.ticks.length.y.left,axis.minor.ticks.length.y.right,axis.minor.ticks.length.theta,axis.minor.ticks.length.r length minor tick marks (unit), relative axis.ticks.length provided rel(). axis.line,axis.line.x,axis.line.x.top,axis.line.x.bottom,axis.line.y,axis.line.y.left,axis.line.y.right,axis.line.theta,axis.line.r lines along axes (element_line()). Specify lines along axes (axis.line), lines plane (using axis.line.x axis.line.y), individually axis (using axis.line.x.bottom, axis.line.x.top, axis.line.y.left, axis.line.y.right). axis.line.*.* inherits axis.line.* inherits axis.line, turn inherits line legend.background background legend (element_rect(); inherits rect) legend.margin margin around legend (margin()); inherits margins. legend.spacing,legend.spacing.x,legend.spacing.y spacing legends (unit). legend.spacing.x & legend.spacing.y inherit legend.spacing can specified separately. legend.spacing inherits spacing. legend.key background underneath legend keys (element_rect(); inherits rect) legend.key.size,legend.key.height,legend.key.width size legend keys (unit); key background height & width inherit legend.key.size can specified separately. turn legend.key.size inherits spacing. legend.key.spacing,legend.key.spacing.x,legend.key.spacing.y spacing legend keys given unit. Spacing horizontal (x) vertical (y) direction inherit legend.key.spacing can specified separately. legend.key.spacing inherits spacing. legend.key.justification Justification positioning legend keys space available needed display. default, NULL, stretches keys available space. Can location like \"center\" \"top\", two-element numeric vector. legend.frame frame drawn around bar (element_rect()). legend.ticks tick marks shown along bars axes (element_line()) legend.ticks.length length tick marks legend (unit()); inherits legend.key.size. legend.axis.line lines along axes legends (element_line()) legend.text legend item labels (element_text(); inherits text) legend.text.position placement legend text relative legend keys bars (\"top\", \"right\", \"bottom\" \"left\"). legend text placement might incompatible legend's direction guides. legend.title title legend (element_text(); inherits title) legend.title.position placement legend title relative main legend (\"top\", \"right\", \"bottom\" \"left\"). legend.position default position legends (\"none\", \"left\", \"right\", \"bottom\", \"top\", \"inside\") legend.position.inside numeric vector length two setting placement legends \"inside\" position. legend.direction layout items legends (\"horizontal\" \"vertical\") legend.byrow whether legend-matrix filled columns (FALSE, default) rows (TRUE). legend.justification anchor point positioning legend inside plot (\"center\" two-element numeric vector) justification according plot area positioned outside plot legend.justification.top,legend.justification.bottom,legend.justification.left,legend.justification.right,legend.justification.inside legend.justification specified per legend.position option. legend.location Relative placement legends outside plot string. Can \"panel\" (default) align legends panels \"plot\" align legends plot whole. legend.box arrangement multiple legends (\"horizontal\" \"vertical\") legend.box.just justification legend within overall bounding box, multiple legends (\"top\", \"bottom\", \"left\", \"right\", \"center\" \"centre\") legend.box.margin margins around full legend area, specified using margin(); inherits margins. legend.box.background background legend area (element_rect(); inherits rect) legend.box.spacing spacing plotting area legend box (unit); inherits spacing. panel.background background plotting area, drawn underneath plot (element_rect(); inherits rect) panel.border border around plotting area, drawn top plot covers tick marks grid lines. used fill = NA (element_rect(); inherits rect) panel.spacing,panel.spacing.x,panel.spacing.y spacing facet panels (unit). panel.spacing.x & panel.spacing.y inherit panel.spacing can specified separately. panel.spacing inherits spacing. panel.grid,panel.grid.major,panel.grid.minor,panel.grid.major.x,panel.grid.major.y,panel.grid.minor.x,panel.grid.minor.y grid lines (element_line()). Specify major grid lines, minor grid lines separately (using panel.grid.major panel.grid.minor) individually axis (using panel.grid.major.x, panel.grid.minor.x, panel.grid.major.y, panel.grid.minor.y).  Y axis grid lines horizontal x axis grid lines vertical. panel.grid.*.* inherits panel.grid.* inherits panel.grid, turn inherits line panel.ontop option place panel (background, gridlines) data layers (logical). Usually used transparent blank panel.background. panel.widths,panel.heights Sizes panels (units). Can single unit set total size panel area, unit vector set size individual panels. Using setting overrides aspect ratio set theme, coord facets. exception made plot single panel exactly one width height set, case attempt made preserve aspect ratio. plot.background background entire plot (element_rect(); inherits rect) plot.title plot title (text appearance) (element_text(); inherits title) left-aligned default plot.title.position,plot.caption.position Alignment plot title/subtitle caption.  setting plot.title.position applies title subtitle. value \"panel\" (default) means titles /caption aligned plot panels. value \"plot\" means titles /caption aligned entire plot (minus space margins plot tag). plot.subtitle plot subtitle (text appearance) (element_text(); inherits title) left-aligned default plot.caption caption plot (text appearance) (element_text(); inherits title) right-aligned default plot.tag upper-left label identify plot (text appearance) (element_text(); inherits title) left-aligned default plot.tag.position position tag string (\"topleft\", \"top\", \"topright\", \"left\", \"right\", \"bottomleft\", \"bottom\", \"bottomright\") coordinate. coordinate, can numeric vector length 2 set x,y-coordinate relative whole plot. coordinate option unavailable plot.tag.location = \"margin\". plot.tag.location placement tag string, one \"panel\", \"plot\" \"margin\". Respectively, place tag inside panel space, anywhere plot whole, margin around panel space. plot.margin margin around entire plot (unit sizes top, right, bottom, left margins); inherits margin. strip.background,strip.background.x,strip.background.y background facet labels (element_rect(); inherits rect). Horizontal facet background (strip.background.x) & vertical facet background (strip.background.y) inherit strip.background can specified separately strip.clip strip background edges strip labels clipped extend strip background? Options \"\" clip, \"\" disable clipping \"inherit\" (default) take clipping setting parent viewport. strip.placement placement strip respect axes, either \"inside\" \"outside\". important axes strips side plot. strip.text,strip.text.x,strip.text.y,strip.text.x.top,strip.text.x.bottom,strip.text.y.left,strip.text.y.right facet labels (element_text(); inherits  text). Horizontal facet labels (strip.text.x) & vertical facet labels (strip.text.y) inherit strip.text can specified separately. Facet strips dedicated position-dependent theme elements (strip.text.x.top, strip.text.x.bottom, strip.text.y.left, strip.text.y.right) inherit strip.text.x strip.text.y, respectively. consequence, theme stylings need applied position-dependent elements rather parent elements strip.switch.pad.grid,strip.switch.pad.wrap space strips axes strips switched (unit); inherits spacing. complete set TRUE complete theme, one returned theme_grey(). Complete themes behave differently added ggplot object. Also, setting complete = TRUE elements set inherit blank elements. validate TRUE run check_element(), FALSE bypass checks.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_pedantic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"An opinionated set of defaults for plots — .gg_pedantic","text":"nothing","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_resize_legend.html","id":null,"dir":"Reference","previous_headings":"","what":"Make the legend smaller — .gg_resize_legend","title":"Make the legend smaller — .gg_resize_legend","text":"Make legend smaller","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_resize_legend.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make the legend smaller — .gg_resize_legend","text":"","code":".gg_resize_legend(pointSize = 0.75, textSize = 6, spaceLegend = 0.75)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_resize_legend.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make the legend smaller — .gg_resize_legend","text":"pointSize ggplot size lines points textSize size pts text spaceLegend degree spacing items scale (defines overall size)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_resize_legend.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make the legend smaller — .gg_resize_legend","text":"theme","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_consistent.html","id":null,"dir":"Reference","previous_headings":"","what":"Use a colour scale from one plot in another — .gg_scale_consistent","title":"Use a colour scale from one plot in another — .gg_scale_consistent","text":"Multiple factor levels custom labels difficult sync graphs levels missing second plot. copies palette one plot another. sometimes case want reuse fill one plot color another.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_consistent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use a colour scale from one plot in another — .gg_scale_consistent","text":"","code":".gg_scale_consistent(   plot,   original_aesthetic = c(\"fill\", \"color\"),   target_aesthetic = original_aesthetic,   ... )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_consistent.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use a colour scale from one plot in another — .gg_scale_consistent","text":"plot ggplot colour scale clone original_aesthetic original aesthetic cloning (fill color) target_aesthetic aesthetic new plot want match. ... Named arguments passed ggplot2::scale_fill_manual ... Arguments passed discrete_scale limits One : NULL use default scale values character vector defines possible values scale order function accepts existing (automatic) values returns new ones. Also accepts rlang lambda function notation. drop unused factor levels omitted scale? default, TRUE, uses levels appear data; FALSE includes levels factor. Please note display every level legend, layer use show.legend = TRUE. na.translate Unlike continuous scales, discrete scales can easily show missing values, default. want remove missing values discrete scale, specify na.translate = FALSE. name name scale. Used axis legend title. waiver(), default, name scale taken first mapping used aesthetic. NULL, legend title omitted. minor_breaks One : NULL minor breaks waiver() default breaks (none discrete, one minor break major break continuous) numeric vector positions function given limits returns vector minor breaks. Also accepts rlang lambda function notation. function two arguments, given limits major break positions. labels One options . Please note labels vector, highly recommended also set breaks argument vector protect unintended mismatches. NULL labels waiver() default labels computed transformation object character vector giving labels (must length breaks) expression vector (must length breaks). See ?plotmath details. function takes breaks input returns labels output. Also accepts rlang lambda function notation. guide function used create guide name. See guides() information. call call used construct scale reporting messages. super super class use constructed scale breaks One : NULL breaks waiver() default breaks (scale limits) character vector breaks function takes limits input returns breaks output na.value aesthetic value use missing (NA) values","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_x_log1p.html","id":null,"dir":"Reference","previous_headings":"","what":"A log1p x scale — .gg_scale_x_log1p","title":"A log1p x scale — .gg_scale_x_log1p","text":"log1p x scale","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_x_log1p.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A log1p x scale — .gg_scale_x_log1p","text":"","code":".gg_scale_x_log1p(..., n = 5, base = 10, sf = 2)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_x_log1p.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A log1p x scale — .gg_scale_x_log1p","text":"... arguments passed scale_(x|y)_continuous() n number major breaks base base logarithm sf significant figures","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_x_log1p.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A log1p x scale — .gg_scale_x_log1p","text":"ggplot scale","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_x_logit.html","id":null,"dir":"Reference","previous_headings":"","what":"A logit x scale — .gg_scale_x_logit","title":"A logit x scale — .gg_scale_x_logit","text":"logit x scale","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_x_logit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A logit x scale — .gg_scale_x_logit","text":"","code":".gg_scale_x_logit(..., n = 5, sf = 2)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_x_logit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A logit x scale — .gg_scale_x_logit","text":"... arguments passed scale_(x|y)_continuous() n number major breaks sf significant figures","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_x_logit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A logit x scale — .gg_scale_x_logit","text":"ggplot scale","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_x_percent.html","id":null,"dir":"Reference","previous_headings":"","what":"A percentage x scale — .gg_scale_x_percent","title":"A percentage x scale — .gg_scale_x_percent","text":"percentage x scale","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_x_percent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A percentage x scale — .gg_scale_x_percent","text":"","code":".gg_scale_x_percent(..., sf = 2)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_x_percent.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A percentage x scale — .gg_scale_x_percent","text":"... arguments passed scale_(x|y)_continuous() sf significant figures","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_x_percent.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A percentage x scale — .gg_scale_x_percent","text":"ggplot scale","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_y_log1p.html","id":null,"dir":"Reference","previous_headings":"","what":"A log1p y scale — .gg_scale_y_log1p","title":"A log1p y scale — .gg_scale_y_log1p","text":"log1p y scale","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_y_log1p.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A log1p y scale — .gg_scale_y_log1p","text":"","code":".gg_scale_y_log1p(..., n = 5, base = 10, sf = 2)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_y_log1p.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A log1p y scale — .gg_scale_y_log1p","text":"... arguments passed scale_(x|y)_continuous() n number major breaks base base logarithm sf significant figures","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_y_log1p.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A log1p y scale — .gg_scale_y_log1p","text":"ggplot scale","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_y_logit.html","id":null,"dir":"Reference","previous_headings":"","what":"A logit y scale — .gg_scale_y_logit","title":"A logit y scale — .gg_scale_y_logit","text":"logit y scale","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_y_logit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A logit y scale — .gg_scale_y_logit","text":"","code":".gg_scale_y_logit(..., n = 5, sf = 2)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_y_logit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A logit y scale — .gg_scale_y_logit","text":"... arguments passed scale_(x|y)_continuous() n number major breaks sf significant figures","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_y_logit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A logit y scale — .gg_scale_y_logit","text":"ggplot scale","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_y_logit.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"A logit y scale — .gg_scale_y_logit","text":"","code":"dplyr::tibble(pvalue = c(0.001, 0.05, 0.1), fold_change = 1:3)   ggplot2::ggplot(ggplot2::aes(fold_change , pvalue)) +  ggplot2::geom_point() +  .gg_scale_y_logit(n=8)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_y_percent.html","id":null,"dir":"Reference","previous_headings":"","what":"A percentage y scale — .gg_scale_y_percent","title":"A percentage y scale — .gg_scale_y_percent","text":"percentage y scale","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_y_percent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A percentage y scale — .gg_scale_y_percent","text":"","code":".gg_scale_y_percent(..., sf = 2)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_y_percent.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A percentage y scale — .gg_scale_y_percent","text":"... arguments passed scale_(x|y)_continuous() sf significant figures","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_y_percent.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A percentage y scale — .gg_scale_y_percent","text":"ggplot scale","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_scale_y_percent.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"A percentage y scale — .gg_scale_y_percent","text":"","code":"dplyr::tibble(pvalue = c(0.001, 0.05, 0.1), fold_change = 1:3)   ggplot2::ggplot(ggplot2::aes(fold_change , pvalue)) +  ggplot2::geom_point() +  .gg_scale_y_percent()"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_set_X_angle.html","id":null,"dir":"Reference","previous_headings":"","what":"Set the angle of the x axis labels of a plot — .gg_set_X_angle","title":"Set the angle of the x axis labels of a plot — .gg_set_X_angle","text":"Also sets horizontal vertical alignment correctly, top bottom axes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_set_X_angle.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set the angle of the x axis labels of a plot — .gg_set_X_angle","text":"","code":".gg_set_X_angle(ang = 60)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_set_X_angle.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set the angle of the x axis labels of a plot — .gg_set_X_angle","text":"ang angle x labels","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_set_X_angle.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set the angle of the x axis labels of a plot — .gg_set_X_angle","text":"theme","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_set_size_defaults.html","id":null,"dir":"Reference","previous_headings":"","what":"Set sizes in ggplot uniformly — .gg_set_size_defaults","title":"Set sizes in ggplot uniformly — .gg_set_size_defaults","text":"Set default sizes lines, points fonts ggplot geoms, text labels ggplot axes get single consistent look feel.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_set_size_defaults.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set sizes in ggplot uniformly — .gg_set_size_defaults","text":"","code":".gg_set_size_defaults(   lineSize = 0.5,   fontSizePts = 4 + lineSize * 8,   font = \"Roboto\",   size = lineSize * 2 )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_set_size_defaults.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set sizes in ggplot uniformly — .gg_set_size_defaults","text":"lineSize width lines fontSizePts size labels plot text pts. font font family name size size points (default size aesthetic)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_set_size_defaults.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set sizes in ggplot uniformly — .gg_set_size_defaults","text":"nothing","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_set_size_defaults.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Set sizes in ggplot uniformly — .gg_set_size_defaults","text":"","code":".gg_set_size_defaults(lineSize = 0.25)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_substitute_fonts.html","id":null,"dir":"Reference","previous_headings":"","what":"Pick a locally installed font family that matches requested — .gg_substitute_fonts","title":"Pick a locally installed font family that matches requested — .gg_substitute_fonts","text":"Pick locally installed font family matches requested","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_substitute_fonts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pick a locally installed font family that matches requested — .gg_substitute_fonts","text":"","code":".gg_substitute_fonts(family)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_substitute_fonts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pick a locally installed font family that matches requested — .gg_substitute_fonts","text":"family font family requested","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_substitute_fonts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pick a locally installed font family that matches requested — .gg_substitute_fonts","text":"mapping named list font families present system (names requested font family)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_substitute_fonts.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Pick a locally installed font family that matches requested — .gg_substitute_fonts","text":"","code":".gg_substitute_fonts(c(\"Roboto\",\"Arial\",\"Kings\",\"Unmatched\"))"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_tiny_theme.html","id":null,"dir":"Reference","previous_headings":"","what":"A space saving ggplot theme — .gg_tiny_theme","title":"A space saving ggplot theme — .gg_tiny_theme","text":"ggplot theme minimal fluff defaults set small.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_tiny_theme.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A space saving ggplot theme — .gg_tiny_theme","text":"","code":".gg_tiny_theme(baseSize = 8, font = \"Roboto\")"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_tiny_theme.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A space saving ggplot theme — .gg_tiny_theme","text":"baseSize size base font. font font family name","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_tiny_theme.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A space saving ggplot theme — .gg_tiny_theme","text":"ggplot theme","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_tiny_theme.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"A space saving ggplot theme — .gg_tiny_theme","text":"","code":"ggplot2::ggplot(ggplot2::diamonds,   ggplot2::aes(x=carat,y=price,color=color))+   ggplot2::geom_point()+   .gg_tiny_theme()"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_transform_logit.html","id":null,"dir":"Reference","previous_headings":"","what":"logit scale — .gg_transform_logit","title":"logit scale — .gg_transform_logit","text":"Perform logit scaling right axis formatting. used directly ggplot (e.g. ggplot2::scale_y_continuous(trans = \"logit\")","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_transform_logit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"logit scale — .gg_transform_logit","text":"","code":".gg_transform_logit(n = 5, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_transform_logit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"logit scale — .gg_transform_logit","text":"n number breas ... used","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_transform_logit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"logit scale — .gg_transform_logit","text":"scales object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-gg_transform_logit.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"logit scale — .gg_transform_logit","text":"","code":"dplyr::tibble(pvalue = c(0.001, 0.05, 0.1), fold_change = 1:3)   ggplot2::ggplot(ggplot2::aes(fold_change , pvalue)) +  ggplot2::geom_point() +  ggplot2::scale_y_continuous(transform= .gg_transform_logit())"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-interpolate.html","id":null,"dir":"Reference","previous_headings":"","what":"Interpolate from 2 coordinates and predict output — .interpolate","title":"Interpolate from 2 coordinates and predict output — .interpolate","text":"Interpolate 2 coordinates predict output","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-interpolate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interpolate from 2 coordinates and predict output — .interpolate","text":"","code":".interpolate(y, x, new_x = NULL)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-interpolate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interpolate from 2 coordinates and predict output — .interpolate","text":"y y values. length 2. x x values. length 2. new_x values predict (vectorised). null return function can predict new values.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-interpolate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interpolate from 2 coordinates and predict output — .interpolate","text":"interpolated value prediction function","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-interpolate.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Interpolate from 2 coordinates and predict output — .interpolate","text":"","code":".interpolate(c(0,1),c(0,1),5)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-log_kernel.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a log of a kernel function for ABC weight calculation — .log_kernel","title":"Generate a log of a kernel function for ABC weight calculation — .log_kernel","text":"$$ \\text{Uniform: } K(d, \\epsilon) = \\frac{1}{2\\epsilon} \\mathbb{}(d \\leq \\epsilon) $$ $$ \\text{Triangular: } K(d, \\epsilon) = \\frac{2}{\\epsilon}\\left(1 - \\frac{d}{\\epsilon}\\right) \\mathbb{}(d \\leq \\epsilon) $$ $$ \\text{Epanechnikov: } K(d, \\epsilon) = \\frac{3}{4\\epsilon}\\left(1 - \\frac{d^2}{\\epsilon^2}\\right) \\mathbb{}(d \\leq \\epsilon) $$ $$ \\text{Biweight: } K(d, \\epsilon) = \\frac{15}{16\\epsilon}\\left(1 - \\frac{d^2}{\\epsilon^2}\\right)^2 \\mathbb{}(d \\leq \\epsilon) $$ $$ \\text{Gaussian: } K(d, h) = \\frac{1}{\\sqrt{2\\pi h^2}} \\exp\\left(-\\frac{d^2}{2h^2}\\right) $$ \\(d\\) distance observed simulated summary statistics, \\(\\epsilon\\) tolerance level, \\(h\\) bandwidth parameter Gaussian kernel, \\(\\mathbb{}\\) indicator function taking value 1 \\(d \\leq \\epsilon\\) 0 otherwise (applies kernels except Gaussian).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-log_kernel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a log of a kernel function for ABC weight calculation — .log_kernel","text":"","code":".log_kernel(   u,   epsilon,   kernel = c(c(\"epanechnikov\", \"uniform\", \"triangular\", \"biweight\", \"gaussian\")) )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-log_kernel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a log of a kernel function for ABC weight calculation — .log_kernel","text":"u distance (dissimilarilty) epsilon epsilon tolerance threshold controls closely simulated summaries must match observed ones considered plausible. unit abc_summary_distance. Initially 0.5 quantile distances, subsequent waves might decreased. scale parameter kernel function. $K_h(|u|)$ kernel one \"epanechnikov\", \"uniform\", \"triangular\", \"biweight\", \"gaussian\"","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-log_kernel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a log of a kernel function for ABC weight calculation — .log_kernel","text":"log kernel function","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-log_q_proposal_vectorized.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the probability of new proposals based on previous — .log_q_proposal_vectorized","title":"Calculate the probability of new proposals based on previous — .log_q_proposal_vectorized","text":"Calculate probability new proposals based previous","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-log_q_proposal_vectorized.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the probability of new proposals based on previous — .log_q_proposal_vectorized","text":"","code":".log_q_proposal_vectorized(theta_new, theta_prev, w_prev, Sigma_pert)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-log_q_proposal_vectorized.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the probability of new proposals based on previous — .log_q_proposal_vectorized","text":"theta_new set new particles matrix theta_prev set previous particles matrix w_prev weights previous particles assumed calculated using kernel Sigma_pert covariance kernel.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-log_q_proposal_vectorized.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the probability of new proposals based on previous — .log_q_proposal_vectorized","text":"vector probabilities row theta_new","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-log_q_proposal_vectorized.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Calculate the probability of new proposals based on previous — .log_q_proposal_vectorized","text":"","code":"# Previous particles: 100 samples from N(0, 1) N_prev <- 100 theta_prev <- matrix(rnorm(N_prev, 0, 1), ncol = 1) w_prev <- rep(1/N_prev, N_prev)  # uniform weights Sigma_pert <- matrix(0.5^2, nrow = 1, ncol = 1)  # scalar variance  # New point theta_new <- matrix(c(0.5), ncol = 1)  # Compute via vectorized function q_val_fast <- .log_q_proposal_vectorized(theta_new, theta_prev, w_prev, Sigma_pert)  # Compute via slow loop (ground truth) q_val_slow <- 0 for (j in 1:N_prev) {   q_val_slow <- q_val_slow + w_prev[j] * dnorm(theta_new, mean = theta_prev[j], sd = sqrt(Sigma_pert)) } expect_equal(exp(q_val_fast), as.vector(q_val_slow))"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-logit_z_interpolation.html","id":null,"dir":"Reference","previous_headings":"","what":"Weighted distribution function interpolation in a logit z space — .logit_z_interpolation","title":"Weighted distribution function interpolation in a logit z space — .logit_z_interpolation","text":"Weighted cumulative probabilities mapped logit space, data transformed Z space (assumes support -Inf..Inf). use link function resulting interpolation functions vectorised. Importance weighting done CDF construction. Prediction done using weighted linear interpolation nearby points. Weighting interpolation distance based gaussian kernel data points interpolation point. OOB interpolation supported.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-logit_z_interpolation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weighted distribution function interpolation in a logit z space — .logit_z_interpolation","text":"","code":".logit_z_interpolation(x, w = NULL, bw = NULL)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-logit_z_interpolation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Weighted distribution function interpolation in a logit z space — .logit_z_interpolation","text":"x either vector samples distribution X cut-offs cumulative probabilities combined p w data fits, vector length x giving importance weight observation. need normalised. must non zero weights, must finite. bw bandwidth expressed terms probability width, proportion observations.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-logit_z_interpolation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Weighted distribution function interpolation in a logit z space — .logit_z_interpolation","text":"function predict quantile assuming infinite support","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-logit_z_locfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Weighted distribution function interpolation in a logit z space — .logit_z_locfit","title":"Weighted distribution function interpolation in a logit z space — .logit_z_locfit","text":"Weighted cumulative probabilities mapped logit space, data transformed Z space (assumes support -Inf..Inf). use link function resulting interpolation functions vectorised. Importance weighting done CDF construction. Prediction done using weighted linear interpolation nearby points. Weighting interpolation distance based gaussian kernel data points interpolation point. OOB interpolation supported.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-logit_z_locfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weighted distribution function interpolation in a logit z space — .logit_z_locfit","text":"","code":".logit_z_locfit(x, w = NULL, bw = NULL)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-logit_z_locfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Weighted distribution function interpolation in a logit z space — .logit_z_locfit","text":"x either vector samples distribution X cut-offs cumulative probabilities combined p w data fits, vector length x giving importance weight observation. need normalised. must non zero weights, must finite. bw bandwidth expressed terms probability width, proportion observations.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-logit_z_locfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Weighted distribution function interpolation in a logit z space — .logit_z_locfit","text":"function predict quantile assuming infinite support","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-make_square.html","id":null,"dir":"Reference","previous_headings":"","what":"Strictly recycle the items in a list to the same length — .make_square","title":"Strictly recycle the items in a list to the same length — .make_square","text":"removes NULL entries, zero length lists","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-make_square.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Strictly recycle the items in a list to the same length — .make_square","text":"","code":".make_square(lst)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-make_square.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Strictly recycle the items in a list to the same length — .make_square","text":"lst list input","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-make_square.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Strictly recycle the items in a list to the same length — .make_square","text":"list items recycled length","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-make_square.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Strictly recycle the items in a list to the same length — .make_square","text":"","code":"lst = list(a = 1,b=1:3, c= NULL, d=list(), e=character()) testthat::expect_equal(   .make_square(lst),   list(a = c(1, 1, 1), b = 1:3) )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-monotonicpolyspline.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a polySpline object from a stats::splinefun call. — .monotonicpolyspline","title":"Create a polySpline object from a stats::splinefun call. — .monotonicpolyspline","text":"Create polySpline object stats::splinefun call.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-monotonicpolyspline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a polySpline object from a stats::splinefun call. — .monotonicpolyspline","text":"","code":".monotonicpolyspline(x, y)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-monotonicpolyspline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a polySpline object from a stats::splinefun call. — .monotonicpolyspline","text":"x, y vectors giving coordinates points     interpolated.  Alternatively single plotting structure can     specified: see xy.coords. y must increasing decreasing method = \"hyman\".","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-monotonicpolyspline.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a polySpline object from a stats::splinefun call. — .monotonicpolyspline","text":"object class polySpline.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-monotonicpolyspline.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a polySpline object from a stats::splinefun call. — .monotonicpolyspline","text":"function converts output stats::splinefun, polynomial spline object splines package.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-monotonicpolyspline.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Create a polySpline object from a stats::splinefun call. — .monotonicpolyspline","text":"","code":"# strictly increasing spl = .monotonicpolyspline(1:10, log(1:10)) testthat::expect_equal(   predict(spl,4.5)$y,   log(4.5),   tolerance = 0.01 )  # strictly decreasing spl2 = .monotonicpolyspline(1:10, -log(1:10)) testthat::expect_equal(   predict(spl2,4.5)$y,   -log(4.5),   tolerance = 0.01 )  # not monotonic testthat::expect_error(   {     .monotonicpolyspline(-4:4, (-4:4)^2)   },   \"Data is not monotonic.\",   fixed = TRUE )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-p_from_n.html","id":null,"dir":"Reference","previous_headings":"","what":"Proportions from a vector of lengths — .p_from_n","title":"Proportions from a vector of lengths — .p_from_n","text":"Typically useful finding alpha values plotting, bandwidths smoothing data decreasing sigmoid tunable parameters.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-p_from_n.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Proportions from a vector of lengths — .p_from_n","text":"","code":".p_from_n(n, n_50, n_01, p_max = 1, n_100 = 0)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-p_from_n.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Proportions from a vector of lengths — .p_from_n","text":"n vector lengths n_50 size 50 percent n_01 size 1 percent, limit returned p value \\(p \\times n \\ge n_{01}\\) p_max maximum value n <= n_100 n_100 offset value 1 (default 0)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-p_from_n.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Proportions from a vector of lengths — .p_from_n","text":"vector proportions length","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-p_from_n.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Proportions from a vector of lengths — .p_from_n","text":"using composite Hill function reciprocal: $$ f(n) = \\frac{1}{1 + \\left( \\dfrac{n - n_{100}}{n_{50}} \\right)^b} \\times p_{max}\\\\ b = \\frac{\\ln(99)}{\\ln(n_{01}/n_{50})} $$ \\(n-n_{100} \\le 0\\) maximum value returned","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-p_from_n.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Proportions from a vector of lengths — .p_from_n","text":"","code":"testthat::expect_equal(.p_from_n(c(0, 5, 100), 5, 100), c(1, 0.5, 0.01))  testthat::expect_error(   {     .p_from_n(0, 50, 1)   },   \"inconsistent parameters, n_01 must be larger than n_50.\",   fixed = TRUE )  testthat::expect_equal(.p_from_n(c(0:10), 5, 10, 0.1), c(   0.1,   0.0999976758268449,   0.0997704297474442,   0.0967278219151741,   0.081446655140766,   0.05,   0.0229935645768342,   0.0097036542590398,   0.00424593238101868,   0.00199056073397113,   0.001 ))  # does not go below testthat::expect_equal(   .p_from_n(c(1000, 10000, 100000), 5, 50),   c(5e-04, 5e-05, 5e-06) )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-p_from_n2.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple sigmoid tending towards a minimum proportion of input — .p_from_n2","title":"Simple sigmoid tending towards a minimum proportion of input — .p_from_n2","text":"Simple sigmoid tending towards minimum proportion input","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-p_from_n2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple sigmoid tending towards a minimum proportion of input — .p_from_n2","text":"","code":".p_from_n2(n, n_inf, p_max = 1, n_100 = 0)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-p_from_n2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple sigmoid tending towards a minimum proportion of input — .p_from_n2","text":"n vector lengths p_max maximum value n <= n_100 n_100 offset value 1 (default 0)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-p_from_n2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simple sigmoid tending towards a minimum proportion of input — .p_from_n2","text":"vector proportions length","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-p_from_n2.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Simple sigmoid tending towards a minimum proportion of input — .p_from_n2","text":"","code":"testthat::expect_equal(.p_from_n2(0:5, 1), c(   1,   0.707106781186547,   0.447213595499958,   0.316227766016838,   0.242535625036333,   0.196116135138184 ))"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-posterior_covariance.html","id":null,"dir":"Reference","previous_headings":"","what":"Covariance matrix from the posteriors — .posterior_covariance","title":"Covariance matrix from the posteriors — .posterior_covariance","text":"Covariance matrix posteriors","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-posterior_covariance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Covariance matrix from the posteriors — .posterior_covariance","text":"","code":".posterior_covariance(theta, weights, kernel_t = 1)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-posterior_covariance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Covariance matrix from the posteriors — .posterior_covariance","text":"theta set particles matrix weights weights previous particles assumed calculated using kernel kernel_t kernel bandwidth parameter proposals. controls amount noise particles perturbed (hence spread PDF proposal distribution), 1 approximately 34% proposal distribution centre. Smaller values (default 0.2) give smaller step size generating new proposals, proposals closer currently accepted particles.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-posterior_covariance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Covariance matrix from the posteriors — .posterior_covariance","text":"covariance matrix, optionally scaled","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-qualify_expression.html","id":null,"dir":"Reference","previous_headings":"","what":"Qualify the namespaces of everything in an expression — .qualify_expression","title":"Qualify the namespaces of everything in an expression — .qualify_expression","text":"recursively search name evaluates function part qualified reference replaces qualified version. function resolved current environment dplyr::filter picked stats::filter tidyverse loaded point evaluation.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-qualify_expression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Qualify the namespaces of everything in an expression — .qualify_expression","text":"","code":".qualify_expression(expr, defined = list(), unqual = list())"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-qualify_expression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Qualify the namespaces of everything in an expression — .qualify_expression","text":"expr expression component expressions. defined list qualified references known point unqual list unqualified references","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-qualify_expression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Qualify the namespaces of everything in an expression — .qualify_expression","text":"list qualified expression, plus updated defined unqualified lists","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-qualify_expression.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Qualify the namespaces of everything in an expression — .qualify_expression","text":"","code":"testthat::expect_equal(   .qualify_expression(expression(12))$cl,   expression(12) )  testthat::expect_equal(   .qualify_expression(expression(rnorm))$cl,   expression(stats::rnorm) )  tmp = .qualify_expression(expression({new_var = 12})) testthat::expect_equal(tmp$defined, list(as.name(\"new_var\")))  tmp2 = .qualify_expression(expression({list(new_var = 12, old_var = 14)})) testthat::expect_equal(tmp2$defined, list())  fn = function(x) {   y <- runif(x)   stats::rnorm(x,y)   x[1] <- 12   x[2] <- !!z # inlining happens during expression parsing...? }  tmp3 = .qualify_expression(body(fn), defined=list(as.name(\"x\"))) testthat::expect_equal(tmp3$unqual, list(as.name(\"z\"))) testthat::expect_equal(tmp3$defined, list(as.name(\"x\"),as.name(\"y\"))) testthat::expect_equal(format(tmp3$cl), c(   \"{\",   \"    y <- stats::runif(x)\",   \"    stats::rnorm(x, y)\",   \"    x[1] <- 12\",   \"    x[2] <- !!z\",   \"}\" ))  library(ggplot2) tmp4 = .qualify_expression(expression(diamonds$cut)) testthat::expect_equal(tmp4$cl, expression(ggplot2::diamonds$cut))  tmp5 = .qualify_expression(expression(diamonds$imaginary(rnorm(1000)))) testthat::expect_equal(   tmp5$cl,   expression(ggplot2::diamonds$imaginary(stats::rnorm(1000))) )  tmp6 = .qualify_expression(expression(function(n,mu) rnorm(n,mu))) testthat::expect_equal(tmp6$defined, list()) testthat::expect_equal(   format(tmp6$cl),   \"expression(function(n, mu) stats::rnorm(n, mu))\" )  tmp7 = .qualify_expression(expression(Species = NULL)) testthat::expect_equal(length(tmp7$cl), 1L) testthat::expect_equal(tmp7$cl, expression(Species = NULL))"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-recycle.html","id":null,"dir":"Reference","previous_headings":"","what":"Strictly recycle function parameters — .recycle","title":"Strictly recycle function parameters — .recycle","text":".recycle called within function ensures parameters calling function length repeating using rep. function alters environment called. stricter R recycling repeat vectors length one match longer ones, throws informative errors.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-recycle.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Strictly recycle function parameters — .recycle","text":"","code":".recycle(..., .min = 1, .env = rlang::caller_env())"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-recycle.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Strictly recycle function parameters — .recycle","text":"... variables recycle .min minimum length results (defaults 1) .env environment recycle within.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-recycle.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Strictly recycle function parameters — .recycle","text":"length longest variable","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-recycle.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Strictly recycle function parameters — .recycle","text":"NULL values recycled, missing values ignored.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-recycle.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Strictly recycle function parameters — .recycle","text":"","code":"testfn = function(a, b, c) {   n = .recycle(a,b,c)   return(list(     a=a, b=b, c=c, n=n   )) }  tmp = testfn(a=c(1,2,3), b=\"needs recycling\", c=NULL)  testthat::expect_equal(tmp$n, 3) testthat::expect_null(tmp$c) testthat::expect_equal(length(tmp$a), length(tmp$b))  # no parameter testthat::expect_error(testfn(a=c(1,2,3), c=NULL))  tmp = testfn(a=character(), b=integer(), c=NULL)  testthat::expect_equal(tmp$n, 0)  # inconsistent to have a zero length and a non zero length testthat::expect_error(testfn(a=c(\"a\",\"b\"), b=integer(), c=NULL))  # This is currently unsupported #testfn = function(a, b, c, ...) { # n = .recycle(a,b,c, ...) # return(list( #   a=a, b=b, c=c, n=n, ... # )) #} # #tmp = testfn(a=c(1,2,3), b=\"needs recycling\", c=NULL, d=\"additional\")"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-sample_constrained.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply derived values and constraints to samples — .sample_constrained","title":"Apply derived values and constraints to samples — .sample_constrained","text":"Repeatedly samples removes invalid desired number valid samples reached. also calculates derived values","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-sample_constrained.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply derived values and constraints to samples — .sample_constrained","text":"","code":".sample_constrained(proposal_list, n_sims, sampler_fn = .sample_priors, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-sample_constrained.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply derived values and constraints to samples — .sample_constrained","text":"proposal_list list empirical probability distributions map MVN space proposal space, \"prior\" adaptive wave. already used generate proposals mapping sim_df n_sims number simulations run per wave (SMC Adaptive) overall (Rejection). rejection sampling large number recommended, others sma sampler_fn function creates random samples ... passed sampler_fn","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-sample_constrained.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply derived values and constraints to samples — .sample_constrained","text":"data frame samples MVN (prefixed abc_mvn_) parameter space.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-sample_constrained.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Apply derived values and constraints to samples — .sample_constrained","text":"","code":"p = new_abc_prior(   .dists = list(     mean = as.dist_fns(\"norm\",4,2),     sd = as.dist_fns(\"gamma\",2)   ),   .derived = list(     shape ~ mean^2 / sd^2,     rate ~ mean / sd^2   ),   .constraints = list(     ~ mean > sd   ) )  s = .sample_constrained(p,1000)  testthat::expect_equal(   colnames(s),   c(\"abc_mvn_mean\", \"mean\", \"abc_mvn_sd\", \"sd\", \"shape\", \"rate\") )  testthat::expect_equal(all(s$mean > s$sd), TRUE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-sample_priors.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample for the prior distribution — .sample_priors","title":"Sample for the prior distribution — .sample_priors","text":"uses multivariate normal copula generate correlated structure. correlation held attribute proposals. N.B. used construct derived values apply constraints complex deferred. Constraints change probability distribution also affect validity proposal distribution.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-sample_priors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample for the prior distribution — .sample_priors","text":"","code":".sample_priors(proposal_list, n_sims)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-sample_priors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample for the prior distribution — .sample_priors","text":"proposal_list list empirical probability distributions map MVN space proposal space, \"prior\" adaptive wave. already used generate proposals mapping sim_df n_sims number simulations run per wave (SMC Adaptive) overall (Rejection). rejection sampling large number recommended, others sma","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-sample_priors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample for the prior distribution — .sample_priors","text":"data frame samples MVN (prefixed abc_mvn_) parameter space.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-sample_priors.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Sample for the prior distribution — .sample_priors","text":"","code":"p = new_abc_prior(   .dists = list(     mean = as.dist_fns(\"norm\",4,2),     sd = as.dist_fns(\"gamma\",2)   ),   .derived = list(     shape ~ mean^2 / sd^2,     rate ~ mean / sd^2   ) )  s = .sample_priors(p,10) testthat::expect_equal(   colnames(s),   c(\"abc_mvn_mean\", \"mean\", \"abc_mvn_sd\", \"sd\") )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-sample_using_perturbation.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a new set of particles from a previous wave using perturbation — .sample_using_perturbation","title":"Generate a new set of particles from a previous wave using perturbation — .sample_using_perturbation","text":"set particles close existing ones, depending kernel_t parameter.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-sample_using_perturbation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a new set of particles from a previous wave using perturbation — .sample_using_perturbation","text":"","code":".sample_using_perturbation(priors_list, n_sims, prev_sim_df)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-sample_using_perturbation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a new set of particles from a previous wave using perturbation — .sample_using_perturbation","text":"priors_list list priors named list dist_fns, plus one sided formulae constraints 2 sided formulae derived values. correlation matrix may also present attribute cor. n_sims number simulations run per wave (SMC Adaptive) overall (Rejection). rejection sampling large number recommended, others sma prev_sim_df output previous ABC wave including abc_weight column","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-sample_using_perturbation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a new set of particles from a previous wave using perturbation — .sample_using_perturbation","text":"sim_df","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-summary_distance.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine simulation scores to a single distance metric. — .summary_distance","title":"Combine simulation scores to a single distance metric. — .summary_distance","text":"function calculates overall score individual simulation, based combining components output score_list comparing target component scores original observed data. Mahalanobis distance calculated relative distribution first wave (.e. priors directly sampled).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-summary_distance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine simulation scores to a single distance metric. — .summary_distance","text":"","code":".summary_distance(   component_scores,   obsscores = NULL,   distance_method = c(\"euclidean\", \"manhattan\", \"mahalanobis\"),   wave1_metrics = NULL,   scoreweights = NULL )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-summary_distance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine simulation scores to a single distance metric. — .summary_distance","text":"component_scores list column scores. entry list obsscores Summary scores observational data. named list, equivalent output scorer_fn, observed data. given typically assumed zeros. distance_method metric used combine simscores obsscores. One \"euclidean\", \"normalised\", \"manhattan\", \"mahalanobis\". scoreweights named vector names matching output scorer_fn defines importance component scoring overall distance weighting given simulation. can used assign weight certain parts model output. euclidean manhattan distance methods weights multiply output scorer_fn directly. 2 distance methods degree normalisation done first first wave scores make different components approximately relevance overall score.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-summary_distance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine simulation scores to a single distance metric. — .summary_distance","text":"vector distances","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-super_crate.html","id":null,"dir":"Reference","previous_headings":"","what":"Create an environment of shared crates. — .super_crate","title":"Create an environment of shared crates. — .super_crate","text":"Crated functions share data single dependency free environment.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-super_crate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create an environment of shared crates. — .super_crate","text":"","code":".super_crate(   .fns,   ...,   .parent_env = baseenv(),   .error_arg = \".fn\",   .error_call = environment(),   .nsqualify = FALSE )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-super_crate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create an environment of shared crates. — .super_crate","text":".fns named list functions ... Named arguments declare environment .fn. .parent_env default baseenv() ensures evaluation environment crate isolated search path. Specifying another environment global environment allows condition relaxed (expense longer able rely local run giving results one different process). .error_arg argument name string. argument mentioned error messages input origin problem. .error_call execution environment currently running function, e.g. caller_env(). function mentioned error messages source error. See call argument abort() information. .nsqualify check undefined global references qualify namespaces?","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-super_crate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create an environment of shared crates. — .super_crate","text":"environment containing crated functions","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dot-super_crate.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Create an environment of shared crates. — .super_crate","text":"","code":"msg = \"hello\" e = .super_crate(   list(     plusx = function(z) {      return(z+x)     },     plusy = function(z) {      return(z+y+plusx(z))     }     # splicing does not work     # hi = function() {     #   print(!!msg)     # }   ),   x = 1:10,   y = 11:20 )  testthat::expect_equal(   e$plusy(1),   c(14, 16, 18, 20, 22, 24, 26, 28, 30, 32) )"},{"path":"https://ai4ci.github.io/tidyabc/reference/dwedge.html","id":null,"dir":"Reference","previous_headings":"","what":"Wedge distribution — dwedge","title":"Wedge distribution — dwedge","text":"wedge distribution support 0 1 linear probability density function support.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dwedge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wedge distribution — dwedge","text":"","code":"dwedge(x, a, lower.tail = TRUE, log = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/dwedge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wedge distribution — dwedge","text":"x vector quantiles gradient -2 (left skewed) 2 (right skewed) lower.tail logical; TRUE (default), probabilities P[X<=x] otherwise P[X>x]. log logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dwedge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wedge distribution — dwedge","text":"vector probabilities, quantiles, densities samples.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dwedge.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Wedge distribution — dwedge","text":"rwedge can combined quantile functions skew standard distributions, introduce correlation weight certain parts distribution.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/dwedge.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wedge distribution — dwedge","text":"","code":"pwedge(seq(0,1,0.1), a=1) #>  [1] 0.5 0.6 0.7 0.8 0.9 1.0 1.1 1.2 1.3 1.4 1.5 dwedge(seq(0,1,0.1), a=1) #>  [1] 0.000 0.055 0.120 0.195 0.280 0.375 0.480 0.595 0.720 0.855 1.000 qwedge(c(0.25,0.5,0.75), a=-1) #> [1] 0.1771243 0.3819660 0.6339746  stats::cor(   stats::qnorm(rwedge(1000, a=2)),   stats::qnorm(rwedge(1000, a=-2)) ) #> [1] 0.00150719"},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a piecewise logit transformed linear model to cumulative data — empirical","title":"Fit a piecewise logit transformed linear model to cumulative data — empirical","text":"creates statistical distribution functions fitting data transformed space. Inputs can either weighted data observations (x,w pairs) CDF (x,p pairs). X axis transformation specified link parameter either something like \"log\", \"logit\", etc can also specified statistical distribution, even length 2 numeric vector defining support.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a piecewise logit transformed linear model to cumulative data — empirical","text":"","code":"empirical(   x,   ...,   w = NULL,   p = NULL,   link = \"ident\",   fit_spline = !is.null(knots),   knots = NULL,   name = NULL )"},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a piecewise logit transformed linear model to cumulative data — empirical","text":"x either vector samples distribution X cut-offs cumulative probabilities combined p ... Named arguments passed .logit_z_interpolation bw bandwidth expressed terms probability width, proportion observations. Named arguments passed empirical_cdf smooth fits empirical distribution pair splines CDF quantile function, creating mostly smooth density. smoothness comes price potential -fitting produce small differences p q functions x=p(q(x)) longer exactly true. Setting false replace piecewise linear fit smooth density, exact forward reverse transformation. ... used w data fits, vector length x giving importance weight observation. need normalised. must non zero weights, must finite. p CDF fits, vector length x giving P(X <= x). link link function. Either name, link_fns S3 object. latter case derived statistical distribution .link_fns(<dist_fns>). supports use prior define support empirical function, designed prevent tail truncation. Support updated quantile function provided prior. fit_spline distributions data fit spline reduce memory usage speed sampling? knots given assumed true, set TRUE allow knots determined data. knots spline fitting data many points use model cdf? default estimated data. recommend uneven number, without lot data tend overfit 9 knots 1000 samples seems OK, max 7 250, 5 100. Less usually . name label distribution. given one generated distribution parameters. can used part plotting.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a piecewise logit transformed linear model to cumulative data — empirical","text":"dist_fns S3 object containing functions p() CDF, q() quantile, r() RNG, d() density. density function may discontinuous.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit a piecewise logit transformed linear model to cumulative data — empirical","text":"empirical distribution data fully transformed logit-z space cumulative weighted data interpolated kernel weighted linear model. case CDF data empirical distribution fitted piecewise linear monotonically increasing spline fit data Q-Q space. spline bounded 0 1 dimensions. function imputes tails distributions within constraints link functions. Given perfect data samples quantiles well approximate tail. p provided, data treated CDF points \\((x_i, p_i)\\). function calls empirical_cdf(x, p, ...) internally. involves: Transformation: \\(x\\) values mapped via link function \\(T\\) standardized scale \\(q_x = T(x)\\). Interpolation: Monotonic splines (piecewise linear functions smooth=FALSE) fitted \\((q_x, p)\\) pairs Q-Q space, yielding functions \\(F_{cdf}(q_x)\\) \\(F_{qf}(p)\\). Tail Extrapolation: fit extended \\((0,0)\\) \\((1,1)\\) necessary. Final Functions: \\(P(X \\leq x) = F_{cdf}(T(x))\\) \\(Q(p) = T^{-1}(F_{qf}(p))\\). w provided (p NULL), data treated weighted samples \\((x_i, w_i)\\). function calls empirical_data(x, w, ...) internally. involves: Transformation: \\(x\\) values mapped via link function \\(T\\) \\(x_T = T(x)\\). Standardization: Values standardized \\(x_Z = (x_T - \\mu_{w,T})/\\sigma_{w,T}\\). Weighted CDF: Empirical CDF \\(y = P(X_T \\leq x_T)\\) calculated \\(w\\). Logit Transformation: \\(y_L = \\text{logit}(y)\\). Local Fitting: locfit used fit models \\(x_Z\\) \\(y_L\\). Final Functions: Composed fitted models inverse link \\(T^{-1}\\). fit_spline=TRUE (knots specified) fitting data, resulting empirical_data fit re-interpolated using empirical_cdf quantiles defined knots.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Fit a piecewise logit transformed linear model to cumulative data — empirical","text":"","code":"# from samples: withr::with_seed(123,{  e2 = empirical(rnorm(10000))  testthat::expect_equal(e2$p(-5:5), pnorm(-5:5), tolerance=0.01)  testthat::expect_equal(e2$q(seq(0,1,0.1)), qnorm(seq(0,1,0.1)), tolerance=0.05) })  p2 = seq(0,1,0.1) testthat::expect_equal( e2$p(e2$q(p2)), p2, tolerance = 0.001)  # updating a prior, with a horribly skewed gamma distribution # not a great fit but not great data withr::with_seed(124,{   data = rgamma(500,1)   e4 = empirical(data, link=as.dist_fns(\"unif\",0,10))   if (interactive()) plot(e4)+ggplot2::geom_function(fun = ~ dgamma(.x, 1))   testthat::expect_equal(mean(e4$r(10000)), 1, tolerance=0.1)    e5 = empirical(data,link=\"log\")   testthat::expect_equal(mean(e5$r(10000)), 1, tolerance=0.1)   if (interactive()) plot(e5)+ggplot2::geom_function(fun = ~ dgamma(.x, 1)) })  withr::with_seed(123,{   data = c(rnorm(200,4),rnorm(200,7))   weights = c(rep(0.1,200), rep(0.3,200))   e6 = empirical(x=data,w = weights)   plot(e6)   testthat::expect_equal(     format(e6),     \"empirical; Median (IQR) 6.56 [5.23 — 7.42]\"   ) })  # Construct a normal using a sequence and density as weight. e7 = empirical(x=seq(-10,10,length.out=1000),w=dnorm(seq(-10,10,length.out=1000)),knots = 20) testthat::expect_equal(e7$p(-5:5), pnorm(-5:5), tolerance=0.01)"},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical_cdf.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a piecewise logit transformed linear model to a CDF — empirical_cdf","title":"Fit a piecewise logit transformed linear model to a CDF — empirical_cdf","text":"fits CDF quantile function cumulative probabilities transformed space. X value transformation specified link parameter either something like \"log\", \"logit\", etc can also specified logit transformed cdf quantile function statistical distribution.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical_cdf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a piecewise logit transformed linear model to a CDF — empirical_cdf","text":"","code":"empirical_cdf(x, p, link = \"ident\", smooth = TRUE, name = NULL, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical_cdf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a piecewise logit transformed linear model to a CDF — empirical_cdf","text":"x either vector samples distribution X cut-offs cumulative probabilities combined p p CDF fits, vector length x giving P(X <= x). link link function. Either name, link_fns S3 object. latter case derived statistical distribution .link_fns(<dist_fns>). supports use prior define support empirical function, designed prevent tail truncation. Support updated quantile function provided prior. smooth fits empirical distribution pair splines CDF quantile function, creating mostly smooth density. smoothness comes price potential -fitting produce small differences p q functions x=p(q(x)) longer exactly true. Setting false replace piecewise linear fit smooth density, exact forward reverse transformation. name label distribution. given one generated distribution parameters. can used part plotting. ... used","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical_cdf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a piecewise logit transformed linear model to a CDF — empirical_cdf","text":"dist_fns S3 object containing functions p() CDF, q() quantile, r() RNG, d() density. density function may discontinuous.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical_cdf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit a piecewise logit transformed linear model to a CDF — empirical_cdf","text":"empirical distribution fitted piecewise linear monotonically increasing spline fit CDF transformed X logit Y space. end points linearly interpolated space tail_pth quantile. function can fit data provided x, P(X<=x) pairs. Constructs empirical distribution CDF points \\((x_i, p_i)\\) fitting monotonic splines transformed quantile–quantile (Q–Q) space. input \\(x\\) first mapped standardized probability scale via link-dependent transformation \\(q_x = T(x)\\). resulting pairs \\((q_x, p)\\) used build two monotonic interpolation functions: $$   p = F_{\\text{cdf}}(q_x), \\quad q_x = F_{\\text{qf}}(p) $$ \\(F_{\\text{cdf}}\\) \\(F_{\\text{qf}}\\) constructed follows: smooth = FALSE, piecewise linear interpolants (via stats::approx). smooth = TRUE, strictly monotonic cubic splines fitted using \"monoH.FC\" method stats::splinefun, converted polynomial spline form (polySpline). Monotonicity enforced requiring \\(q_x\\) \\(p\\) strictly increasing tie-breaking perturbations. Tail extrapolation applied linearly extending first last segments Q–Q space points \\((0,0)\\) \\((1,1)\\) already included. final distribution functions : $$   P(X \\leq x) = F_{\\text{cdf}}(T(x)), \\quad   Q(p) = T^{-1}(F_{\\text{qf}}(p)) $$ \\(T\\) \\(T^{-1}\\) derived link argument. function imputes tails distributions. Given perfect data samples quantiles recover tail","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical_cdf.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Fit a piecewise logit transformed linear model to a CDF — empirical_cdf","text":"","code":"#from cdf: xs = c(2,3,6,9) ps = c(0.1,0.4,0.6,0.95) e = empirical_cdf(xs, ps, link=\"log\")  testthat::expect_equal(e$p(xs), ps) testthat::expect_equal(e$q(ps), xs)  # quantiles: p = c(0.025,0.05,0.10,0.25,0.5,0.75,0.9,0.95,0.975) q = stats::qgamma(p, shape=2) shape2_gamma = as.dist_fns(pgamma, shape=2) gemp = empirical_cdf(q,p,link = shape2_gamma) withr::with_seed(123, {   testthat::expect_equal(mean(gemp$r(100000)),2, tolerance=0.01)   testthat::expect_equal(sd(gemp$r(100000)), sqrt(2), tolerance=0.01) })  # With perfect input can recover the underlying distribution including tails: tmp = empirical_cdf(x=seq(0.01,0.99,0.01),p=seq(0.01,0.99,0.01),link = as.dist_fns(punif,0, 1), knots = 100) testthat::expect_equal(   tmp$q(c(0.01, 0.1, 0.25, 0.75, 0.9, 0.99)),   c(0.01, 0.1, 0.25, 0.75, 0.9, 0.99),   tolerance = 0.002 )  # bimodal with log link and end defined tmp3 = empirical_cdf(x = 1:7, c(0.1,0.3,0.4,0.4,0.5,0.9,1),link=\"log\") testthat::expect_equal(   tmp3$p(-1:8),   c(0, 0, 0.1, 0.3, 0.4, 0.4, 0.5, 0.9, 1, 1),   tolerance = 0.01 )  testthat::expect_equal(   tmp3$q(seq(0, 1, 0.2)),   c(0, 1.63476839034733, 3, 5.05332769159444, 5.51891960240613, 7) )"},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a piecewise logit transformed linear model to weighted data — empirical_data","title":"Fit a piecewise logit transformed linear model to weighted data — empirical_data","text":"fits CDF quantile function ranked data transformed space. X value transformation specified link parameter either something like \"log\", \"logit\", etc.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a piecewise logit transformed linear model to weighted data — empirical_data","text":"","code":"empirical_data(x, w = NULL, link = \"identity\", ..., name = NULL, bw = NULL)"},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a piecewise logit transformed linear model to weighted data — empirical_data","text":"x either vector samples distribution X cut-offs cumulative probabilities combined p w data fits, vector length x giving importance weight observation. need normalised. must non zero weights, must finite. link link function. Either name, link_fns S3 object. latter case derived statistical distribution .link_fns(<dist_fns>). supports use prior define support empirical function, designed prevent tail truncation. Support updated quantile function provided prior. ... Named arguments passed .logit_z_interpolation bw bandwidth expressed terms probability width, proportion observations. Named arguments passed empirical_cdf smooth fits empirical distribution pair splines CDF quantile function, creating mostly smooth density. smoothness comes price potential -fitting produce small differences p q functions x=p(q(x)) longer exactly true. Setting false replace piecewise linear fit smooth density, exact forward reverse transformation. ... used name label distribution. given one generated distribution parameters. can used part plotting. bw bandwidth expressed terms probability width, proportion observations.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a piecewise logit transformed linear model to weighted data — empirical_data","text":"dist_fns S3 object function contains statistical distribution functions data.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit a piecewise logit transformed linear model to weighted data — empirical_data","text":"empirical distribution fitted piecewise linear z transformed X logit Y space. evaluation points linearly interpolated space given bandwidth interpolation. Link Transformation: Input data x transformed using specified link function: \\(x_T = T(x)\\), \\(T\\) transformation defined link argument. Standardization (Z-space): Transformed values \\(x_T\\) standardized: \\(x_Z = \\frac{x_T - \\mu_{w,T}}{\\sigma_{w,T}}\\), \\(\\mu_{w,T}\\) \\(\\sigma_{w,T}\\) weighted mean standard deviation \\(x_T\\). Weighted Empirical CDF: cumulative weights calculated form probabilities \\(y = P(X_T \\leq x_T)\\). Logit Transformation: CDF probabilities transformed: \\(y_L = \\text{logit}(y)\\). Local Fitting (via .logit_z_locfit): Local likelihood models (using locfit) fitted \\(x_Z\\) \\(y_L\\) represent CDF, derivative (density), inverse (quantile) function transformed space. Function Construction: final p, q, r, d functions constructed composing fitted models step 5 inverse link transformation \\(T^{-1}\\). example, final CDF \\(P(X \\leq q) = F_{fitted}(\\text{logit}^{-1}(T(q)))\\), final quantile function \\(Q(p) = T^{-1}(Q_{fitted}(p))\\), \\(Q_{fitted}\\) quantile function derived fitted models Z-space. function imputes tails distributions. Given perfect data samples quantiles recover tail","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/empirical_data.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Fit a piecewise logit transformed linear model to weighted data — empirical_data","text":"","code":"# from samples: withr::with_seed(123,{  e2 = empirical_data(rnorm(10000), bw=0.1)  testthat::expect_equal(e2$p(-5:5), pnorm(-5:5), tolerance=0.01)  testthat::expect_equal(e2$d(-5:5), dnorm(-5:5), tolerance=0.05)  testthat::expect_equal(e2$q(seq(0,1,0.1)), qnorm(seq(0,1,0.1)), tolerance=0.025) })   # Construct a normal using a sequence and density as weight. e7 = empirical_data(   x=seq(-10,10,length.out=1000),   w=dnorm(seq(-10,10,length.out=1000)) ) testthat::expect_equal(e7$p(-5:5), pnorm(-5:5), tolerance=0.01)"},{"path":"https://ai4ci.github.io/tidyabc/reference/example_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Example generators — example_fns","title":"Example generators — example_fns","text":"set internally cached functions support examples. exported internal functions examples can run correctly cache output prevent excessive repetition code examples.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/example_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example generators — example_fns","text":"","code":"example_sim_fn(mean, sd1, sd2)  example_scorer_fn(simdata, obsdata)  example_obs()  example_truth()  example_obsdata()  example_priors_list()  example_rejection_fit()  example_smc_fit()  example_adaptive_fit()"},{"path":"https://ai4ci.github.io/tidyabc/reference/example_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Example generators — example_fns","text":"mean example mean sd1 example normal sd () sd2 example gamma sd (B) simdata output example_sim_fn() obsdata e.g. example_obsdata()","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/example_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Example generators — example_fns","text":"list B samples normal gamma list scores output test_simulation() example truth parameter example obsdata parameter example priors_list parameter example abc_rejection output example abc_smc output example abc_adaptive output","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/example_fns.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Example generators — example_fns","text":"example_sim_fn(): Example simulation function example_scorer_fn(): Example simulation function example_obs(): Example output test_simulation() example_truth(): Example truth parameter example_obsdata(): Example obsdata parameter example_priors_list(): Example priors_list parameter example_rejection_fit(): Example abc_rejection output example_smc_fit(): Example abc_smc output example_adaptive_fit(): Example abc_adaptive output","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/example_fns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Example generators — example_fns","text":"","code":"example_sim_fn(3,2,1) %>% lapply(head,10) #> $A #>  [1] -0.2242239  5.1467233  2.4749420  1.9289318  0.7444798  4.6197233 #>  [7]  2.1224445 -1.9099227  3.4123414  2.9349354 #>  #> $B #>  [1] 2.495385 5.192140 4.253605 3.195637 1.943004 2.109413 3.193004 6.963725 #>  [9] 5.179482 3.322220 #>  example_scorer_fn(   example_obsdata(),   example_sim_fn(3,2,1) ) #> $A #> [1] 0.9791697 #>  #> $B #> [1] 1.9886 #>  example_obs() %>% rapply(head,n=10, how=\"replace\") #> $obsdata #> $obsdata$A #>  [1] 3.879049 4.539645 8.117417 5.141017 5.258575 8.430130 5.921832 2.469878 #>  [9] 3.626294 4.108676 #>  #> $obsdata$B #>  [1] 3.963790 4.935891 5.197293 3.450608 5.984255 5.150334 7.583826 5.601786 #>  [9] 4.467521 4.746891 #>  #>  #> $truth #> mean  sd1  sd2  #>    5    2    1  #>  #> $sim_fn #> [1] \"function (mean, sd1, sd2) \"                                                     #> [2] \"{\"                                                                              #> [3] \"    return(list(A = stats::rnorm(1000, mean, sd1), B = tidyabc::rgamma2(1000, \" #> [4] \"        mean, sd2)))\"                                                           #> [5] \"}\"                                                                              #>  #> $obsscores #> $obsscores$A #> [1] 0 #>  #> $obsscores$B #> [1] 0 #>  #>  #> $scorer_fn #> [1] \"function (simdata, obsdata) \"                                       #> [2] \"{\"                                                                  #> [3] \"    return(list(A = tidyabc::calculate_wasserstein(obsdata$A, \"     #> [4] \"        simdata$A), B = tidyabc::calculate_wasserstein(obsdata$B, \" #> [5] \"        simdata$B)))\"                                               #> [6] \"}\"                                                                  #>  example_truth() #> mean  sd1  sd2  #>    5    2    1  example_obsdata() %>% lapply(head,10) #> $A #>  [1] 3.879049 4.539645 8.117417 5.141017 5.258575 8.430130 5.921832 2.469878 #>  [9] 3.626294 4.108676 #>  #> $B #>  [1] 3.963790 4.935891 5.197293 3.450608 5.984255 5.150334 7.583826 5.601786 #>  [9] 4.467521 4.746891 #>  example_priors_list() #> Parameters:  #> * mean: unif(min = 0, max = 10) #> * sd1: unif(min = 0, max = 5) #> * sd2: unif(min = 0, max = 5) #> Constraints: #> * mean > sd2 example_rejection_fit() #> ABC rejection, 1 wave. #> ABC rejection fit: single wave #> Parameter estimates: #> # A tibble: 3 × 4 #> # Groups:   param [3] #>   param mean_sd       median_95_CrI           ESS #>   <chr> <chr>         <chr>                 <dbl> #> 1 mean  5.000 ± 0.176 4.991 [4.593 — 5.417]  74.0 #> 2 sd1   2.309 ± 0.559 2.200 [1.362 — 3.848]  74.0 #> 3 sd2   1.219 ± 0.289 1.223 [0.664 — 2.054]  74.0 example_smc_fit() #> ABC SMC fit: 8 waves - (converged) #> Parameter estimates: #> # A tibble: 3 × 4 #> # Groups:   param [3] #>   param mean_sd       median_95_CrI           ESS #>   <chr> <chr>         <chr>                 <dbl> #> 1 mean  4.977 ± 0.033 4.976 [4.890 — 5.065]  255. #> 2 sd1   1.993 ± 0.072 1.995 [1.824 — 2.161]  255. #> 3 sd2   0.986 ± 0.034 0.984 [0.899 — 1.081]  255. example_adaptive_fit() #> ABC-Adaptive #> Effective sample size has reduced below 200. #> Attempting recovery with larger acceptance rate: 62.500% #> Adaptive waves:  ■■■■■■■■                          23% | wave 2 ETA:  4s #> Adaptive waves:  ■■■■■■■■■■■■■■■■■■■■■■■■■■■■      89% | wave 7 ETA:  1s #> ABC adaptive fit: 8 waves - (not yet converged) #> Parameter estimates: #> # A tibble: 3 × 4 #> # Groups:   param [3] #>   param mean_sd       median_95_CrI           ESS #>   <chr> <chr>         <chr>                 <dbl> #> 1 mean  4.964 ± 0.129 4.958 [4.717 — 5.261] 1519. #> 2 sd1   2.124 ± 0.233 2.078 [1.522 — 2.905] 1519. #> 3 sd2   1.139 ± 0.173 1.134 [0.753 — 1.531] 1519."},{"path":"https://ai4ci.github.io/tidyabc/reference/format.dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Format a dist_fns S3 object — format.dist_fns","title":"Format a dist_fns S3 object — format.dist_fns","text":"Format dist_fns S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/format.dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format a dist_fns S3 object — format.dist_fns","text":"","code":"# S3 method for class 'dist_fns' format(x, ..., digits = 3)"},{"path":"https://ai4ci.github.io/tidyabc/reference/format.dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format a dist_fns S3 object — format.dist_fns","text":"x dist_fns S3 object ... passed onto methods digits number significant digits","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/format.dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format a dist_fns S3 object — format.dist_fns","text":"character value","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/format.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Format a dist_fns_list — format.dist_fns_list","title":"Format a dist_fns_list — format.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/format.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format a dist_fns_list — format.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' format(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/format.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format a dist_fns_list — format.dist_fns_list","text":"x dist_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/format.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format a dist_fns_list — format.dist_fns_list","text":"character vector list","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/format.link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Format a link_fns S3 object — format.link_fns","title":"Format a link_fns S3 object — format.link_fns","text":"Format link_fns S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/format.link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format a link_fns S3 object — format.link_fns","text":"","code":"# S3 method for class 'link_fns' format(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/format.link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format a link_fns S3 object — format.link_fns","text":"x link_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/format.link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format a link_fns S3 object — format.link_fns","text":"character value","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/format.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Format a link_fns_list — format.link_fns_list","title":"Format a link_fns_list — format.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/format.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format a link_fns_list — format.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' format(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/format.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format a link_fns_list — format.link_fns_list","text":"x link_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/format.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format a link_fns_list — format.link_fns_list","text":"character vector list","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/is.dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if this is a dist_fns S3 object — is.dist_fns","title":"Check if this is a dist_fns S3 object — is.dist_fns","text":"Check dist_fns S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/is.dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if this is a dist_fns S3 object — is.dist_fns","text":"","code":"is.dist_fns(x)"},{"path":"https://ai4ci.github.io/tidyabc/reference/is.dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if this is a dist_fns S3 object — is.dist_fns","text":"x anything","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/is.dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if this is a dist_fns S3 object — is.dist_fns","text":"TRUE FALSE","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/is.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if this is a dist_fns_list S3 object — is.dist_fns_list","title":"Check if this is a dist_fns_list S3 object — is.dist_fns_list","text":"Check dist_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/is.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if this is a dist_fns_list S3 object — is.dist_fns_list","text":"","code":"is.dist_fns_list(x)"},{"path":"https://ai4ci.github.io/tidyabc/reference/is.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if this is a dist_fns_list S3 object — is.dist_fns_list","text":"x anything","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/is.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if this is a dist_fns_list S3 object — is.dist_fns_list","text":"TRUE FALSE","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/is.link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if this is a link_fns S3 object — is.link_fns","title":"Check if this is a link_fns S3 object — is.link_fns","text":"Check link_fns S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/is.link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if this is a link_fns S3 object — is.link_fns","text":"","code":"is.link_fns(x)"},{"path":"https://ai4ci.github.io/tidyabc/reference/is.link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if this is a link_fns S3 object — is.link_fns","text":"x anything","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/is.link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if this is a link_fns S3 object — is.link_fns","text":"TRUE FALSE","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/is.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if this is a link_fns_list S3 object — is.link_fns_list","title":"Check if this is a link_fns_list S3 object — is.link_fns_list","text":"Check link_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/is.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if this is a link_fns_list S3 object — is.link_fns_list","text":"","code":"is.link_fns_list(x)"},{"path":"https://ai4ci.github.io/tidyabc/reference/is.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if this is a link_fns_list S3 object — is.link_fns_list","text":"x anything","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/is.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if this is a link_fns_list S3 object — is.link_fns_list","text":"TRUE FALSE","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/knit_print.dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a dist_fns S3 object in an Rd document — knit_print.dist_fns","title":"Print a dist_fns S3 object in an Rd document — knit_print.dist_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/knit_print.dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a dist_fns S3 object in an Rd document — knit_print.dist_fns","text":"","code":"knit_print.dist_fns(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/knit_print.dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a dist_fns S3 object in an Rd document — knit_print.dist_fns","text":"x dist_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/knit_print.dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print a dist_fns S3 object in an Rd document — knit_print.dist_fns","text":"-knitr chunk","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/knit_print.link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a link_fns S3 object in an Rd document — knit_print.link_fns","title":"Print a link_fns S3 object in an Rd document — knit_print.link_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/knit_print.link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a link_fns S3 object in an Rd document — knit_print.link_fns","text":"","code":"knit_print.link_fns(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/knit_print.link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a link_fns S3 object in an Rd document — knit_print.link_fns","text":"x link_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/knit_print.link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print a link_fns S3 object in an Rd document — knit_print.link_fns","text":"-knitr chunk","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/kurtosis.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the excess kurtosis of a set of data — kurtosis","title":"Calculate the excess kurtosis of a set of data — kurtosis","text":"Calculate excess kurtosis set data","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/kurtosis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the excess kurtosis of a set of data — kurtosis","text":"","code":"kurtosis(x, na.rm = FALSE, excess = TRUE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/kurtosis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the excess kurtosis of a set of data — kurtosis","text":"x vector observations na.rm remove NAs? excess false calculates raw kurtosis rather excess","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/kurtosis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the excess kurtosis of a set of data — kurtosis","text":"excess kurtosis","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/kurtosis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the excess kurtosis of a set of data — kurtosis","text":"","code":"kurtosis(stats::rnorm(1000)) #> [1] 0.2055468 kurtosis(stats::rpois(1000, 2)) # leptokurtic > 0 (usually) #> [1] 0.4278095 kurtosis(stats::runif(1000)) # platykurtic: < 0 #> [1] -1.166538  kurtosis(stats::rlnorm(1000)) #> [1] 29.95296"},{"path":"https://ai4ci.github.io/tidyabc/reference/length.dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"dist_fns S3 objects length is always 1 — length.dist_fns","title":"dist_fns S3 objects length is always 1 — length.dist_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/length.dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"dist_fns S3 objects length is always 1 — length.dist_fns","text":"","code":"# S3 method for class 'dist_fns' length(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/length.dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"dist_fns S3 objects length is always 1 — length.dist_fns","text":"x dist_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/length.dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"dist_fns S3 objects length is always 1 — length.dist_fns","text":"1 always","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/length.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Length of a dist_fns_list — length.dist_fns_list","title":"Length of a dist_fns_list — length.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/length.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Length of a dist_fns_list — length.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' length(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/length.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Length of a dist_fns_list — length.dist_fns_list","text":"x dist_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/length.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Length of a dist_fns_list — length.dist_fns_list","text":"length","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/length.link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"link_fns S3 objects length is always 1 — length.link_fns","title":"link_fns S3 objects length is always 1 — length.link_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/length.link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"link_fns S3 objects length is always 1 — length.link_fns","text":"","code":"# S3 method for class 'link_fns' length(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/length.link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"link_fns S3 objects length is always 1 — length.link_fns","text":"x link_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/length.link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"link_fns S3 objects length is always 1 — length.link_fns","text":"1 always","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/length.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Length of a link_fns_list — length.link_fns_list","title":"Length of a link_fns_list — length.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/length.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Length of a link_fns_list — length.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' length(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/length.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Length of a link_fns_list — length.link_fns_list","text":"x link_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/length.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Length of a link_fns_list — length.link_fns_list","text":"length","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Create an empty link_fns_list — link_fns","title":"Create an empty link_fns_list — link_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create an empty link_fns_list — link_fns","text":"","code":"link_fns()"},{"path":"https://ai4ci.github.io/tidyabc/reference/link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create an empty link_fns_list — link_fns","text":"empty link_fns_list","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/logit-norm.html","id":null,"dir":"Reference","previous_headings":"","what":"Logit-normal distribution — logit-norm","title":"Logit-normal distribution — logit-norm","text":"logit-normal distribution support 0 1.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/logit-norm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logit-normal distribution — logit-norm","text":"n number observations x vector quantiles (0<x<1) q vector quantiles (0<q<1) p vector probabilities log logical; TRUE, probabilities p given log(p). log.p logical; TRUE, probabilities p given log(p). lower.tail logical; TRUE (default), probabilities P[X<=x] otherwise P[X>x]. meanlogit mean logit scale sdlogit sd logit scale prob.0.5 median true scale kappa dispersion parameter 0 (none) 1 maximum dispersion","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/logit-norm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logit-normal distribution — logit-norm","text":"vector probabilities, quantiles, densities samples.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/map2_dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Map over two inputs returning a dist_fns_list — map2_dist_fns","title":"Map over two inputs returning a dist_fns_list — map2_dist_fns","text":"Analogous purrr::map2_dbl()","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/map2_dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map over two inputs returning a dist_fns_list — map2_dist_fns","text":"","code":"map2_dist_fns(.x, .y, .f, ..., .progress = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/map2_dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map over two inputs returning a dist_fns_list — map2_dist_fns","text":".x, .y pair vectors, usually length. , vector length 1 recycled length . .f function apply .x, .y pair returns dist_fns S3 object (usually .dist_fns() call) ... Additional arguments passed mapped function. now generally recommend using ... pass additional (constant) arguments .f. Instead use shorthand anonymous function:   makes easier understand arguments belong function tend yield better error messages. .progress Whether show progress bar. Use TRUE turn basic progress bar, use string give name, see progress_bars details.","code":"# Instead of x |> map(f, 1, 2, collapse = \",\") # do: x |> map(\\(x) f(x, 1, 2, collapse = \",\"))"},{"path":"https://ai4ci.github.io/tidyabc/reference/map2_dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map over two inputs returning a dist_fns_list — map2_dist_fns","text":"dist_fns_list","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/map2_link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Map over two inputs returning a link_fns_list — map2_link_fns","title":"Map over two inputs returning a link_fns_list — map2_link_fns","text":"Analogous purrr::map2_dbl()","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/map2_link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map over two inputs returning a link_fns_list — map2_link_fns","text":"","code":"map2_link_fns(.x, .y, .f, ..., .progress = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/map2_link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map over two inputs returning a link_fns_list — map2_link_fns","text":".x, .y pair vectors, usually length. , vector length 1 recycled length . .f function apply .x, .y pair returns link_fns S3 object (usually .link_fns() call) ... Additional arguments passed mapped function. now generally recommend using ... pass additional (constant) arguments .f. Instead use shorthand anonymous function:   makes easier understand arguments belong function tend yield better error messages. .progress Whether show progress bar. Use TRUE turn basic progress bar, use string give name, see progress_bars details.","code":"# Instead of x |> map(f, 1, 2, collapse = \",\") # do: x |> map(\\(x) f(x, 1, 2, collapse = \",\"))"},{"path":"https://ai4ci.github.io/tidyabc/reference/map2_link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map over two inputs returning a link_fns_list — map2_link_fns","text":"link_fns_list","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/map_dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply a function to each element of a vector returning a dist_fns_list — map_dist_fns","title":"Apply a function to each element of a vector returning a dist_fns_list — map_dist_fns","text":"Analogous purrr::map_dbl()","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/map_dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply a function to each element of a vector returning a dist_fns_list — map_dist_fns","text":"","code":"map_dist_fns(.x, .f, ..., .progress = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/map_dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply a function to each element of a vector returning a dist_fns_list — map_dist_fns","text":".x list atomic vector. .f function apply returns dist_fns S3 object (usually .dist_fns() call) ... Additional arguments passed mapped function. now generally recommend using ... pass additional (constant) arguments .f. Instead use shorthand anonymous function:   makes easier understand arguments belong function tend yield better error messages. .progress Whether show progress bar. Use TRUE turn basic progress bar, use string give name, see progress_bars details.","code":"# Instead of x |> map(f, 1, 2, collapse = \",\") # do: x |> map(\\(x) f(x, 1, 2, collapse = \",\"))"},{"path":"https://ai4ci.github.io/tidyabc/reference/map_dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply a function to each element of a vector returning a dist_fns_list — map_dist_fns","text":"dist_fns_list","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/map_link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply a function to each element of a vector returning a link_fns_list — map_link_fns","title":"Apply a function to each element of a vector returning a link_fns_list — map_link_fns","text":"Analogous purrr::map_dbl()","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/map_link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply a function to each element of a vector returning a link_fns_list — map_link_fns","text":"","code":"map_link_fns(.x, .f, ..., .progress = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/map_link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply a function to each element of a vector returning a link_fns_list — map_link_fns","text":".x list atomic vector. .f function apply returns link_fns S3 object (usually .link_fns() call) ... Additional arguments passed mapped function. now generally recommend using ... pass additional (constant) arguments .f. Instead use shorthand anonymous function:   makes easier understand arguments belong function tend yield better error messages. .progress Whether show progress bar. Use TRUE turn basic progress bar, use string give name, see progress_bars details.","code":"# Instead of x |> map(f, 1, 2, collapse = \",\") # do: x |> map(\\(x) f(x, 1, 2, collapse = \",\"))"},{"path":"https://ai4ci.github.io/tidyabc/reference/map_link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply a function to each element of a vector returning a link_fns_list — map_link_fns","text":"link_fns_list","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/mixture.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct a mixture distribution — mixture","title":"Construct a mixture distribution — mixture","text":"Constructs mixture distribution list component distributions \\(\\text{dist}_i\\) corresponding weights \\(w_i\\). CDF \\(F_{\\text{mix}}\\) mixture weighted sum component CDFs: $$ F_{\\text{mix}}(x) = \\sum_{=1}^{k} w_i \\cdot F_i(x) $$ \\(F_i\\) CDF \\(\\)-th component distribution \\(\\sum w_i = 1\\). implementation first evaluates weighted CDF grid \\(x\\) values (including tail points defined tail_p potentially knot points empirical components). resulting \\((x, F_{\\text{mix}}(x))\\) pairs used input empirical_cdf create final smooth piecewise linear dist_fns object representing mixture distribution.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/mixture.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct a mixture distribution — mixture","text":"","code":"mixture(dists, weights = 1, steps = 200, tail_p = 1e-04, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/mixture.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct a mixture distribution — mixture","text":"dists dist_fn_list distribution functions weights vector weights steps number points mixture distribution evaluated construct empirical mixture tail_p support fo tail distribution ... Named arguments passed empirical_cdf smooth fits empirical distribution pair splines CDF quantile function, creating mostly smooth density. smoothness comes price potential -fitting produce small differences p q functions x=p(q(x)) longer exactly true. Setting false replace piecewise linear fit smooth density, exact forward reverse transformation.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/mixture.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct a mixture distribution — mixture","text":"dist_fn mixture distribution","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/mixture.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Construct a mixture distribution — mixture","text":"","code":"dists = c(   as.dist_fns(\"norm\", mean=-1),   as.dist_fns(\"norm\", mean=1),   as.dist_fns(\"gamma\", shape=2) ) weights = c(1,1,0.3)  mix = mixture(dists,weights) testthat::expect_equal(   format(mix),   \"mixture; Median (IQR) 0.289 [-0.886 — 1.31]\" )"},{"path":"https://ai4ci.github.io/tidyabc/reference/new_dist_calls.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a new dist_fns S3 object — new_dist_calls","title":"Create a new dist_fns S3 object — new_dist_calls","text":"Create new dist_fns S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/new_dist_calls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a new dist_fns S3 object — new_dist_calls","text":"","code":"new_dist_calls(   name = \"NULL\",   pcall,   qcall,   rcall,   dcall,   ...,   params = NULL,   knots = NULL,   smooth = TRUE )"},{"path":"https://ai4ci.github.io/tidyabc/reference/new_dist_calls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a new dist_fns S3 object — new_dist_calls","text":"name name distribution pcall call cumulative probability function qcall call quantile function rcall call RNG function dcall call density function ... parameters distribution. params parameters distribution named list. knots empirical distributions holds details knot points","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/new_dist_calls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a new dist_fns S3 object — new_dist_calls","text":"new dist_fns S3 object dist_fns_list parameters vectorised","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/new_dist_calls.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Create a new dist_fns S3 object — new_dist_calls","text":"","code":"tmp = new_dist_calls(name=\"norm\",   pcall=.qual(\"pnorm\"),   qcall=.qual(\"qnorm\"),   rcall=.qual(\"rnorm\"),   dcall=.qual(\"dnorm\") ) testthat::expect_equal(tmp$p(-2:2), c(   0.0227501319481792,   0.158655253931457,   0.5,   0.841344746068543,   0.977249868051821 ))"},{"path":"https://ai4ci.github.io/tidyabc/reference/new_dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a new dist_fns S3 object — new_dist_fns","title":"Create a new dist_fns S3 object — new_dist_fns","text":"Create new dist_fns S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/new_dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a new dist_fns S3 object — new_dist_fns","text":"","code":"new_dist_fns(   name = \"NULL\",   pfn = pnull,   qfn = qnull,   rfn = NULL,   dfn = NULL,   ...,   params = NULL,   knots = NULL,   smooth = TRUE )"},{"path":"https://ai4ci.github.io/tidyabc/reference/new_dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a new dist_fns S3 object — new_dist_fns","text":"name name distribution pfn cumulative probability function qfn quantile function rfn RNG function dfn density function ... parameters distribution. params parameters distribution named list. knots empirical distributions holds details knot points","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/new_dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a new dist_fns S3 object — new_dist_fns","text":"new dist_fns S3 object dist_fns_list parameters vectorised","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/new_link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a new link_fns S3 object — new_link_fns","title":"Create a new link_fns S3 object — new_link_fns","text":"Default identity link","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/new_link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a new link_fns S3 object — new_link_fns","text":"","code":"new_link_fns(   trans = ~.x,   inv = ~.x,   support = c(-Inf, Inf),   ddxtrans = NULL,   ddxinv = NULL,   name = NULL )"},{"path":"https://ai4ci.github.io/tidyabc/reference/new_link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a new link_fns S3 object — new_link_fns","text":"trans forward transforming function inv reverse inverting function support support support link","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/new_link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a new link_fns S3 object — new_link_fns","text":"new link_fns S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pbeta2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Beta Distribution — pbeta2","title":"The Beta Distribution — pbeta2","text":"Density, distribution function, quantile function random   generation Beta distribution parameters shape1   shape2 (optional non-centrality parameter ncp).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pbeta2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Beta Distribution — pbeta2","text":"","code":"pbeta2(q, prob, kappa, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/pbeta2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Beta Distribution — pbeta2","text":"q vector quantiles prob mean probability (vectorised) kappa coefficient variation. 0 variability 1 maximally variability (vectorised) lower.tail logical; TRUE (default), probabilities P[X<=x] otherwise P[X>x]. log.p logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pbeta2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Beta Distribution — pbeta2","text":"dbeta gives density, pbeta distribution   function, qbeta quantile function, rbeta   generates random deviates. Invalid arguments result return value NaN, warning. length result determined n   rbeta, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/pbeta2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Beta Distribution — pbeta2","text":"","code":"pbeta2(c(0.25,0.5,0.75), 0.5, 0.25) #> [1] 0.0001270637 0.5000000000 0.9998729363"},{"path":"https://ai4ci.github.io/tidyabc/reference/pcgamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Cumulative probability: gamma distribution constrained to have mean > sd — pcgamma","title":"Cumulative probability: gamma distribution constrained to have mean > sd — pcgamma","text":"Density, distribution function, quantile function random   generation Gamma distribution parameters shape   scale.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pcgamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cumulative probability: gamma distribution constrained to have mean > sd — pcgamma","text":"","code":"pcgamma(q, mean, kappa = 1/mean, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/pcgamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cumulative probability: gamma distribution constrained to have mean > sd — pcgamma","text":"q vector quantiles mean mean value true scale (vectorised) kappa coefficient variation. 0 variability 1 maximally variability (vectorised) lower.tail logical; TRUE (default), probabilities P[X<=x] otherwise P[X>x]. log.p logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pcgamma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cumulative probability: gamma distribution constrained to have mean > sd — pcgamma","text":"dgamma gives density,   pgamma gives distribution function,   qgamma gives quantile function,   rgamma generates random deviates. Invalid arguments result return value NaN, warning. length result determined n   rgamma, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/pcgamma.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cumulative probability: gamma distribution constrained to have mean > sd — pcgamma","text":"","code":"pcgamma(seq(0,4,0.25), 2, 0.5) #>  [1] 0.00000000 0.02649902 0.09020401 0.17335853 0.26424112 0.35536421 #>  [7] 0.44217460 0.52212166 0.59399415 0.65745252 0.71270250 0.76027052 #> [13] 0.80085173 0.83520962 0.86411177 0.88829071 0.90842181"},{"path":"https://ai4ci.github.io/tidyabc/reference/pgamma2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Gamma Distribution — pgamma2","title":"The Gamma Distribution — pgamma2","text":"Density, distribution function, quantile function random   generation Gamma distribution parameters shape   scale.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pgamma2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Gamma Distribution — pgamma2","text":"","code":"pgamma2(q, mean, sd = sqrt(mean), lower.tail = TRUE, log.p = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/pgamma2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Gamma Distribution — pgamma2","text":"q vector quantiles mean mean value true scale (vectorised) sd standard deviation true scale (vectorised) lower.tail logical; TRUE (default), probabilities P[X<=x] otherwise P[X>x]. log.p logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pgamma2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Gamma Distribution — pgamma2","text":"dgamma gives density,   pgamma gives distribution function,   qgamma gives quantile function,   rgamma generates random deviates. Invalid arguments result return value NaN, warning. length result determined n   rgamma, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/pgamma2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Gamma Distribution — pgamma2","text":"","code":"pgamma2(seq(0,4,0.25), 2, 1) #>  [1] 0.000000000 0.001751623 0.018988157 0.065642454 0.142876540 0.242423867 #>  [7] 0.352768111 0.463367332 0.566529880 0.657704044 0.734974085 0.798300801 #> [13] 0.848796117 0.888150388 0.918234584 0.940854540 0.957619888"},{"path":"https://ai4ci.github.io/tidyabc/reference/pillar_shaft.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Pillar shaft function — pillar_shaft.dist_fns_list","title":"Pillar shaft function — pillar_shaft.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pillar_shaft.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pillar shaft function — pillar_shaft.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' pillar_shaft(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/pillar_shaft.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pillar shaft function — pillar_shaft.dist_fns_list","text":"x dist_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pillar_shaft.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pillar shaft function — pillar_shaft.dist_fns_list","text":"pillar shaft","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pillar_shaft.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Pillar shaft function — pillar_shaft.link_fns_list","title":"Pillar shaft function — pillar_shaft.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pillar_shaft.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pillar shaft function — pillar_shaft.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' pillar_shaft(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/pillar_shaft.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pillar shaft function — pillar_shaft.link_fns_list","text":"x link_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pillar_shaft.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pillar shaft function — pillar_shaft.link_fns_list","text":"pillar shaft","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://ai4ci.github.io/tidyabc/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plnorm2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Log Normal Distribution — plnorm2","title":"The Log Normal Distribution — plnorm2","text":"Density, distribution function, quantile function random   generation log normal distribution whose logarithm mean   equal meanlog standard deviation equal sdlog.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plnorm2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Log Normal Distribution — plnorm2","text":"","code":"plnorm2(q, mean = 1, sd = sqrt(exp(1) - 1), lower.tail = TRUE, log.p = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/plnorm2.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"The Log Normal Distribution — plnorm2","text":"dlnorm calculated definition (‘Details’).   [pqr]lnorm based relationship normal. Consequently, model single point mass exp(meanlog)   boundary case sdlog = 0.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plnorm2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Log Normal Distribution — plnorm2","text":"q vector quantiles mean mean value true scale (vectorised) sd standard deviation true scale (vectorised) lower.tail logical; TRUE (default), probabilities     \\(P[X \\le x]\\), otherwise, \\(P[X > x]\\). log.p logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plnorm2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Log Normal Distribution — plnorm2","text":"dlnorm gives density,   plnorm gives distribution function,   qlnorm gives quantile function,   rlnorm generates random deviates. length result determined n   rlnorm, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plnorm2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Log Normal Distribution — plnorm2","text":"log normal distribution density   $$     f(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma x} e^{-(\\log(x) - \\mu)^2/2 \\sigma^2}%   $$   \\(\\mu\\) \\(\\sigma\\) mean standard   deviation logarithm.   mean \\(E(X) = exp(\\mu + 1/2 \\sigma^2)\\),   median \\(med(X) = exp(\\mu)\\), variance   \\(Var(X) = exp(2\\mu + \\sigma^2)(exp(\\sigma^2) - 1)\\)   hence coefficient variation   \\(\\sqrt{exp(\\sigma^2) - 1}\\)   approximately \\(\\sigma\\) small (e.g., \\(\\sigma < 1/2\\)).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plnorm2.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"The Log Normal Distribution — plnorm2","text":"cumulative hazard \\(H(t) = - \\log(1 - F(t))\\)   -plnorm(t, r, lower = FALSE, log = TRUE).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plnorm2.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The Log Normal Distribution — plnorm2","text":"Becker, R. ., Chambers, J. M. Wilks, . R. (1988)   New S Language.   Wadsworth & Brooks/Cole. Johnson, N. L., Kotz, S. Balakrishnan, N. (1995)   Continuous Univariate Distributions, volume 1, chapter 14.   Wiley, New York.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/plnorm2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Log Normal Distribution — plnorm2","text":"","code":"plnorm2(seq(0,4,0.25), 2, 1) #>  [1] 0.000000e+00 1.550937e-05 3.482566e-03 3.287216e-02 1.091319e-01 #>  [6] 2.239928e-01 3.546433e-01 4.814610e-01 5.933575e-01 6.863496e-01 #> [11] 7.607047e-01 8.186775e-01 8.631396e-01 8.968813e-01 9.223215e-01 #> [16] 9.414327e-01 9.557664e-01"},{"path":"https://ai4ci.github.io/tidyabc/reference/plogitnorm.html","id":null,"dir":"Reference","previous_headings":"","what":"Logit-normal distribution — plogitnorm","title":"Logit-normal distribution — plogitnorm","text":"logit-normal distribution support 0 1.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plogitnorm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logit-normal distribution — plogitnorm","text":"","code":"plogitnorm(q, meanlogit = 0, sdlogit = 1, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/plogitnorm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logit-normal distribution — plogitnorm","text":"q vector quantiles (0<q<1) meanlogit mean logit scale sdlogit sd logit scale lower.tail logical; TRUE (default), probabilities P[X<=x] otherwise P[X>x]. log.p logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plogitnorm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logit-normal distribution — plogitnorm","text":"vector probabilities, quantiles, densities samples.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plogitnorm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Logit-normal distribution — plogitnorm","text":"","code":"plogitnorm(seq(0.1,0.9,0.1), 0, 1) #> [1] 0.01400221 0.08282852 0.19841456 0.34256783 0.50000000 0.65743217 0.80158544 #> [8] 0.91717148 0.98599779"},{"path":"https://ai4ci.github.io/tidyabc/reference/plogitnorm2.html","id":null,"dir":"Reference","previous_headings":"","what":"Logit-normal distribution — plogitnorm2","title":"Logit-normal distribution — plogitnorm2","text":"logit-normal distribution support 0 1.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plogitnorm2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logit-normal distribution — plogitnorm2","text":"","code":"plogitnorm2(   q,   prob.0.5 = 0.5,   kappa = 1 - exp(-1),   lower.tail = TRUE,   log.p = FALSE )"},{"path":"https://ai4ci.github.io/tidyabc/reference/plogitnorm2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logit-normal distribution — plogitnorm2","text":"q vector quantiles (0<q<1) prob.0.5 median true scale kappa dispersion parameter 0 (none) 1 maximum dispersion lower.tail logical; TRUE (default), probabilities P[X<=x] otherwise P[X>x]. log.p logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plogitnorm2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logit-normal distribution — plogitnorm2","text":"vector probabilities, quantiles, densities samples.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plogitnorm2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Logit-normal distribution — plogitnorm2","text":"","code":"plogitnorm2(seq(0.1,0.9,0.1), 0.75, 0.2) #> [1] 1.143062e-49 4.194162e-29 1.385603e-18 7.897412e-12 4.253902e-07 #> [6] 9.472742e-04 1.300308e-01 9.013399e-01 9.999996e-01 plogitnorm2(qlogitnorm2(seq(0.1,0.9,0.1), 0.75, 0.2), 0.75, 0.2) #> [1] 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9"},{"path":"https://ai4ci.github.io/tidyabc/reference/plot.dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot a dist_fns S3 object — plot.dist_fns","title":"Plot a dist_fns S3 object — plot.dist_fns","text":"Plot dist_fns S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot.dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot a dist_fns S3 object — plot.dist_fns","text":"","code":"# S3 method for class 'dist_fns' plot(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/plot.dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot a dist_fns S3 object — plot.dist_fns","text":"x dist_fns S3 object ... Named arguments passed plot.dist_fns_list x dist_fns_list ... passed ggplot2::geom_step,ggplot2::geom_rect ggplot2::geom_area, mapping override default aesthetics name, id group steps resolution plot tail minimum tail probability plot plot_quantiles default quantiles distribution plotted density sometimes makes hard read smooth default additional smoothing used cover small discontinuities PDF.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot.dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot a dist_fns S3 object — plot.dist_fns","text":"ggplot","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot a dist_fns_list S3 object — plot.dist_fns_list","title":"Plot a dist_fns_list S3 object — plot.dist_fns_list","text":"Plot smoothed version PDFs set dist_fns. ggplots can facetted names, id group","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot a dist_fns_list S3 object — plot.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' plot(   x,   ...,   mapping = .gg_check_for_aes(...),   steps = 200,   tail = 0.001,   plot_quantiles = TRUE,   smooth = TRUE )"},{"path":"https://ai4ci.github.io/tidyabc/reference/plot.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot a dist_fns_list S3 object — plot.dist_fns_list","text":"x dist_fns_list ... passed ggplot2::geom_step,ggplot2::geom_rect ggplot2::geom_area, mapping override default aesthetics name, id group steps resolution plot tail minimum tail probability plot plot_quantiles default quantiles distribution plotted density sometimes makes hard read smooth default additional smoothing used cover small discontinuities PDF.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot a dist_fns_list S3 object — plot.dist_fns_list","text":"ggplot","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_convergence.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot convergence metrics by wave for SMC and adaptive ABC — plot_convergence","title":"Plot convergence metrics by wave for SMC and adaptive ABC — plot_convergence","text":"Plot convergence metrics wave SMC adaptive ABC","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_convergence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot convergence metrics by wave for SMC and adaptive ABC — plot_convergence","text":"","code":"plot_convergence(fit)"},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_convergence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot convergence metrics by wave for SMC and adaptive ABC — plot_convergence","text":"fit S3 abc_fit object output abc_XXX functions","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_convergence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot convergence metrics by wave for SMC and adaptive ABC — plot_convergence","text":"patchwork plot convergence metrics","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_convergence.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot convergence metrics by wave for SMC and adaptive ABC — plot_convergence","text":"","code":"plot_convergence(   example_adaptive_fit() )"},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_correlations.html","id":null,"dir":"Reference","previous_headings":"","what":"A parameter posterior correlation plot — plot_correlations","title":"A parameter posterior correlation plot — plot_correlations","text":"parameter posterior correlation plot","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_correlations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A parameter posterior correlation plot — plot_correlations","text":"","code":"plot_correlations(posteriors_df, truth = NULL)"},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_correlations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A parameter posterior correlation plot — plot_correlations","text":"posteriors_df dataframe posteriors selected ABC may include columns scores, weight /simulation outputs ( abc_component_score, abc_summary_distance, abc_weight, abc_simulation ) well columns matching priors input specification. truth named numeric vector known parameter values","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_correlations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A parameter posterior correlation plot — plot_correlations","text":"patchwork ggplots including density 2d scatters combination posteriors.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_correlations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A parameter posterior correlation plot — plot_correlations","text":"","code":"p = plot_correlations(   example_adaptive_fit(),   example_truth() )  p & ggplot2::theme(   axis.title.y = ggplot2::element_text(angle=70,vjust=0.5),   axis.title.x = ggplot2::element_text(angle=20,hjust=0.5) )"},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_evolution.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the evolution of the density function by wave for SMC and adaptive ABC — plot_evolution","title":"Plot the evolution of the density function by wave for SMC and adaptive ABC — plot_evolution","text":"Plot evolution density function wave SMC adaptive ABC","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_evolution.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the evolution of the density function by wave for SMC and adaptive ABC — plot_evolution","text":"","code":"plot_evolution(fit, truth = NULL, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_evolution.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the evolution of the density function by wave for SMC and adaptive ABC — plot_evolution","text":"fit S3 abc_fit object output abc_XXX functions truth named numeric vector known parameter values ... passed methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_evolution.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the evolution of the density function by wave for SMC and adaptive ABC — plot_evolution","text":"plot density functions wave","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_evolution.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the evolution of the density function by wave for SMC and adaptive ABC — plot_evolution","text":"","code":"plot_evolution(   example_adaptive_fit(),   example_truth() )"},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_simulations.html","id":null,"dir":"Reference","previous_headings":"","what":"Spaghetti plot of resampled posterior fits — plot_simulations","title":"Spaghetti plot of resampled posterior fits — plot_simulations","text":"Spaghetti plot resampled posterior fits","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_simulations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spaghetti plot of resampled posterior fits — plot_simulations","text":"","code":"plot_simulations(obsdata, fit, sim_fn, method = \"auto\", n = 200, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_simulations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Spaghetti plot of resampled posterior fits — plot_simulations","text":"obsdata observational data. data typically named list, anything, e.g. dataframe. reference data simulation model aiming replicate. fit S3 abc_fit object output abc_XXX functions sim_fn user defined function takes set parameters named priors_list. must return simulated data set format obsdata, can compared simdata scorer_fn. function must refer global parameters, automatically crated carrier. method one \"auto\", \"count\", \"density\", named vector one component obsdata. n number simulations plot ... Named arguments passed posterior_resample n_resamples number resamples parameter combination. max_samples maximum total number resamples pick.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_simulations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Spaghetti plot of resampled posterior fits — plot_simulations","text":"patchwork ggplots","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/plot_simulations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Spaghetti plot of resampled posterior fits — plot_simulations","text":"","code":"plot_simulations(   example_obsdata(),   example_adaptive_fit(),   example_sim_fn )"},{"path":"https://ai4ci.github.io/tidyabc/reference/pmap_dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Map over multiple inputs returning a dist_fns_list — pmap_dist_fns","title":"Map over multiple inputs returning a dist_fns_list — pmap_dist_fns","text":"Analogous purrr::pmap_dbl()","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pmap_dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map over multiple inputs returning a dist_fns_list — pmap_dist_fns","text":"","code":"pmap_dist_fns(.l, .f, ..., .progress = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/pmap_dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map over multiple inputs returning a dist_fns_list — pmap_dist_fns","text":".l list vectors. length .l determines number arguments .f called . Arguments supply position unnamed, name named. Vectors length 1 recycled length; elements must length. data frame important special case .l. cause .f called row. .f function apply .l item (usually .dist_fns() call) ... Additional arguments passed mapped function. now generally recommend using ... pass additional (constant) arguments .f. Instead use shorthand anonymous function:   makes easier understand arguments belong function tend yield better error messages. .progress Whether show progress bar. Use TRUE turn basic progress bar, use string give name, see progress_bars details.","code":"# Instead of x |> map(f, 1, 2, collapse = \",\") # do: x |> map(\\(x) f(x, 1, 2, collapse = \",\"))"},{"path":"https://ai4ci.github.io/tidyabc/reference/pmap_dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map over multiple inputs returning a dist_fns_list — pmap_dist_fns","text":"dist_fns_list","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/pmap_link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Map over multiple inputs returning a link_fns_list — pmap_link_fns","title":"Map over multiple inputs returning a link_fns_list — pmap_link_fns","text":"Analogous purrr::pmap_dbl()","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pmap_link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map over multiple inputs returning a link_fns_list — pmap_link_fns","text":"","code":"pmap_link_fns(.l, .f, ..., .progress = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/pmap_link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map over multiple inputs returning a link_fns_list — pmap_link_fns","text":".l list vectors. length .l determines number arguments .f called . Arguments supply position unnamed, name named. Vectors length 1 recycled length; elements must length. data frame important special case .l. cause .f called row. .f function apply .l item (usually .link_fns() call) ... Additional arguments passed mapped function. now generally recommend using ... pass additional (constant) arguments .f. Instead use shorthand anonymous function:   makes easier understand arguments belong function tend yield better error messages. .progress Whether show progress bar. Use TRUE turn basic progress bar, use string give name, see progress_bars details.","code":"# Instead of x |> map(f, 1, 2, collapse = \",\") # do: x |> map(\\(x) f(x, 1, 2, collapse = \",\"))"},{"path":"https://ai4ci.github.io/tidyabc/reference/pmap_link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map over multiple inputs returning a link_fns_list — pmap_link_fns","text":"link_fns_list","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/pnbinom2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Negative Binomial Distribution — pnbinom2","title":"The Negative Binomial Distribution — pnbinom2","text":"Density, distribution function, quantile function random   generation negative binomial distribution parameters   size prob.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pnbinom2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Negative Binomial Distribution — pnbinom2","text":"","code":"pnbinom2(q, mean, sd = sqrt(mean), lower.tail = TRUE, log.p = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/pnbinom2.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"The Negative Binomial Distribution — pnbinom2","text":"dnbinom computes via binomial probabilities, using code   contributed Catherine Loader (see dbinom). pnbinom uses pbeta. qnbinom uses Cornish–Fisher Expansion include skewness   correction normal approximation, followed search. rnbinom uses derivation gamma mixture Poisson   distributions, see Devroye, L. (1986) Non-Uniform Random Variate Generation.   Springer-Verlag, New York. Page 480.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pnbinom2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Negative Binomial Distribution — pnbinom2","text":"q vector quantiles. mean mean value true scale (vectorised) sd standard deviation true scale (vectorised) lower.tail logical; TRUE (default), probabilities     \\(P[X \\le x]\\), otherwise, \\(P[X > x]\\). log.p logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pnbinom2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Negative Binomial Distribution — pnbinom2","text":"dnbinom gives density,   pnbinom gives distribution function,   qnbinom gives quantile function,   rnbinom generates random deviates. Invalid size prob result return value   NaN, warning. length result determined n   rnbinom, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used. rnbinom returns vector type integer unless generated   values exceed maximum representable integer double   values returned.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pnbinom2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Negative Binomial Distribution — pnbinom2","text":"negative binomial distribution size \\(= n\\)   prob \\(= p\\) density   $$     p(x) = \\frac{\\Gamma(x+n)}{\\Gamma(n) x!} p^n (1-p)^x$$   \\(x = 0, 1, 2, \\ldots\\), \\(n > 0\\) \\(0 < p \\le 1\\). represents number failures occur sequence   Bernoulli trials target number successes reached.   mean \\(\\mu = n(1-p)/p\\) variance \\(n(1-p)/p^2\\). negative binomial distribution can also arise mixture   Poisson distributions mean distributed gamma distribution   (see pgamma) scale parameter (1 - prob)/prob   shape parameter size.  (definition allows non-integer   values size.) alternative parametrization (often used ecology)   mean mu (see ), size, dispersion   parameter, prob = size/(size+mu).  variance   mu + mu^2/size parametrization. element x integer, result dnbinom   zero, warning. case size == 0 distribution concentrated zero.   limiting distribution size approaching zero,   even mu rather prob held constant.  Notice   though, mean limit distribution 0, whatever   value mu. quantile defined smallest value \\(x\\)   \\(F(x) \\ge p\\), \\(F\\) distribution function.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/pnbinom2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Negative Binomial Distribution — pnbinom2","text":"","code":"pnbinom2(0:5, 2, sqrt(2)) #> [1] 0.1353353 0.4060058 0.6766764 0.8571235 0.9473470 0.9834364"},{"path":"https://ai4ci.github.io/tidyabc/reference/pnull.html","id":null,"dir":"Reference","previous_headings":"","what":"Null distributions always returns NA — pnull","title":"Null distributions always returns NA — pnull","text":"Null distributions always returns NA","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pnull.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Null distributions always returns NA — pnull","text":"","code":"pnull(q, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/pnull.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Null distributions always returns NA — pnull","text":"q vector quantiles ... used","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pnull.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Null distributions always returns NA — pnull","text":"","code":"pnull(c(0.25,0.5,0.75), 0.5, 0.25) #> [1] NA NA NA"},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_distance_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a set of metrics from component scores — posterior_distance_metrics","title":"Generate a set of metrics from component scores — posterior_distance_metrics","text":"component scores summary statistics output user supplied scorer_fn named list. can variable scale location various options exist combining . may need weighted scale well importance get model works well. weights can input ABC algortihms using scoreweights parameter. function helps provide diagnostics calibrating scoreweights parameter.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_distance_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a set of metrics from component scores — posterior_distance_metrics","text":"","code":"posterior_distance_metrics(posteriors_df, obsscores = NULL, keep_data = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_distance_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a set of metrics from component scores — posterior_distance_metrics","text":"posteriors_df dataframe posteriors selected ABC may include columns scores, weight /simulation outputs ( abc_component_score, abc_summary_distance, abc_weight, abc_simulation ) well columns matching priors input specification. obsscores Summary scores observational data. named list, equivalent output scorer_fn, observed data. given typically assumed zeros. keep_data mainly internal use flag gives component scores matrix","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_distance_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a set of metrics from component scores — posterior_distance_metrics","text":"list containing following items: obsscores: input reference scores component means, sds: means sds score component cov: covariance matrix scores mad: mean absolute differences simscores obsscores rmsd: root mean squared differences simscores obsscores scoreweights: sds divided rmsd. weight mean weights  individual summary scores similar influence overall abc_summary_distance output combined SMC adaptive waves, especially euclidean distances involved. simscores: (keep_data) matrix scores input simulation posteriors deltascores: (keep_data)  matrix differences simscores obsscores.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_distance_metrics.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate a set of metrics from component scores — posterior_distance_metrics","text":"Given list component scores \\(S_s^{()} = (s_1^{()}, \\dots, s_m^{()})\\) \\(n\\) simulations observed scores \\(S_o = (s_1^{(o)}, \\dots, s_m^{(o)})\\), function calculates: mean \\(\\mu_j\\) standard deviation \\(\\sigma_j\\) score component \\(j\\): $$     \\mu_j = \\frac{1}{n}\\sum_{=1}^n s_j^{()}, \\quad     \\sigma_j = \\sqrt{\\frac{1}{n-1}\\sum_{=1}^n (s_j^{()} - \\mu_j)^2}   $$ covariance matrix \\(\\Sigma\\) score components. root mean squared difference (RMSD) simulated observed scores component: $$     \\text{RMSD}_j = \\sqrt{\\frac{1}{n}\\sum_{=1}^n (s_j^{()} - s_j^{(o)})^2}   $$ recommended vector scoreweights \\(w_j\\), calculated ratio component's standard deviation RMSD, normalized sum 1: $$     w_j = \\frac{\\sigma_j / \\text{RMSD}_j}{\\sum_{k=1}^m (\\sigma_k / \\text{RMSD}_k)}   $$ weights help balance influence different summary statistics overall distance metric, especially using Euclidean distance.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_distance_metrics.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a set of metrics from component scores — posterior_distance_metrics","text":"","code":"fit = example_rejection_fit() metrics = posterior_distance_metrics(fit$posteriors) # other elements available: metrics$scoreweights #>         A         B  #> 0.5551078 0.4448922"},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_fit_empirical.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit empirical distribution to posterior samples for generating more waves — posterior_fit_empirical","title":"Fit empirical distribution to posterior samples for generating more waves — posterior_fit_empirical","text":"function allows \"updating\" prior empirical posterior distribution retain bounds prior, effectively spline based transform prior distribution, based density data prior space. gives clean density data close prior distribution limit work better standard density.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_fit_empirical.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit empirical distribution to posterior samples for generating more waves — posterior_fit_empirical","text":"","code":"posterior_fit_empirical(posteriors_df, priors_list, knots = NULL, bw = 0.1)"},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_fit_empirical.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit empirical distribution to posterior samples for generating more waves — posterior_fit_empirical","text":"posteriors_df dataframe posteriors selected ABC may include columns scores, weight /simulation outputs ( abc_component_score, abc_summary_distance, abc_weight, abc_simulation ) well columns matching priors input specification. priors_list named list priors specified abc_prior S3 object (see priors()), can include derived values unnamed 2-sided formulae, LHS formula assigned value RHS, plus optionally set constraints one sided formulae RHS formulae resolve boolean value. knots number knots model CDF . Optional, typically inferred data size. Small numbers tend work better expect distribution unimodal. bw Adaptive ABC data distributions smoothed modelling CDF. smoothing can reduce convergence, -smoothing may result noisy posterior estimates. units ESS defaults 0.1.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_fit_empirical.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit empirical distribution to posterior samples for generating more waves — posterior_fit_empirical","text":"abc_prior S3 object approximating distribution posterior samples, adhering support provided priors.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_fit_empirical.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit empirical distribution to posterior samples for generating more waves — posterior_fit_empirical","text":"takes weighted posterior samples \\(\\{(\\theta^{()}, w^{()})\\}\\) parameter \\(\\theta_j\\) constructs empirical distribution function \\(Q_j(\\theta_j)\\) approximates posterior marginal parameter. parameter \\(\\theta_j\\), empirical distribution \\(Q_j\\) fitted using empirical() function. fitting performed weighted samples \\((\\theta_{j}^{()}, w^{()})\\). key feature use link function \\(h_j(\\cdot)\\) fitting process. link function typically taken original prior distribution \\(P_j(\\theta_j)\\) (.e., \\(h_j = P_j\\)). ensures fitted empirical distribution \\(Q_j\\) respects support constraints defined prior (e.g., positive values log-normal prior). fitting effectively occurs transformed space defined link: \\(h_j(\\theta_j^{()})\\). resulting empirical distribution \\(Q_j\\) dist_fns object includes support constraints original prior. set fitted marginal distributions \\(\\{Q_j\\}\\) forms new proposal list next wave. Additionally, weighted covariance matrix \\(R\\) samples MVN space (defined prior copula) calculated: $$   R = \\text{Cov}_{w}(\\Phi^{-1}(P_1(\\theta_1)), \\dots, \\Phi^{-1}(P_d(\\theta_d))) $$ \\(\\Phi^{-1}\\) quantile function standard normal. covariance matrix stored attribute (\"cor\") returned proposal list used induce correlation structure sampling new proposals empirical distributions subsequent waves.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_fit_empirical.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit empirical distribution to posterior samples for generating more waves — posterior_fit_empirical","text":"","code":"fit = example_smc_fit() proposals = posterior_fit_empirical(fit$posteriors, fit$priors)  proposals #> Parameters:  #> * mean: posterior [4.98 ± 0.03] #> * sd1: posterior [1.99 ± 0.07] #> * sd2: posterior [0.99 ± 0.03] #> Constraints: #> * mean > sd2"},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_resample.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a set of samples from selected posteriors — posterior_resample","title":"Generate a set of samples from selected posteriors — posterior_resample","text":"ABC model fitting complete simulation data generally one possible realisation parameters, selected closeness. properly compare output observed data need set posterior re-samples, selected posteriors according importance.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_resample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a set of samples from selected posteriors — posterior_resample","text":"","code":"posterior_resample(   posteriors_df,   sim_fn,   n_resamples = 1,   seed = NULL,   parallel = FALSE,   max_samples = 200 )"},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_resample.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a set of samples from selected posteriors — posterior_resample","text":"posteriors_df dataframe posteriors selected ABC may include columns scores, weight /simulation outputs ( abc_component_score, abc_summary_distance, abc_weight, abc_simulation ) well columns matching priors input specification. sim_fn user defined function takes set parameters named priors_list. must return simulated data set format obsdata, can compared simdata scorer_fn. function must refer global parameters, automatically crated carrier. n_resamples number resamples parameter combination. seed optional random seed parallel parallelise simulation? set true simulation step parallelised using furrr. make difference must set following: future::plan(future::multisession, workers = parallel::detectCores()-2) max_samples maximum total number resamples pick.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_resample.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a set of samples from selected posteriors — posterior_resample","text":"dataframe posteriors abc_sim list column containing output sim_fn called parameters row.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_resample.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a set of samples from selected posteriors — posterior_resample","text":"","code":"fit = example_adaptive_fit()  sample_df = posterior_resample(   fit$posteriors,   sim_fn = example_sim_fn )  # the fitted simulations are in the `abc_sim` column sim1 = sample_df$abc_sim[[1]]  sim1 %>% lapply(head, 10) #> $A #>  [1] 6.219357 3.019306 5.014118 3.701336 3.322469 4.511440 6.315831 5.058636 #>  [9] 8.167976 4.697854 #>  #> $B #>  [1] 5.669615 6.052935 4.118884 4.131646 4.267825 5.405490 4.433625 5.404898 #>  [9] 4.138371 4.486834 #>"},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_summarise.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate a basket of summaries from a weighted list of posterior samples — posterior_summarise","title":"Calculate a basket of summaries from a weighted list of posterior samples — posterior_summarise","text":"Calculate basket summaries weighted list posterior samples","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_summarise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate a basket of summaries from a weighted list of posterior samples — posterior_summarise","text":"","code":"posterior_summarise(   posteriors_df,   priors_list,   p = c(0.025, 0.05, 0.1, 0.25, 0.5, 0.75, 0.9, 0.95, 0.975) )"},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_summarise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate a basket of summaries from a weighted list of posterior samples — posterior_summarise","text":"posteriors_df dataframe posteriors selected ABC may include columns scores, weight /simulation outputs ( abc_component_score, abc_summary_distance, abc_weight, abc_simulation ) well columns matching priors input specification. priors_list named list priors specified abc_prior S3 object (see priors()), can include derived values unnamed 2-sided formulae, LHS formula assigned value RHS, plus optionally set constraints one sided formulae RHS formulae resolve boolean value. p progressr progress bar","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_summarise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate a basket of summaries from a weighted list of posterior samples — posterior_summarise","text":"dataframe indexed parameter useful summary metrics.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/posterior_summarise.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate a basket of summaries from a weighted list of posterior samples — posterior_summarise","text":"","code":"fit = example_adaptive_fit() summ = posterior_summarise(fit$posteriors, fit$priors)  summ %>% dplyr::glimpse() #> Rows: 3 #> Columns: 9 #> Groups: param [3] #> $ param     <chr> \"mean\", \"sd1\", \"sd2\" #> $ mean      <dbl> 4.964376, 2.123894, 1.139277 #> $ sd        <dbl> 0.1292487, 0.2332786, 0.1733625 #> $ quantiles <list> [<tbl_df[9 x 2]>], [<tbl_df[9 x 2]>], [<tbl_df[9 x 2]>] #> $ q.0.025   <dbl> 4.7174323, 1.5218539, 0.7531816 #> $ q.0.5     <dbl> 4.957561, 2.077933, 1.133596 #> $ q.0.975   <dbl> 5.260754, 2.904667, 1.531218 #> $ density   <distfn[]> [mean; Median (IQR) 4.96 [4.85 — 5.07]], [sd1; Median (IQR) … #> $ ESS       <dbl> 1518.651, 1518.651, 1518.651"},{"path":"https://ai4ci.github.io/tidyabc/reference/print.dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a dist_fns S3 object — print.dist_fns","title":"Print a dist_fns S3 object — print.dist_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/print.dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a dist_fns S3 object — print.dist_fns","text":"","code":"# S3 method for class 'dist_fns' print(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/print.dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a dist_fns S3 object — print.dist_fns","text":"x dist_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/print.dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print a dist_fns S3 object — print.dist_fns","text":"nothing","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/print.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a dist_fns_list — print.dist_fns_list","title":"Print a dist_fns_list — print.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/print.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a dist_fns_list — print.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' print(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/print.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a dist_fns_list — print.dist_fns_list","text":"x dist_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/print.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print a dist_fns_list — print.dist_fns_list","text":"nothing","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/print.link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a link_fns S3 object — print.link_fns","title":"Print a link_fns S3 object — print.link_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/print.link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a link_fns S3 object — print.link_fns","text":"","code":"# S3 method for class 'link_fns' print(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/print.link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a link_fns S3 object — print.link_fns","text":"x link_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/print.link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print a link_fns S3 object — print.link_fns","text":"nothing","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/print.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a link_fns_list — print.link_fns_list","title":"Print a link_fns_list — print.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/print.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a link_fns_list — print.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' print(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/print.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a link_fns_list — print.link_fns_list","text":"x link_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/print.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print a link_fns_list — print.link_fns_list","text":"nothing","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/priors.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct a set of priors — priors","title":"Construct a set of priors — priors","text":"abc_prior S3 objects used hold specification prior intermediate proposal distributions. inputs main abc_...() workflow functions.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/priors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct a set of priors — priors","text":"","code":"priors(...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/priors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct a set of priors — priors","text":"... list formulae. Two sided interpreted distribution derived value specifications. One sided constraints parameters. distribution specified name family statistical distributions parameters: e.g.: x ~ norm(mean=3,sd=2). name matched first hit search path.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/priors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct a set of priors — priors","text":"S3 object class abc_prior contains list dist_fns cor attribute describing correlation derived attribute describing derive values constraints attribute listing constraints params attribute listing names parameters","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/priors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Construct a set of priors — priors","text":"","code":"p = priors(   mean ~ tidyabc::rgamma2(4,2),   sd ~ gamma2(2,1),   shape ~ mean^2 / sd^2,   rate ~ mean / sd^2,   ~ mean > sd )  print(p) #> Parameters:  #> * mean: gamma2(mean = 4, sd = 2) #> * sd: gamma2(mean = 2, sd = 1) #> Constraints: #> * mean > sd #> Derived values: #> * shape = mean^2/sd^2 #> * rate = mean/sd^2  # Plot methods are also provided: if (interactive()) plot(p)  # constraints: p@constraints #> [[1]] #> ~mean > sd #> <environment: 0x566a0bb11538> #>"},{"path":"https://ai4ci.github.io/tidyabc/reference/pwedge.html","id":null,"dir":"Reference","previous_headings":"","what":"Wedge distribution — pwedge","title":"Wedge distribution — pwedge","text":"wedge distribution support 0 1 linear probability density function support.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pwedge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wedge distribution — pwedge","text":"","code":"pwedge(q, a, log.p = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/pwedge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wedge distribution — pwedge","text":"q vector quantiles gradient -2 (left skewed) 2 (right skewed) log.p logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pwedge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wedge distribution — pwedge","text":"vector probabilities, quantiles, densities samples.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pwedge.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Wedge distribution — pwedge","text":"rwedge can combined quantile functions skew standard distributions, introduce correlation weight certain parts distribution.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/pwedge.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wedge distribution — pwedge","text":"","code":"pwedge(seq(0,1,0.1), a=1) #>  [1] 0.5 0.6 0.7 0.8 0.9 1.0 1.1 1.2 1.3 1.4 1.5 dwedge(seq(0,1,0.1), a=1) #>  [1] 0.000 0.055 0.120 0.195 0.280 0.375 0.480 0.595 0.720 0.855 1.000 qwedge(c(0.25,0.5,0.75), a=-1) #> [1] 0.1771243 0.3819660 0.6339746  stats::cor(   stats::qnorm(rwedge(1000, a=2)),   stats::qnorm(rwedge(1000, a=-2)) ) #> [1] 0.04271146"},{"path":"https://ai4ci.github.io/tidyabc/reference/qbeta2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Beta Distribution — qbeta2","title":"The Beta Distribution — qbeta2","text":"Density, distribution function, quantile function random   generation Beta distribution parameters shape1   shape2 (optional non-centrality parameter ncp).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qbeta2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Beta Distribution — qbeta2","text":"","code":"qbeta2(p, prob, kappa, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/qbeta2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Beta Distribution — qbeta2","text":"p vector probabilities prob mean probability (vectorised) kappa coefficient variation. 0 variability 1 maximally variability (vectorised) lower.tail logical; TRUE (default), probabilities P[X<=x] otherwise P[X>x]. log.p logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qbeta2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Beta Distribution — qbeta2","text":"dbeta gives density, pbeta distribution   function, qbeta quantile function, rbeta   generates random deviates. Invalid arguments result return value NaN, warning. length result determined n   rbeta, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/qbeta2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Beta Distribution — qbeta2","text":"","code":"qbeta2(c(0.25,0.5,0.75), 0.5, 0.25) #> [1] 0.4506664 0.5000000 0.5493336"},{"path":"https://ai4ci.github.io/tidyabc/reference/qcgamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile: gamma distribution constrained to have mean > sd — qcgamma","title":"Quantile: gamma distribution constrained to have mean > sd — qcgamma","text":"Density, distribution function, quantile function random   generation Gamma distribution parameters shape   scale.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qcgamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile: gamma distribution constrained to have mean > sd — qcgamma","text":"","code":"qcgamma(p, mean, kappa = 1/mean, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/qcgamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile: gamma distribution constrained to have mean > sd — qcgamma","text":"p vector probabilities mean mean value true scale (vectorised) kappa coefficient variation. 0 variability 1 maximally variability (vectorised) lower.tail logical; TRUE (default), probabilities P[X<=x] otherwise P[X>x]. log.p logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qcgamma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile: gamma distribution constrained to have mean > sd — qcgamma","text":"dgamma gives density,   pgamma gives distribution function,   qgamma gives quantile function,   rgamma generates random deviates. Invalid arguments result return value NaN, warning. length result determined n   rgamma, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/qcgamma.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quantile: gamma distribution constrained to have mean > sd — qcgamma","text":"","code":"qcgamma(c(0.25,0.5,0.75), 2, 0.5) #> [1] 0.9612788 1.6783470 2.6926345"},{"path":"https://ai4ci.github.io/tidyabc/reference/qgamma2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Gamma Distribution — qgamma2","title":"The Gamma Distribution — qgamma2","text":"Density, distribution function, quantile function random   generation Gamma distribution parameters shape   scale.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qgamma2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Gamma Distribution — qgamma2","text":"","code":"qgamma2(p, mean, sd = sqrt(mean), lower.tail = TRUE, log.p = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/qgamma2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Gamma Distribution — qgamma2","text":"p vector probabilities mean mean value true scale (vectorised) sd standard deviation true scale (vectorised) lower.tail logical; TRUE (default), probabilities P[X<=x] otherwise P[X>x]. log.p logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qgamma2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Gamma Distribution — qgamma2","text":"dgamma gives density,   pgamma gives distribution function,   qgamma gives quantile function,   rgamma generates random deviates. Invalid arguments result return value NaN, warning. length result determined n   rgamma, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/qgamma2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Gamma Distribution — qgamma2","text":"","code":"qgamma2(c(0.25,0.5,0.75), 2, 1) #> [1] 1.267660 1.836030 2.554714"},{"path":"https://ai4ci.github.io/tidyabc/reference/qlnorm2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Log Normal Distribution — qlnorm2","title":"The Log Normal Distribution — qlnorm2","text":"Density, distribution function, quantile function random   generation log normal distribution whose logarithm mean   equal meanlog standard deviation equal sdlog.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qlnorm2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Log Normal Distribution — qlnorm2","text":"","code":"qlnorm2(p, mean = 1, sd = sqrt(exp(1) - 1), lower.tail = TRUE, log.p = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/qlnorm2.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"The Log Normal Distribution — qlnorm2","text":"dlnorm calculated definition (‘Details’).   [pqr]lnorm based relationship normal. Consequently, model single point mass exp(meanlog)   boundary case sdlog = 0.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qlnorm2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Log Normal Distribution — qlnorm2","text":"p vector probabilities. mean mean value true scale (vectorised) sd standard deviation true scale (vectorised) lower.tail logical; TRUE (default), probabilities     \\(P[X \\le x]\\), otherwise, \\(P[X > x]\\). log.p logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qlnorm2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Log Normal Distribution — qlnorm2","text":"dlnorm gives density,   plnorm gives distribution function,   qlnorm gives quantile function,   rlnorm generates random deviates. length result determined n   rlnorm, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qlnorm2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Log Normal Distribution — qlnorm2","text":"log normal distribution density   $$     f(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma x} e^{-(\\log(x) - \\mu)^2/2 \\sigma^2}%   $$   \\(\\mu\\) \\(\\sigma\\) mean standard   deviation logarithm.   mean \\(E(X) = exp(\\mu + 1/2 \\sigma^2)\\),   median \\(med(X) = exp(\\mu)\\), variance   \\(Var(X) = exp(2\\mu + \\sigma^2)(exp(\\sigma^2) - 1)\\)   hence coefficient variation   \\(\\sqrt{exp(\\sigma^2) - 1}\\)   approximately \\(\\sigma\\) small (e.g., \\(\\sigma < 1/2\\)).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qlnorm2.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"The Log Normal Distribution — qlnorm2","text":"cumulative hazard \\(H(t) = - \\log(1 - F(t))\\)   -plnorm(t, r, lower = FALSE, log = TRUE).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qlnorm2.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The Log Normal Distribution — qlnorm2","text":"Becker, R. ., Chambers, J. M. Wilks, . R. (1988)   New S Language.   Wadsworth & Brooks/Cole. Johnson, N. L., Kotz, S. Balakrishnan, N. (1995)   Continuous Univariate Distributions, volume 1, chapter 14.   Wiley, New York.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/qlnorm2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Log Normal Distribution — qlnorm2","text":"","code":"qlnorm2(c(0.25,0.5,0.72), 2, 1) #> [1] 1.300774 1.788854 2.355843"},{"path":"https://ai4ci.github.io/tidyabc/reference/qlogitnorm.html","id":null,"dir":"Reference","previous_headings":"","what":"Logit-normal distribution — qlogitnorm","title":"Logit-normal distribution — qlogitnorm","text":"logit-normal distribution support 0 1.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qlogitnorm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logit-normal distribution — qlogitnorm","text":"","code":"qlogitnorm(p, meanlogit = 0, sdlogit = 1, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/qlogitnorm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logit-normal distribution — qlogitnorm","text":"p vector probabilities meanlogit mean logit scale sdlogit sd logit scale lower.tail logical; TRUE (default), probabilities P[X<=x] otherwise P[X>x]. log.p logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qlogitnorm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logit-normal distribution — qlogitnorm","text":"vector probabilities, quantiles, densities samples.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qlogitnorm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Logit-normal distribution — qlogitnorm","text":"","code":"qlogitnorm(c(0.25,0.5,0.75), 0, 1) #> [1] 0.3374922 0.5000000 0.6625078"},{"path":"https://ai4ci.github.io/tidyabc/reference/qlogitnorm2.html","id":null,"dir":"Reference","previous_headings":"","what":"Logit-normal distribution — qlogitnorm2","title":"Logit-normal distribution — qlogitnorm2","text":"logit-normal distribution support 0 1.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qlogitnorm2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logit-normal distribution — qlogitnorm2","text":"","code":"qlogitnorm2(   p,   prob.0.5 = 0.5,   kappa = 1 - exp(-1),   lower.tail = TRUE,   log.p = FALSE )"},{"path":"https://ai4ci.github.io/tidyabc/reference/qlogitnorm2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logit-normal distribution — qlogitnorm2","text":"p vector probabilities prob.0.5 median true scale kappa dispersion parameter 0 (none) 1 maximum dispersion lower.tail logical; TRUE (default), probabilities P[X<=x] otherwise P[X>x]. log.p logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qlogitnorm2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logit-normal distribution — qlogitnorm2","text":"vector probabilities, quantiles, densities samples.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qlogitnorm2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Logit-normal distribution — qlogitnorm2","text":"","code":"qlnorm2(c(0.25,0.5,0.72), 2, 1) #> [1] 1.300774 1.788854 2.355843"},{"path":"https://ai4ci.github.io/tidyabc/reference/qnbinom2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Negative Binomial Distribution — qnbinom2","title":"The Negative Binomial Distribution — qnbinom2","text":"Density, distribution function, quantile function random   generation negative binomial distribution parameters   size prob.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qnbinom2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Negative Binomial Distribution — qnbinom2","text":"","code":"qnbinom2(p, mean, sd = sqrt(mean), lower.tail = TRUE, log.p = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/qnbinom2.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"The Negative Binomial Distribution — qnbinom2","text":"dnbinom computes via binomial probabilities, using code   contributed Catherine Loader (see dbinom). pnbinom uses pbeta. qnbinom uses Cornish–Fisher Expansion include skewness   correction normal approximation, followed search. rnbinom uses derivation gamma mixture Poisson   distributions, see Devroye, L. (1986) Non-Uniform Random Variate Generation.   Springer-Verlag, New York. Page 480.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qnbinom2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Negative Binomial Distribution — qnbinom2","text":"p vector probabilities. mean mean value true scale (vectorised) sd standard deviation true scale (vectorised) lower.tail logical; TRUE (default), probabilities     \\(P[X \\le x]\\), otherwise, \\(P[X > x]\\). log.p logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qnbinom2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Negative Binomial Distribution — qnbinom2","text":"dnbinom gives density,   pnbinom gives distribution function,   qnbinom gives quantile function,   rnbinom generates random deviates. Invalid size prob result return value   NaN, warning. length result determined n   rnbinom, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used. rnbinom returns vector type integer unless generated   values exceed maximum representable integer double   values returned.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qnbinom2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Negative Binomial Distribution — qnbinom2","text":"negative binomial distribution size \\(= n\\)   prob \\(= p\\) density   $$     p(x) = \\frac{\\Gamma(x+n)}{\\Gamma(n) x!} p^n (1-p)^x$$   \\(x = 0, 1, 2, \\ldots\\), \\(n > 0\\) \\(0 < p \\le 1\\). represents number failures occur sequence   Bernoulli trials target number successes reached.   mean \\(\\mu = n(1-p)/p\\) variance \\(n(1-p)/p^2\\). negative binomial distribution can also arise mixture   Poisson distributions mean distributed gamma distribution   (see pgamma) scale parameter (1 - prob)/prob   shape parameter size.  (definition allows non-integer   values size.) alternative parametrization (often used ecology)   mean mu (see ), size, dispersion   parameter, prob = size/(size+mu).  variance   mu + mu^2/size parametrization. element x integer, result dnbinom   zero, warning. case size == 0 distribution concentrated zero.   limiting distribution size approaching zero,   even mu rather prob held constant.  Notice   though, mean limit distribution 0, whatever   value mu. quantile defined smallest value \\(x\\)   \\(F(x) \\ge p\\), \\(F\\) distribution function.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/qnbinom2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Negative Binomial Distribution — qnbinom2","text":"","code":"qnbinom2(c(0.25,0.5,0.75), 5, sqrt(5)) #> [1] 4 6 8"},{"path":"https://ai4ci.github.io/tidyabc/reference/qnull.html","id":null,"dir":"Reference","previous_headings":"","what":"Null distributions always returns NA — qnull","title":"Null distributions always returns NA — qnull","text":"Null distributions always returns NA","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qnull.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Null distributions always returns NA — qnull","text":"","code":"qnull(p, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/qnull.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Null distributions always returns NA — qnull","text":"p vector probabilities ... used","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qnull.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Null distributions always returns NA — qnull","text":"","code":"qnull(c(0.25,0.5,0.75), 0.5, 0.25) #> [1] NA NA NA"},{"path":"https://ai4ci.github.io/tidyabc/reference/qwedge.html","id":null,"dir":"Reference","previous_headings":"","what":"Wedge distribution — qwedge","title":"Wedge distribution — qwedge","text":"wedge distribution support 0 1 linear probability density function support.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qwedge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wedge distribution — qwedge","text":"","code":"qwedge(p, a, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/qwedge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wedge distribution — qwedge","text":"p vector probabilities gradient -2 (left skewed) 2 (right skewed) lower.tail logical; TRUE (default), probabilities P[X<=x] otherwise P[X>x]. log.p logical; TRUE, probabilities p given log(p).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qwedge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wedge distribution — qwedge","text":"vector probabilities, quantiles, densities samples.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qwedge.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Wedge distribution — qwedge","text":"rwedge can combined quantile functions skew standard distributions, introduce correlation weight certain parts distribution.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/qwedge.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wedge distribution — qwedge","text":"","code":"pwedge(seq(0,1,0.1), a=1) #>  [1] 0.5 0.6 0.7 0.8 0.9 1.0 1.1 1.2 1.3 1.4 1.5 dwedge(seq(0,1,0.1), a=1) #>  [1] 0.000 0.055 0.120 0.195 0.280 0.375 0.480 0.595 0.720 0.855 1.000 qwedge(c(0.25,0.5,0.75), a=-1) #> [1] 0.1771243 0.3819660 0.6339746  stats::cor(   stats::qnorm(rwedge(1000, a=2)),   stats::qnorm(rwedge(1000, a=-2)) ) #> [1] 0.0165249"},{"path":"https://ai4ci.github.io/tidyabc/reference/rbern.html","id":null,"dir":"Reference","previous_headings":"","what":"A random Bernoulli sample as a logical value — rbern","title":"A random Bernoulli sample as a logical value — rbern","text":"random Bernoulli sample logical value","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rbern.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A random Bernoulli sample as a logical value — rbern","text":"","code":"rbern(n, prob)"},{"path":"https://ai4ci.github.io/tidyabc/reference/rbern.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A random Bernoulli sample as a logical value — rbern","text":"n number observations prob mean probability (vectorised)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rbern.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A random Bernoulli sample as a logical value — rbern","text":"vector logical values size n","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rbern.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A random Bernoulli sample as a logical value — rbern","text":"","code":"table(rbern(100, 0.25)) #>  #> FALSE  TRUE  #>    80    20"},{"path":"https://ai4ci.github.io/tidyabc/reference/rbeta2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Beta Distribution — rbeta2","title":"The Beta Distribution — rbeta2","text":"Density, distribution function, quantile function random   generation Beta distribution parameters shape1   shape2 (optional non-centrality parameter ncp).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rbeta2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Beta Distribution — rbeta2","text":"","code":"rbeta2(n, prob, kappa)"},{"path":"https://ai4ci.github.io/tidyabc/reference/rbeta2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Beta Distribution — rbeta2","text":"n number observations prob mean probability (vectorised) kappa coefficient variation. 0 variability 1 maximally variability (vectorised)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rbeta2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Beta Distribution — rbeta2","text":"dbeta gives density, pbeta distribution   function, qbeta quantile function, rbeta   generates random deviates. Invalid arguments result return value NaN, warning. length result determined n   rbeta, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/rbeta2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Beta Distribution — rbeta2","text":"","code":"rbeta2(3, c(0.1,0.5,0.9),0.1) #> [1] 0.1042510 0.4718686 0.8993391"},{"path":"https://ai4ci.github.io/tidyabc/reference/rcategorical.html","id":null,"dir":"Reference","previous_headings":"","what":"Sampling from the multinomial equivalent of the Bernoulli distribution — rcategorical","title":"Sampling from the multinomial equivalent of the Bernoulli distribution — rcategorical","text":"Sampling multinomial equivalent Bernoulli distribution","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rcategorical.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sampling from the multinomial equivalent of the Bernoulli distribution — rcategorical","text":"","code":"rcategorical(n, prob, factor = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/rcategorical.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sampling from the multinomial equivalent of the Bernoulli distribution — rcategorical","text":"n sample size prob (optionally named) vector probabilities normalised sum 1 factor FALSE factor levels either taken names prob first, character vector .","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rcategorical.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sampling from the multinomial equivalent of the Bernoulli distribution — rcategorical","text":"vector random class labels length n. Labels come names prob character vector factor.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rcategorical.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sampling from the multinomial equivalent of the Bernoulli distribution — rcategorical","text":"","code":"prob = c(\"one\"=0.1,\"two\"=0.2,\"seven\"=0.7) table(rcategorical(1000,prob)) #>  #>   one seven   two  #>    91   692   217  rcategorical(10,prob,factor=TRUE) #>  [1] seven seven seven seven seven seven seven seven seven two   #> Levels: one two seven rcategorical(10,rep(1,26),factor=letters) #>  [1] d b x j h p g a o n #> Levels: a b c d e f g h i j k l m n o p q r s t u v w x y z"},{"path":"https://ai4ci.github.io/tidyabc/reference/rcgamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Sampling: gamma distribution constrained to have mean > sd — rcgamma","title":"Sampling: gamma distribution constrained to have mean > sd — rcgamma","text":"Density, distribution function, quantile function random   generation Gamma distribution parameters shape   scale.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rcgamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sampling: gamma distribution constrained to have mean > sd — rcgamma","text":"","code":"rcgamma(n, mean, kappa = 1/mean)"},{"path":"https://ai4ci.github.io/tidyabc/reference/rcgamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sampling: gamma distribution constrained to have mean > sd — rcgamma","text":"n number observations mean mean value true scale (vectorised) kappa coefficient variation. 0 variability 1 maximally variability (vectorised)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rcgamma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sampling: gamma distribution constrained to have mean > sd — rcgamma","text":"dgamma gives density,   pgamma gives distribution function,   qgamma gives quantile function,   rgamma generates random deviates. Invalid arguments result return value NaN, warning. length result determined n   rgamma, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/rcgamma.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sampling: gamma distribution constrained to have mean > sd — rcgamma","text":"","code":"rcgamma(10, 2, 0.5) #>  [1] 0.7464527 2.4585756 3.2335808 2.1612793 0.7633470 0.7181991 2.8403559 #>  [8] 1.2380553 6.6017349 0.2844472"},{"path":"https://ai4ci.github.io/tidyabc/reference/rep.dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Repeat an dist_fns S3 object — rep.dist_fns","title":"Repeat an dist_fns S3 object — rep.dist_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rep.dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Repeat an dist_fns S3 object — rep.dist_fns","text":"","code":"# S3 method for class 'dist_fns' rep(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/rep.dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Repeat an dist_fns S3 object — rep.dist_fns","text":"x dist_fns S3 object ... Named arguments passed base::rep ... arguments passed methods.     internal default method can include: times integer-valued vector giving \t(non-negative) number times repeat element \tlength length(x), repeat whole vector \tlength 1.  Negative NA values error.  \tdouble vector accepted, inputs coerced \tinteger double vector. length.non-negative integer.  desired length         output vector.  inputs coerced double \tvector first element taken.  Ignored NA invalid. non-negative integer.  element x \trepeated times.  inputs coerced \tinteger double vector first element taken.  Treated \t1 NA invalid.  times,length.see ... .","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rep.dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Repeat an dist_fns S3 object — rep.dist_fns","text":"dist_fns_list","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rep.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Repeat a dist_fns_list — rep.dist_fns_list","title":"Repeat a dist_fns_list — rep.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rep.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Repeat a dist_fns_list — rep.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' rep(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/rep.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Repeat a dist_fns_list — rep.dist_fns_list","text":"x dist_fns_list S3 object ... Named arguments passed base::rep ... arguments passed methods.     internal default method can include: times integer-valued vector giving \t(non-negative) number times repeat element \tlength length(x), repeat whole vector \tlength 1.  Negative NA values error.  \tdouble vector accepted, inputs coerced \tinteger double vector. length.non-negative integer.  desired length         output vector.  inputs coerced double \tvector first element taken.  Ignored NA invalid. non-negative integer.  element x \trepeated times.  inputs coerced \tinteger double vector first element taken.  Treated \t1 NA invalid.  times,length.see ... .","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rep.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Repeat a dist_fns_list — rep.dist_fns_list","text":"dist_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rep.link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Repeat an link_fns S3 object — rep.link_fns","title":"Repeat an link_fns S3 object — rep.link_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rep.link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Repeat an link_fns S3 object — rep.link_fns","text":"","code":"# S3 method for class 'link_fns' rep(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/rep.link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Repeat an link_fns S3 object — rep.link_fns","text":"x link_fns S3 object ... Named arguments passed base::rep ... arguments passed methods.     internal default method can include: times integer-valued vector giving \t(non-negative) number times repeat element \tlength length(x), repeat whole vector \tlength 1.  Negative NA values error.  \tdouble vector accepted, inputs coerced \tinteger double vector. length.non-negative integer.  desired length         output vector.  inputs coerced double \tvector first element taken.  Ignored NA invalid. non-negative integer.  element x \trepeated times.  inputs coerced \tinteger double vector first element taken.  Treated \t1 NA invalid.  times,length.see ... .","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rep.link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Repeat an link_fns S3 object — rep.link_fns","text":"link_fns_list","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rep.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Repeat a link_fns_list — rep.link_fns_list","title":"Repeat a link_fns_list — rep.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rep.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Repeat a link_fns_list — rep.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' rep(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/rep.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Repeat a link_fns_list — rep.link_fns_list","text":"x link_fns_list S3 object ... Named arguments passed base::rep ... arguments passed methods.     internal default method can include: times integer-valued vector giving \t(non-negative) number times repeat element \tlength length(x), repeat whole vector \tlength 1.  Negative NA values error.  \tdouble vector accepted, inputs coerced \tinteger double vector. length.non-negative integer.  desired length         output vector.  inputs coerced double \tvector first element taken.  Ignored NA invalid. non-negative integer.  element x \trepeated times.  inputs coerced \tinteger double vector first element taken.  Treated \t1 NA invalid.  times,length.see ... .","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rep.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Repeat a link_fns_list — rep.link_fns_list","text":"link_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/reparam-dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Re-parametrised distributions — reparam-dist","title":"Re-parametrised distributions — reparam-dist","text":"Re-parametrised distributions","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/reparam-dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Re-parametrised distributions — reparam-dist","text":"n number observations x vector quantiles q vector quantiles p vector probabilities log logical; TRUE, probabilities p given log(p). log.p logical; TRUE, probabilities p given log(p). lower.tail logical; TRUE (default), probabilities P[X<=x] otherwise P[X>x]. prob mean probability (vectorised) prob.0.5 median probability (vectorised) kappa coefficient variation. 0 variability 1 maximally variability (vectorised) mean mean value true scale (vectorised) sd standard deviation true scale (vectorised) ... used","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rexpgrowth.html","id":null,"dir":"Reference","previous_headings":"","what":"Randomly sample incident times in an exponentially growing process — rexpgrowth","title":"Randomly sample incident times in an exponentially growing process — rexpgrowth","text":"Randomly sample incident times exponentially growing process","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rexpgrowth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Randomly sample incident times in an exponentially growing process — rexpgrowth","text":"","code":"rexpgrowth(n, r, t_end, t_start = 0)"},{"path":"https://ai4ci.github.io/tidyabc/reference/rexpgrowth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Randomly sample incident times in an exponentially growing process — rexpgrowth","text":"n number items sample r exponential growth rate (per unit time) t_end end observation period t_start start observation period","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rexpgrowth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Randomly sample incident times in an exponentially growing process — rexpgrowth","text":"vector n samples exponential growth process","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rexpgrowth.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Randomly sample incident times in an exponentially growing process — rexpgrowth","text":"","code":"graphics::hist(rexpgrowth(1000,0.1,40), breaks=40)  graphics::hist(rexpgrowth(1000,-0.1,40), breaks=40)"},{"path":"https://ai4ci.github.io/tidyabc/reference/rexpgrowthI0.html","id":null,"dir":"Reference","previous_headings":"","what":"Randomly sample incident times in an exponentially growing process with initial case load — rexpgrowthI0","title":"Randomly sample incident times in an exponentially growing process with initial case load — rexpgrowthI0","text":"Randomly sample incident times exponentially growing process initial case load","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rexpgrowthI0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Randomly sample incident times in an exponentially growing process with initial case load — rexpgrowthI0","text":"","code":"rexpgrowthI0(I0, r, t_end, t_start = 0)"},{"path":"https://ai4ci.github.io/tidyabc/reference/rexpgrowthI0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Randomly sample incident times in an exponentially growing process with initial case load — rexpgrowthI0","text":"I0 expected number cases observed first day r exponential growth rate (per unit time) t_end end observation period t_start start observation period","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rexpgrowthI0.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Randomly sample incident times in an exponentially growing process with initial case load — rexpgrowthI0","text":"vector n samples exponential growth process","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rexpgrowthI0.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Randomly sample incident times in an exponentially growing process with initial case load — rexpgrowthI0","text":"","code":"graphics::hist(rexpgrowthI0(10,0.1,20), breaks=40)  graphics::hist(rexpgrowthI0(1000,-0.1,40), breaks=40)"},{"path":"https://ai4ci.github.io/tidyabc/reference/rgamma2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Gamma Distribution — rgamma2","title":"The Gamma Distribution — rgamma2","text":"Density, distribution function, quantile function random   generation Gamma distribution parameters shape   scale.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rgamma2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Gamma Distribution — rgamma2","text":"","code":"rgamma2(n, mean, sd = sqrt(mean))"},{"path":"https://ai4ci.github.io/tidyabc/reference/rgamma2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Gamma Distribution — rgamma2","text":"n number observations mean mean value true scale (vectorised) sd standard deviation true scale (vectorised)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rgamma2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Gamma Distribution — rgamma2","text":"dgamma gives density,   pgamma gives distribution function,   qgamma gives quantile function,   rgamma generates random deviates. Invalid arguments result return value NaN, warning. length result determined n   rgamma, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/rgamma2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Gamma Distribution — rgamma2","text":"","code":"rgamma2(10, 2, 1) #>  [1] 1.0671590 0.8725670 3.4982906 2.3508021 2.8209902 0.6902277 1.7815886 #>  [8] 2.4537780 2.1258708 3.7931084"},{"path":"https://ai4ci.github.io/tidyabc/reference/rlnorm2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Log Normal Distribution — rlnorm2","title":"The Log Normal Distribution — rlnorm2","text":"Density, distribution function, quantile function random   generation log normal distribution whose logarithm mean   equal meanlog standard deviation equal sdlog.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rlnorm2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Log Normal Distribution — rlnorm2","text":"","code":"rlnorm2(n, mean = 1, sd = sqrt(exp(1) - 1))"},{"path":"https://ai4ci.github.io/tidyabc/reference/rlnorm2.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"The Log Normal Distribution — rlnorm2","text":"dlnorm calculated definition (‘Details’).   [pqr]lnorm based relationship normal. Consequently, model single point mass exp(meanlog)   boundary case sdlog = 0.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rlnorm2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Log Normal Distribution — rlnorm2","text":"n number observations. length(n) > 1, length     taken number required. mean mean value true scale (vectorised) sd standard deviation true scale (vectorised)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rlnorm2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Log Normal Distribution — rlnorm2","text":"dlnorm gives density,   plnorm gives distribution function,   qlnorm gives quantile function,   rlnorm generates random deviates. length result determined n   rlnorm, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rlnorm2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Log Normal Distribution — rlnorm2","text":"log normal distribution density   $$     f(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma x} e^{-(\\log(x) - \\mu)^2/2 \\sigma^2}%   $$   \\(\\mu\\) \\(\\sigma\\) mean standard   deviation logarithm.   mean \\(E(X) = exp(\\mu + 1/2 \\sigma^2)\\),   median \\(med(X) = exp(\\mu)\\), variance   \\(Var(X) = exp(2\\mu + \\sigma^2)(exp(\\sigma^2) - 1)\\)   hence coefficient variation   \\(\\sqrt{exp(\\sigma^2) - 1}\\)   approximately \\(\\sigma\\) small (e.g., \\(\\sigma < 1/2\\)).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rlnorm2.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"The Log Normal Distribution — rlnorm2","text":"cumulative hazard \\(H(t) = - \\log(1 - F(t))\\)   -plnorm(t, r, lower = FALSE, log = TRUE).","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rlnorm2.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The Log Normal Distribution — rlnorm2","text":"Becker, R. ., Chambers, J. M. Wilks, . R. (1988)   New S Language.   Wadsworth & Brooks/Cole. Johnson, N. L., Kotz, S. Balakrishnan, N. (1995)   Continuous Univariate Distributions, volume 1, chapter 14.   Wiley, New York.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/rlnorm2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Log Normal Distribution — rlnorm2","text":"","code":"rlnorm2(10, 2, 1) #>  [1] 1.341512 1.506114 1.049974 3.110086 1.990619 1.217076 2.555225 2.178959 #>  [9] 1.575419 1.264252"},{"path":"https://ai4ci.github.io/tidyabc/reference/rlogitnorm.html","id":null,"dir":"Reference","previous_headings":"","what":"Logit-normal distribution — rlogitnorm","title":"Logit-normal distribution — rlogitnorm","text":"logit-normal distribution support 0 1.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rlogitnorm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logit-normal distribution — rlogitnorm","text":"","code":"rlogitnorm(n, meanlogit = 0, sdlogit = 1)"},{"path":"https://ai4ci.github.io/tidyabc/reference/rlogitnorm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logit-normal distribution — rlogitnorm","text":"n number observations meanlogit mean logit scale sdlogit sd logit scale","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rlogitnorm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logit-normal distribution — rlogitnorm","text":"vector probabilities, quantiles, densities samples.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rlogitnorm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Logit-normal distribution — rlogitnorm","text":"","code":"rlogitnorm(10, 0, 1) #>  [1] 0.2523565 0.3592547 0.2030717 0.6602649 0.7783076 0.7992848 0.3085951 #>  [8] 0.7512198 0.7351616 0.7278198"},{"path":"https://ai4ci.github.io/tidyabc/reference/rlogitnorm2.html","id":null,"dir":"Reference","previous_headings":"","what":"Logit-normal distribution — rlogitnorm2","title":"Logit-normal distribution — rlogitnorm2","text":"logit-normal distribution support 0 1.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rlogitnorm2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logit-normal distribution — rlogitnorm2","text":"","code":"rlogitnorm2(n, prob.0.5 = 0.5, kappa = 1 - exp(-1))"},{"path":"https://ai4ci.github.io/tidyabc/reference/rlogitnorm2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logit-normal distribution — rlogitnorm2","text":"n number observations prob.0.5 median true scale kappa dispersion parameter 0 (none) 1 maximum dispersion","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rlogitnorm2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logit-normal distribution — rlogitnorm2","text":"vector probabilities, quantiles, densities samples.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rlogitnorm2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Logit-normal distribution — rlogitnorm2","text":"","code":"mean(rlogitnorm2(10000,0.75,0.2)) #> [1] 0.7482138"},{"path":"https://ai4ci.github.io/tidyabc/reference/rnbinom2.html","id":null,"dir":"Reference","previous_headings":"","what":"The Negative Binomial Distribution — rnbinom2","title":"The Negative Binomial Distribution — rnbinom2","text":"Density, distribution function, quantile function random   generation negative binomial distribution parameters   size prob.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rnbinom2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Negative Binomial Distribution — rnbinom2","text":"","code":"rnbinom2(n, mean, sd = sqrt(mean))"},{"path":"https://ai4ci.github.io/tidyabc/reference/rnbinom2.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"The Negative Binomial Distribution — rnbinom2","text":"dnbinom computes via binomial probabilities, using code   contributed Catherine Loader (see dbinom). pnbinom uses pbeta. qnbinom uses Cornish–Fisher Expansion include skewness   correction normal approximation, followed search. rnbinom uses derivation gamma mixture Poisson   distributions, see Devroye, L. (1986) Non-Uniform Random Variate Generation.   Springer-Verlag, New York. Page 480.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rnbinom2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Negative Binomial Distribution — rnbinom2","text":"n number observations.  length(n) > 1, length     taken number required. mean mean value true scale (vectorised) sd standard deviation true scale (vectorised)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rnbinom2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Negative Binomial Distribution — rnbinom2","text":"dnbinom gives density,   pnbinom gives distribution function,   qnbinom gives quantile function,   rnbinom generates random deviates. Invalid size prob result return value   NaN, warning. length result determined n   rnbinom, maximum lengths   numerical arguments functions. numerical arguments n recycled   length result.  first elements logical   arguments used. rnbinom returns vector type integer unless generated   values exceed maximum representable integer double   values returned.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rnbinom2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Negative Binomial Distribution — rnbinom2","text":"negative binomial distribution size \\(= n\\)   prob \\(= p\\) density   $$     p(x) = \\frac{\\Gamma(x+n)}{\\Gamma(n) x!} p^n (1-p)^x$$   \\(x = 0, 1, 2, \\ldots\\), \\(n > 0\\) \\(0 < p \\le 1\\). represents number failures occur sequence   Bernoulli trials target number successes reached.   mean \\(\\mu = n(1-p)/p\\) variance \\(n(1-p)/p^2\\). negative binomial distribution can also arise mixture   Poisson distributions mean distributed gamma distribution   (see pgamma) scale parameter (1 - prob)/prob   shape parameter size.  (definition allows non-integer   values size.) alternative parametrization (often used ecology)   mean mu (see ), size, dispersion   parameter, prob = size/(size+mu).  variance   mu + mu^2/size parametrization. element x integer, result dnbinom   zero, warning. case size == 0 distribution concentrated zero.   limiting distribution size approaching zero,   even mu rather prob held constant.  Notice   though, mean limit distribution 0, whatever   value mu. quantile defined smallest value \\(x\\)   \\(F(x) \\ge p\\), \\(F\\) distribution function.","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/rnbinom2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Negative Binomial Distribution — rnbinom2","text":"","code":"rnbinom2(10, 5, sqrt(5)) #>  [1]  4  4  7  9  6  7  6  4  5 10"},{"path":"https://ai4ci.github.io/tidyabc/reference/rnull.html","id":null,"dir":"Reference","previous_headings":"","what":"Null distributions always returns NA — rnull","title":"Null distributions always returns NA — rnull","text":"Null distributions always returns NA","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rnull.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Null distributions always returns NA — rnull","text":"","code":"rnull(n, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/rnull.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Null distributions always returns NA — rnull","text":"n number observations ... used","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rnull.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Null distributions always returns NA — rnull","text":"","code":"rnull(3, c(0.1,0.5,0.9),0.1) #> [1] NA NA NA"},{"path":"https://ai4ci.github.io/tidyabc/reference/rwedge.html","id":null,"dir":"Reference","previous_headings":"","what":"Wedge distribution — rwedge","title":"Wedge distribution — rwedge","text":"wedge distribution support 0 1 linear probability density function support.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rwedge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wedge distribution — rwedge","text":"","code":"rwedge(n, a)"},{"path":"https://ai4ci.github.io/tidyabc/reference/rwedge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wedge distribution — rwedge","text":"n number observations gradient -2 (left skewed) 2 (right skewed)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rwedge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wedge distribution — rwedge","text":"vector probabilities, quantiles, densities samples.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rwedge.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Wedge distribution — rwedge","text":"rwedge can combined quantile functions skew standard distributions, introduce correlation weight certain parts distribution.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/rwedge.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wedge distribution — rwedge","text":"","code":"pwedge(seq(0,1,0.1), a=1) #>  [1] 0.5 0.6 0.7 0.8 0.9 1.0 1.1 1.2 1.3 1.4 1.5 dwedge(seq(0,1,0.1), a=1) #>  [1] 0.000 0.055 0.120 0.195 0.280 0.375 0.480 0.595 0.720 0.855 1.000 qwedge(c(0.25,0.5,0.75), a=-1) #> [1] 0.1771243 0.3819660 0.6339746  stats::cor(   stats::qnorm(rwedge(1000, a=2)),   stats::qnorm(rwedge(1000, a=-2)) ) #> [1] -0.01565169"},{"path":"https://ai4ci.github.io/tidyabc/reference/s3_dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a dist_fns S3 object — s3_dist_fns","title":"Create a dist_fns S3 object — s3_dist_fns","text":"class wrapping single (set) parametrised distributions provides access quantile, cumulative probability random functions specific distribution. Parametrisation handled construction.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/s3_dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a dist_fns S3 object — s3_dist_fns","text":"x dist_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/s3_dist_fns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a dist_fns S3 object — s3_dist_fns","text":"dist_fns dist_fns_list objects support $ access fields @ access attributes. dist_fns_lists can made c() rep() functions, purrr style map functions, support subsetting. Individual dist_fns members dist_fns_lists can accessed [[.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/s3_dist_fns_common.html","id":null,"dir":"Reference","previous_headings":"","what":"dist_fns S3 Class operations — s3_dist_fns_common","title":"dist_fns S3 Class operations — s3_dist_fns_common","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/s3_dist_fns_common.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"dist_fns S3 Class operations — s3_dist_fns_common","text":"x dist_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/s3_dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Manipulate dist_fns S3 object lists — s3_dist_fns_list","title":"Manipulate dist_fns S3 object lists — s3_dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/s3_dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Manipulate dist_fns S3 object lists — s3_dist_fns_list","text":"x dist_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/s3_link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a link_fns S3 object — s3_link_fns","title":"Create a link_fns S3 object — s3_link_fns","text":"link function class allows forwards backwards transformation. Link functions can defined name using statistical distribution case forward link logit cumulative probability reverse quantile expit.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/s3_link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a link_fns S3 object — s3_link_fns","text":"x link_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/s3_link_fns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a link_fns S3 object — s3_link_fns","text":"link_fns S3 object encapsulates monotonic transformation function \\(h\\), inverse \\(h^{-1}\\), derivatives \\(h'\\) \\((h^{-1})'\\). also defines support (domain) \\([, b]\\) original space range \\([h(), h(b)]\\) transformed space. function dispatches based input x: character: Selects standard links (e.g., \"log\", \"logit\", \"probit\", \"identity\"). example, \"log\" defines \\(h(x) = \\log(x)\\) support \\((0, \\infty)\\). dist_fns: Defines link logit CDF quantile expit: \\(h(x) = \\text{logit}(F(x))\\), \\(h^{-1}(z) = F^{-1}(\\text{expit}(z))\\), \\(F\\) \\(F^{-1}\\) CDF quantile functions dist_fns object. support determined quantile function's range (e.g., \\([Q(0), Q(1)]\\)). family (stats): Uses link function inverse GLM family object. numeric: length 2, interprets support range \\([, b]\\) creates logit-like transformation mapping range \\((-\\infty, \\infty)\\): \\(h(x) = \\text{logit}(\\frac{x-}{b-})\\). values finite length > 2, creates standardization link: \\(h(x) = \\frac{x-\\mu}{\\sigma}\\), \\(\\mu\\) \\(\\sigma\\) mean standard deviation input vector.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/s3_link_fns_common.html","id":null,"dir":"Reference","previous_headings":"","what":"link_fns S3 Class operations — s3_link_fns_common","title":"link_fns S3 Class operations — s3_link_fns_common","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/s3_link_fns_common.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"link_fns S3 Class operations — s3_link_fns_common","text":"x link_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/s3_link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Manipulate link_fns S3 object lists — s3_link_fns_list","title":"Manipulate link_fns S3 object lists — s3_link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/s3_link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Manipulate link_fns S3 object lists — s3_link_fns_list","text":"x link_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sigmoid_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Sigmoid functions — sigmoid_params","title":"Sigmoid functions — sigmoid_params","text":"Sigmoid functions","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sigmoid_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sigmoid functions — sigmoid_params","text":"n vector lengths n_50 size 50 percent n_01 size 1 percent, limit returned p value \\(p \\times n \\ge n_{01}\\) n_100 offset value 1 (default 0) p_max maximum value n <= n_100","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/skew.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the skew of a set of data — skew","title":"Calculate the skew of a set of data — skew","text":"Calculate skew set data","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/skew.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the skew of a set of data — skew","text":"","code":"skew(x, na.rm = FALSE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/skew.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the skew of a set of data — skew","text":"x vector observations na.rm remove NAs?","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/skew.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the skew of a set of data — skew","text":"skew","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/skew.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the skew of a set of data — skew","text":"","code":"skew(stats::rnorm(1000)) #> [1] 0.008772958 skew(stats::rbeta(1000, 1, 8)) # positively (left) skewed #> [1] 1.38873 skew(stats::rbeta(1000, 8, 1)) # negatively (right) skewed #> [1] -1.481538  skew(stats::rlnorm(1000)) #> [1] 4.988768"},{"path":"https://ai4ci.github.io/tidyabc/reference/sort.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Sort a dist_fns_list — sort.dist_fns_list","title":"Sort a dist_fns_list — sort.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sort.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sort a dist_fns_list — sort.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' sort(x, decreasing = FALSE, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/sort.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sort a dist_fns_list — sort.dist_fns_list","text":"x dist_fns_list S3 object decreasing reverse sort order ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sort.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sort a dist_fns_list — sort.dist_fns_list","text":"ordered dist_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sort.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Sort a link_fns_list — sort.link_fns_list","title":"Sort a link_fns_list — sort.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sort.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sort a link_fns_list — sort.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' sort(x, decreasing = FALSE, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/sort.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sort a link_fns_list — sort.link_fns_list","text":"x link_fns_list S3 object decreasing reverse sort order ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sort.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sort a link_fns_list — sort.link_fns_list","text":"ordered link_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset a dist_fns_list — [.dist_fns_list","title":"Subset a dist_fns_list — [.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subset a dist_fns_list — [.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' x[...]"},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset a dist_fns_list — [.dist_fns_list","text":"x dist_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subset a dist_fns_list — [.dist_fns_list","text":"dist_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset a link_fns_list — [.link_fns_list","title":"Subset a link_fns_list — [.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subset a link_fns_list — [.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' x[...]"},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset a link_fns_list — [.link_fns_list","text":"x link_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subset a link_fns_list — [.link_fns_list","text":"link_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-sub-.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"get a value from a dist_fns_list — [[.dist_fns_list","title":"get a value from a dist_fns_list — [[.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-sub-.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get a value from a dist_fns_list — [[.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' x[[...]]"},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-sub-.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get a value from a dist_fns_list — [[.dist_fns_list","text":"x dist_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-sub-.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get a value from a dist_fns_list — [[.dist_fns_list","text":"dist_fns S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-sub-.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"get a value from a link_fns_list — [[.link_fns_list","title":"get a value from a link_fns_list — [[.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-sub-.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get a value from a link_fns_list — [[.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' x[[...]]"},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-sub-.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get a value from a link_fns_list — [[.link_fns_list","text":"x link_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-sub-.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get a value from a link_fns_list — [[.link_fns_list","text":"link_fns S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-subset-.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"set a single value in a dist_fns_list — [[<-.dist_fns_list","title":"set a single value in a dist_fns_list — [[<-.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-subset-.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"set a single value in a dist_fns_list — [[<-.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' x[[...]] <- value"},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-subset-.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"set a single value in a dist_fns_list — [[<-.dist_fns_list","text":"x dist_fns_list S3 object ... passed onto methods value value","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-subset-.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"set a single value in a dist_fns_list — [[<-.dist_fns_list","text":"updated dist_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-subset-.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"set a single value in a link_fns_list — [[<-.link_fns_list","title":"set a single value in a link_fns_list — [[<-.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-subset-.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"set a single value in a link_fns_list — [[<-.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' x[[...]] <- value"},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-subset-.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"set a single value in a link_fns_list — [[<-.link_fns_list","text":"x link_fns_list S3 object ... passed onto methods value value","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/sub-subset-.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"set a single value in a link_fns_list — [[<-.link_fns_list","text":"updated link_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/subset-.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign a subset to a dist_fns_list — [<-.dist_fns_list","title":"Assign a subset to a dist_fns_list — [<-.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/subset-.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign a subset to a dist_fns_list — [<-.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' x[...] <- value"},{"path":"https://ai4ci.github.io/tidyabc/reference/subset-.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign a subset to a dist_fns_list — [<-.dist_fns_list","text":"x dist_fns_list S3 object ... passed onto methods value value dist_fns_list dist_fns S3 objects","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/subset-.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign a subset to a dist_fns_list — [<-.dist_fns_list","text":"updated dist_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/subset-.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign a subset to a link_fns_list — [<-.link_fns_list","title":"Assign a subset to a link_fns_list — [<-.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/subset-.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign a subset to a link_fns_list — [<-.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' x[...] <- value"},{"path":"https://ai4ci.github.io/tidyabc/reference/subset-.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign a subset to a link_fns_list — [<-.link_fns_list","text":"x link_fns_list S3 object ... passed onto methods value value link_fns_list link_fns S3 objects","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/subset-.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign a subset to a link_fns_list — [<-.link_fns_list","text":"updated link_fns_list S3 object","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/test_simulation.html","id":null,"dir":"Reference","previous_headings":"","what":"Run the simulation for one set of parameters — test_simulation","title":"Run the simulation for one set of parameters — test_simulation","text":"Run simulation one set parameters","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/test_simulation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run the simulation for one set of parameters — test_simulation","text":"","code":"test_simulation(   sim_fn,   scorer_fn,   ...,   params = NULL,   obsdata = NULL,   seed = NULL,   debug = FALSE,   debug_errors = !debug )"},{"path":"https://ai4ci.github.io/tidyabc/reference/test_simulation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run the simulation for one set of parameters — test_simulation","text":"sim_fn user defined function takes set parameters named priors_list. must return simulated data set format obsdata, can compared simdata scorer_fn. function must refer global parameters, automatically crated carrier. scorer_fn user supplied function matches following signature scorer_fn(simdata, obsdata, ....), .e. takes data format simdata paired original obsdata returns named list component scores per simulation. function can make use calculate_*() set functions compare components simulation original data. function must refer global parameters, automatically crated carrier. purrr style function .x refer simulation output .y original observation data. ... simulation parameters, must named params named list simulation parameters test (alternative including ...) obsdata observational data. data typically named list, anything, e.g. dataframe. reference data simulation model aiming replicate. seed optional random seed debug start simulation function debug mode. step sim_fn scorer_fn line line check behaviour intended. debug_errors Errors crop sim_fn simulation due anomolous value combinations hard debug. flag set, whenever sim_fn scorer_fn throws error interactive debugging session started failing parameter combinations. compatible running parallel.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/test_simulation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run the simulation for one set of parameters — test_simulation","text":"list containing parameters truth instance simulation obsdata, obsscores result comparing obsdata usually going result zeros. sim_fn scorer_fn rewritten make sure package names fully qualified. rewritten versions refurned result list (sim_fn scorer_fn respectively)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/tidyabc-package.html","id":null,"dir":"Reference","previous_headings":"","what":"tidyabc: Approximate Bayesian Computing with Tidy Data — tidyabc-package","title":"tidyabc: Approximate Bayesian Computing with Tidy Data — tidyabc-package","text":"package (one paragraph).","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/tidyabc-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"tidyabc: Approximate Bayesian Computing with Tidy Data — tidyabc-package","text":"Maintainer: Robert Challen rob.challen@bristol.ac.uk (ORCID)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/tidyabc_common.html","id":null,"dir":"Reference","previous_headings":"","what":"Common workflow options — tidyabc_common","title":"Common workflow options — tidyabc_common","text":"Common workflow options","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/tidyabc_common.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Common workflow options — tidyabc_common","text":"obsdata observational data. data typically named list, anything, e.g. dataframe. reference data simulation model aiming replicate. priors_list named list priors specified abc_prior S3 object (see priors()), can include derived values unnamed 2-sided formulae, LHS formula assigned value RHS, plus optionally set constraints one sided formulae RHS formulae resolve boolean value. proposal_list named list statistical empirical distributions resulting previous waves specified abc_prior S3 object (see priors()). sim_fn user defined function takes set parameters named priors_list. must return simulated data set format obsdata, can compared simdata scorer_fn. function must refer global parameters, automatically crated carrier. simdata simulated data. simulated data must exactly format obsdata, can compared simdata scorer_fn. scorer_fn user supplied function matches following signature scorer_fn(simdata, obsdata, ....), .e. takes data format simdata paired original obsdata returns named list component scores per simulation. function can make use calculate_*() set functions compare components simulation original data. function must refer global parameters, automatically crated carrier. purrr style function .x refer simulation output .y original observation data. obsscores Summary scores observational data. named list, equivalent output scorer_fn, observed data. given typically assumed zeros. n_sims number simulations run per wave (SMC Adaptive) overall (Rejection). rejection sampling large number recommended, others sma simscores Scores simulated data, output scorer_fn. distance_method metric used combine simscores obsscores. One \"euclidean\", \"normalised\", \"manhattan\", \"mahalanobis\". keep_simulations keep individual simulation results output ABC workflow. can large implications size result. may also want probably worth considering resampling posteriors rather keeping simulations. acceptance_rate proportion simulations keep ABC rejection hard ABC parts algorithms. posteriors_df dataframe posteriors selected ABC may include columns scores, weight /simulation outputs ( abc_component_score, abc_summary_distance, abc_weight, abc_simulation ) well columns matching priors input specification. converged_fn function takes summary per_param input generates logical indicator function converged parallel parallelise simulation? set true simulation step parallelised using furrr. make difference must set following: future::plan(future::multisession, workers = parallel::detectCores()-2) fit S3 abc_fit object output abc_XXX functions p progressr progress bar seed optional random seed knots number knots model CDF . Optional, typically inferred data size. Small numbers tend work better expect distribution unimodal. bw Adaptive ABC data distributions smoothed modelling CDF. smoothing can reduce convergence, -smoothing may result noisy posterior estimates. units ESS defaults 0.1. max_time maximum time seconds spend ABC waves admitting defeat. time may used algorithm converges. allow_continue SMC adaptive algorithms converged max_time allow algorithm interactively prompt user continue. max_recover effective sample size SMC adaptive algorithms drops 200, algorithm retry wave double sample size try recover shape distribution, maximum max_recover times. debug_errors Errors crop sim_fn simulation due anomolous value combinations hard debug. flag set, whenever sim_fn scorer_fn throws error interactive debugging session started failing parameter combinations. compatible running parallel. scoreweights named vector names matching output scorer_fn defines importance component scoring overall distance weighting given simulation. can used assign weight certain parts model output. euclidean manhattan distance methods weights multiply output scorer_fn directly. 2 distance methods degree normalisation done first first wave scores make different components approximately relevance overall score. kernel one \"epanechnikov\" (default), \"uniform\", \"triangular\", \"biweight\", \"gaussian\". kernel defines distance metric translates importance weight decides whether given simulation associated parameters rejected held next round. kernels except gaussian hard cut-outside probability acceptance particle zero. Use gaussian kernels can result poor convergence.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/transform.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a distribution from a link transform of another — transform","title":"Generate a distribution from a link transform of another — transform","text":"Generates new distribution applying link transformation existing distribution dist. \\(X \\sim \\text{dist}\\) \\(h\\) link function, function returns distribution \\(Y = h^{-1}(X)\\). CDF \\(F_Y\\), quantile function \\(Q_Y\\), PDF \\(f_Y\\), RNG \\(R_Y\\) transformed distribution derived original distribution's functions \\(F_X\\), \\(Q_X\\), \\(f_X\\), \\(R_X\\) link function \\(h\\) inverse \\(h^{-1}\\) follows: $$ F_Y(y) = F_X(h(y)) $$ $$ Q_Y(p) = h^{-1}(Q_X(p)) $$ $$ f_Y(y) = f_X(h(y)) \\cdot |h'(y)| $$ $$ R_Y(n) = h^{-1}(R_X(n)) $$ \\(h'(y)\\) derivative link function. function implements transformations p, q, d, r functions resulting dist_fns object.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/transform.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a distribution from a link transform of another — transform","text":"","code":"transform(link, dist, ..., name = NULL)"},{"path":"https://ai4ci.github.io/tidyabc/reference/transform.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a distribution from a link transform of another — transform","text":"link link function (name link function) dist distribution(s) name, function dist_fn S3 object ... parameters underlying distribution dist name function. name name link function","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/transform.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a distribution from a link transform of another — transform","text":"dist_fn dist_fn_list holding transformed distribution(s)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/transform.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Generate a distribution from a link transform of another — transform","text":"","code":"t = transform(\"log\",\"norm\") ps = seq(0,1,0.1) qs = 0:6 testthat::expect_equal(t$q(ps),qlnorm(ps)) testthat::expect_equal(t$p(qs),plnorm(qs)) testthat::expect_equal(t$d(qs),dlnorm(qs))  t2 = transform(\"log\",\"norm\", 0.4, 0.1) testthat::expect_equal(t2$q(ps),qlnorm(ps,0.4,0.1))"},{"path":"https://ai4ci.github.io/tidyabc/reference/truncate.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a distribution from a truncation of another — truncate","title":"Generate a distribution from a truncation of another — truncate","text":"Generates truncated distribution existing distribution dist. new distribution restricted interval \\([x_{left}, x_{right}]\\) (\\((x_{left}, x_{right})\\) open bounds intended, though quantile function map 0 \\(x_{left}\\) 1 \\(x_{right}\\)). probability density function (PDF) truncated distribution \\(f_T(x)\\) related original PDF \\(f(x)\\) normalization constant: $$ f_T(x) = \\frac{f(x)}{F(x_{right}) - F(x_{left})} \\mathbb{}_{[x_{left}, x_{right}]}(x) $$ \\(F\\) original CDF \\(\\mathbb{}\\) indicator function. Consequently, CDF \\(F_T\\) quantile function \\(Q_T\\) : $$ F_T(x) = \\frac{F(x) - F(x_{left})}{F(x_{right}) - F(x_{left})} $$ $$ Q_T(p) = Q(F(x_{left}) + p \\cdot (F(x_{right}) - F(x_{left}))) $$ \\(Q\\) quantile function original distribution. function implements transformations p, q, r functions resulting dist_fns object.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/truncate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a distribution from a truncation of another — truncate","text":"","code":"truncate(dist, x_left, x_right, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/truncate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a distribution from a truncation of another — truncate","text":"dist distribution name, function dist_fn S3 object x_left lower end interval NA open x_right upper end interval NA open ... parameters underlying distribution dist name function.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/truncate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a distribution from a truncation of another — truncate","text":"dist_fn dist_fn_list holding truncated distribution(s)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/truncate.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Generate a distribution from a truncation of another — truncate","text":"","code":"shape2_gamma = as.dist_fns(pgamma, shape=2) g2 = truncate(shape2_gamma, 0.5, 4)  testthat::expect_equal(   format(g2),   \"trunc(gamma(shape = 2, rate = 1), 0.50 - 4.00); Median (IQR) 1.68 [1.08 — 2.46]\" )  testthat::expect_equal(   g2$p(0:5),   c(0, 0.212702667019627, 0.615716430100344, 0.868531239886668, 1, 1) )  testthat::expect_equal(g2$q(seq(0, 1, 0.2)), c(   0.5,   0.971743593113941,   1.42711359317907,   1.95304152540128,   2.6642447272259,   4 ))   g3 = truncate(shape2_gamma, NA, 4) testthat::expect_equal(   format(g3),   \"trunc(gamma(shape = 2, rate = 1), 0.00 - 4.00); Median (IQR) 1.54 [0.899 — 2.35]\" )  g4 = truncate(shape2_gamma, 2, NA) testthat::expect_equal(   format(g4),   \"trunc(gamma(shape = 2, rate = 1), 2.00 - Inf); Median (IQR) 2.97 [2.42 — 3.87]\" )"},{"path":"https://ai4ci.github.io/tidyabc/reference/type_sum.dist_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Pillar type name — type_sum.dist_fns","title":"Pillar type name — type_sum.dist_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/type_sum.dist_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pillar type name — type_sum.dist_fns","text":"","code":"# S3 method for class 'dist_fns' type_sum(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/type_sum.dist_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pillar type name — type_sum.dist_fns","text":"x dist_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/type_sum.dist_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pillar type name — type_sum.dist_fns","text":"string","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/type_sum.dist_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Pillar type name — type_sum.dist_fns_list","title":"Pillar type name — type_sum.dist_fns_list","text":"boilerplate functions allow generic list behaviour dist_fns_list classes allowing dist_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/type_sum.dist_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pillar type name — type_sum.dist_fns_list","text":"","code":"# S3 method for class 'dist_fns_list' type_sum(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/type_sum.dist_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pillar type name — type_sum.dist_fns_list","text":"x dist_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/type_sum.dist_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pillar type name — type_sum.dist_fns_list","text":"name","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/type_sum.link_fns.html","id":null,"dir":"Reference","previous_headings":"","what":"Pillar type name — type_sum.link_fns","title":"Pillar type name — type_sum.link_fns","text":"Boilerplate S3 class operation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/type_sum.link_fns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pillar type name — type_sum.link_fns","text":"","code":"# S3 method for class 'link_fns' type_sum(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/type_sum.link_fns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pillar type name — type_sum.link_fns","text":"x link_fns S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/type_sum.link_fns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pillar type name — type_sum.link_fns","text":"string","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/type_sum.link_fns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Pillar type name — type_sum.link_fns_list","title":"Pillar type name — type_sum.link_fns_list","text":"boilerplate functions allow generic list behaviour link_fns_list classes allowing link_fns S3 objects used lists dataframes.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/type_sum.link_fns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pillar type name — type_sum.link_fns_list","text":"","code":"# S3 method for class 'link_fns_list' type_sum(x, ...)"},{"path":"https://ai4ci.github.io/tidyabc/reference/type_sum.link_fns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pillar type name — type_sum.link_fns_list","text":"x link_fns_list S3 object ... passed onto methods","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/type_sum.link_fns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pillar type name — type_sum.link_fns_list","text":"name","code":""},{"path":[]},{"path":"https://ai4ci.github.io/tidyabc/reference/wasserstein_calculator.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a function to calculate a wasserstein distance — wasserstein_calculator","text":"","code":"wasserstein_calculator(obs, debias = FALSE, bootstraps = 1)"},{"path":"https://ai4ci.github.io/tidyabc/reference/wasserstein_calculator.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a function to calculate a wasserstein distance — wasserstein_calculator","text":"obs vector observations debias simulations shifted match mean observed data bootstraps Randomly resample simulated data points match observed size many times combine output averaging. alternative, 1 (default) matches sizes selecting /repeating simulated data points order (deterministically)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wasserstein_calculator.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a function to calculate a wasserstein distance — wasserstein_calculator","text":"function takes parameter sim returns length normalised wasserstein distance. average distance individual data point must shifted match reference data normalised average distance reference data mean. function also takes p parameter can progressr progress bar must named.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wasserstein_calculator.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate a function to calculate a wasserstein distance — wasserstein_calculator","text":"function takes reference data forms individual observations form example event times returns crated function calculate wasserstein distance simulated data observed data. large simulations quicker calculate_wasserstein must used crated scorer_fn comparison unequal lengths data can accommodated. simulated data recycled, sampled, length observed data comparison.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wasserstein_calculator.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Generate a function to calculate a wasserstein distance — wasserstein_calculator","text":"","code":"tmp = wasserstein_calculator(0:10)  # zero if no distance testthat::expect_equal(tmp(0:10), 0) testthat::expect_equal(tmp(10:0), 0)  # normalised so that all mass at mean = 1 testthat::expect_equal(tmp(rep(5, 11)), 1)  # smaller sample recycled and normalises to same value testthat::expect_equal(tmp(rep(5, 5)), 1)  # should be ((0+1+0+1+0+0+0+1+0+1+0) / 11) / ((5+4+3+2+1+0+1+2+3+4+5) / 11) = 0.1333... testthat::expect_equal(   tmp(c(0, 0, 2, 2, 4, 5, 6, 8, 8, 10, 10)),   0.133333333333333 )  withr::with_seed(100, {    ref = rnorm(1000)    cmp1 = rnorm(1000)    cmp2 = rnorm(1000, sd=2)    cmp3 = rnorm(100) })  tmp2 = wasserstein_calculator(ref)  testthat::expect_equal(tmp2(cmp1), 0.0576417503974498) testthat::expect_equal(tmp2(cmp2), 1.04950621760385) testthat::expect_equal(tmp2(cmp3), 0.212977231452674)"},{"path":"https://ai4ci.github.io/tidyabc/reference/wedge.html","id":null,"dir":"Reference","previous_headings":"","what":"Wedge distribution — wedge","title":"Wedge distribution — wedge","text":"wedge distribution support 0 1 linear probability density function support.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wedge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wedge distribution — wedge","text":"n number observations x vector quantiles q vector quantiles p vector probabilities log logical; TRUE, probabilities p given log(p). log.p logical; TRUE, probabilities p given log(p). lower.tail logical; TRUE (default), probabilities P[X<=x] otherwise P[X>x]. gradient -2 (left skewed) 2 (right skewed)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wedge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wedge distribution — wedge","text":"vector probabilities, quantiles, densities samples.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wedge.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Wedge distribution — wedge","text":"rwedge can combined quantile functions skew standard distributions, introduce correlation weight certain parts distribution.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wedge.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wedge distribution — wedge","text":"","code":"pwedge(seq(0,1,0.1), a=1) #>  [1] 0.5 0.6 0.7 0.8 0.9 1.0 1.1 1.2 1.3 1.4 1.5 dwedge(seq(0,1,0.1), a=1) #>  [1] 0.000 0.055 0.120 0.195 0.280 0.375 0.480 0.595 0.720 0.855 1.000 qwedge(c(0.25,0.5,0.75), a=-1) #> [1] 0.1771243 0.3819660 0.6339746  stats::cor(   stats::qnorm(rwedge(1000, a=2)),   stats::qnorm(rwedge(1000, a=-2)) ) #> [1] -0.01684469"},{"path":"https://ai4ci.github.io/tidyabc/reference/wmean.html","id":null,"dir":"Reference","previous_headings":"","what":"Weighted mean — wmean","title":"Weighted mean — wmean","text":"simple alias base weighted,mean","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wmean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weighted mean — wmean","text":"","code":"wmean(x, w = NULL, na.rm = TRUE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/wmean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Weighted mean — wmean","text":"x either vector samples distribution X cut-offs cumulative probabilities combined p w data fits, vector length x giving importance weight observation. need normalised. must non zero weights, must finite. na.rm remove NAs (default TRUE)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wmean.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Weighted mean — wmean","text":"standard deviation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wmean.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Weighted mean — wmean","text":"","code":"#' # unweighted: wmean(x = stats::rnorm(1000)) #> [1] -0.01197784  # weighted: wmean(x = seq(-2,2,0.1), w = stats::dnorm(seq(-2,2,0.1))) #> [1] 3.904271e-17"},{"path":"https://ai4ci.github.io/tidyabc/reference/wquantile.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile from weighted data with link function support — wquantile","title":"Quantile from weighted data with link function support — wquantile","text":"quantile function different order parameters base quantile. takes weight link function specification allows us define support quantile function. optimised imputing tail distributions speed.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wquantile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile from weighted data with link function support — wquantile","text":"","code":"wquantile(p, x, w = NULL, link = \"identity\", names = TRUE, window = 7)"},{"path":"https://ai4ci.github.io/tidyabc/reference/wquantile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile from weighted data with link function support — wquantile","text":"p probabilities estimate quantiles data x set observations w data fits, vector length x giving importance weight observation. need normalised. must non zero weights, must finite. link link function. Either name, link_fns S3 object. latter case derived statistical distribution .link_fns(<dist_fns>). supports use prior define support empirical function, designed prevent tail truncation. Support updated quantile function provided prior. names name resulting quantile vector window number data points include estimating quantile. closest window points picked used distance weighted linear interpolation weighted CDF logit-link space. tends give good results extrapolating tails.","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wquantile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile from weighted data with link function support — wquantile","text":"vector quantiles","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wquantile.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Quantile from weighted data with link function support — wquantile","text":"process involves: Link transformation: \\(x\\) values transformed using link function: \\(x_1 = T(x)\\). Standardization: Transformed values standardized: \\(x_2 = \\frac{x_1 - \\mu_{w,1}}{\\sigma_{w,1}}\\), \\(\\mu_{w,1}\\) \\(\\sigma_{w,1}\\) weighted mean standard deviation \\(x_1\\). Weighted CDF calculation: empirical CDF \\(y\\) calculated weights \\(w\\). Logit transformation: \\(y\\) transformed: \\(y_2 = \\text{logit}(y)\\). Local interpolation: target probability \\(p\\), \\(p_2 = \\text{logit}(p)\\) calculated. window \\(window\\) points selected \\((y_2, x_2)\\) pairs around \\(p_2\\). weighted linear model fitted using Gaussian kernel weights based distance \\(y_2\\) space: \\(K = \\exp(-\\frac{1}{2} u^2)\\), \\(u\\) normalized distance. Quantile estimation: local model predicts \\(q_2\\) \\(p_2\\). Back-transformation: quantile transformed back: \\(q = T^{-1}(q_2 \\cdot \\sigma_{w,1} + \\mu_{w,1})\\). moderately expensive function call (memory terms), needs construct whole quantile function. multiple calls consider using empirical() build quantile function using .","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wquantile.html","id":"unit-tests","dir":"Reference","previous_headings":"","what":"Unit tests","title":"Quantile from weighted data with link function support — wquantile","text":"","code":"test = function(rfn,qfn, link,..., n = 100000, tol=1000/(n+10000)) {   testthat::expect_equal(abs(    unname(wquantile(c(0.025, 0.5, 0.975),rfn(100000,...),link=link,names=FALSE)-     qfn(c(0.025, 0.5, 0.975), ...))   ), c(0,0,0), tolerance=tol) }  withr::with_seed(123, {    test(stats::rnorm,stats::qnorm,\"identity\",n = 10000)   test(stats::rnorm,stats::qnorm,\"identity\",mean=4,n = 10000)   test(stats::rnorm,stats::qnorm,\"identity\",sd=3, n = 100000, tol=0.05)    test(stats::rnorm,stats::qnorm,\"identity\",n = 5000)   test(stats::rnorm,stats::qnorm,\"identity\",n = 1000)   test(stats::rnorm,stats::qnorm,\"identity\",n = 100)   test(stats::rnorm,stats::qnorm,\"identity\",n = 30)    test(stats::rgamma,stats::qgamma,\"log\", 4,n = 10000)   test(stats::rgamma,stats::qgamma,\"log\", 4,n = 5000)   test(stats::rgamma,stats::qgamma,\"log\", 4,n = 1000)   test(stats::rgamma,stats::qgamma,\"log\", 4, 3,n = 100)   test(stats::rgamma,stats::qgamma,\"log\", 4,n = 30)    test(stats::runif,stats::qunif,as.link_fns(c(0,10)),0,10)  })"},{"path":"https://ai4ci.github.io/tidyabc/reference/wquantile.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quantile from weighted data with link function support — wquantile","text":"","code":"# unweighted: wquantile(p = c(0.25,0.5,0.75), x = stats::rnorm(1000)) #>        25%        50%        75%  #> -0.6395344  0.0484240  0.6580429   # weighted: wquantile(p = c(0.25,0.5,0.75), x = seq(-2,2,0.1), w = stats::dnorm(seq(-2,2,0.1))) #>           25%           50%           75%  #> -6.384711e-01  2.591425e-17  6.384711e-01"},{"path":"https://ai4ci.github.io/tidyabc/reference/wsd.html","id":null,"dir":"Reference","previous_headings":"","what":"Weighted standard deviation — wsd","title":"Weighted standard deviation — wsd","text":"Weighted standard deviation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wsd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weighted standard deviation — wsd","text":"","code":"wsd(x, w = NULL, na.rm = TRUE)"},{"path":"https://ai4ci.github.io/tidyabc/reference/wsd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Weighted standard deviation — wsd","text":"x either vector samples distribution X cut-offs cumulative probabilities combined p w data fits, vector length x giving importance weight observation. need normalised. must non zero weights, must finite. na.rm remove NAs (default TRUE)","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wsd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Weighted standard deviation — wsd","text":"standard deviation","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wsd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Weighted standard deviation — wsd","text":"","code":"# unweighted: wsd(x = stats::rnorm(1000)) #> [1] 0.9634535  # weighted: wsd(x = seq(-2,2,0.1), w = stats::dnorm(seq(-2,2,0.1))) #> [1] 0.9036469"},{"path":"https://ai4ci.github.io/tidyabc/reference/wt_quant.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile from weighted data — wt_quant","title":"Quantile from weighted data — wt_quant","text":"Quantile weighted data","code":""},{"path":"https://ai4ci.github.io/tidyabc/reference/wt_quant.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile from weighted data — wt_quant","text":"p quantile probabilities names result named na.rm remove NAs observations (weights) x observations w importance weights. Must non zero weights, must finite. need sum one. link link function mapping observations infinite support","code":""},{"path":"https://ai4ci.github.io/tidyabc/news/index.html","id":"tidyabc-development-version","dir":"Changelog","previous_headings":"","what":"tidyabc (development version)","title":"tidyabc (development version)","text":"auto calibrate kernel epsilon (? sample size) ESS adaptive fits scoring utilities ggoutbreak use empirical CDF ggoutbreak display splines empirical fits update splines using empirical link function see: (https://en.wikipedia.org/wiki/Copula_(statistics)#Gaussian_copula) : (https://en.wikipedia.org/wiki/Sigmoid_function) convolution skew","code":""},{"path":"https://ai4ci.github.io/tidyabc/news/index.html","id":"tidyabc-001","dir":"Changelog","previous_headings":"","what":"tidyabc 0.0.1","title":"tidyabc 0.0.1","text":"ai4ci r-universe release. distance functions Wasserstein RMSE. modern support parallel simulation execution using furrr posterior visualisation resampling convergence statistics visualisation support distributions dataframe column empirical, transformed mixture distributions unified framework distribution plotting weighted data cumulative probabilities link function support constraints support monotonic spline based fits Q-Q (cdf) logit-Z (data) space support q, p, d, r functions. e.g. re-parametrisations standard distributions. constrained gamma distribution logit normal distribution formula based constructor print methods search library paths distributions. constraints","code":""}]
